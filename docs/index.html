<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="pt-BR" xml:lang="pt-BR"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.40">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Marcus Antonio Cardoso Ramalho">
<meta name="author" content="Claudia Regina da Costa de Souza">
<meta name="author" content="Ben Hur Correia">

<title>ANÁLISE DISCRIMINANTE – ANÁLISE DISCRIMINANTE, PROBIT e LOGIT - Aplicações em R</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-549806ee2085284f45b00abea8c6df48.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-ddd961a2510921635943dfbbd19534c4.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "Nenhum resultado",
    "search-matching-documents-text": "documentos correspondentes",
    "search-copy-link-title": "Copiar link para a busca",
    "search-hide-matches-text": "Esconder correspondências adicionais",
    "search-more-match-text": "mais correspondência neste documento",
    "search-more-matches-text": "mais correspondências neste documento",
    "search-clear-button-title": "Limpar",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancelar",
    "search-submit-button-title": "Enviar",
    "search-label": "Procurar"
  }
}</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">ANÁLISE DISCRIMINANTE, PROBIT e LOGIT - Aplicações em R</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Procurar"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Alternar de navegação" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link active" href="./index.html" aria-current="page"> 
<span class="menu-text">Análise discriminante</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./logit_probit.html"> 
<span class="menu-text">Logit e Probit</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Nesta página</h2>
   
  <ul>
  <li><a href="#análise-discriminante---exemplo-hbat" id="toc-análise-discriminante---exemplo-hbat" class="nav-link active" data-scroll-target="#análise-discriminante---exemplo-hbat">Análise Discriminante - Exemplo HBAT</a>
  <ul class="collapse">
  <li><a href="#reprodução-do-exemplo-de-hair-et-al.---dataset-hbat" id="toc-reprodução-do-exemplo-de-hair-et-al.---dataset-hbat" class="nav-link" data-scroll-target="#reprodução-do-exemplo-de-hair-et-al.---dataset-hbat">Reprodução do Exemplo de Hair et al.&nbsp;- Dataset HBAT</a></li>
  <li><a href="#estágio-1-objetivos-da-análise-discriminante" id="toc-estágio-1-objetivos-da-análise-discriminante" class="nav-link" data-scroll-target="#estágio-1-objetivos-da-análise-discriminante">Estágio 1: Objetivos da Análise Discriminante</a></li>
  <li><a href="#estágio-2-delineamento-da-pesquisa-de-análise-discriminante" id="toc-estágio-2-delineamento-da-pesquisa-de-análise-discriminante" class="nav-link" data-scroll-target="#estágio-2-delineamento-da-pesquisa-de-análise-discriminante">Estágio 2: Delineamento da Pesquisa de Análise Discriminante</a></li>
  <li><a href="#estágio-3-pressupostos-da-análise-discriminante" id="toc-estágio-3-pressupostos-da-análise-discriminante" class="nav-link" data-scroll-target="#estágio-3-pressupostos-da-análise-discriminante">Estágio 3: Pressupostos da Análise Discriminante</a></li>
  <li><a href="#estágio-4-estimação-do-modelo-discriminante-e-avaliação-do-ajuste-geral" id="toc-estágio-4-estimação-do-modelo-discriminante-e-avaliação-do-ajuste-geral" class="nav-link" data-scroll-target="#estágio-4-estimação-do-modelo-discriminante-e-avaliação-do-ajuste-geral">Estágio 4: Estimação do Modelo Discriminante e Avaliação do Ajuste Geral</a></li>
  <li><a href="#estágio-5-interpretação-dos-resultados" id="toc-estágio-5-interpretação-dos-resultados" class="nav-link" data-scroll-target="#estágio-5-interpretação-dos-resultados">Estágio 5: Interpretação dos Resultados</a></li>
  <li><a href="#estágio-6-validação-dos-resultados" id="toc-estágio-6-validação-dos-resultados" class="nav-link" data-scroll-target="#estágio-6-validação-dos-resultados">Estágio 6: Validação dos Resultados</a></li>
  <li><a href="#resumo-da-interpretação-gerencial" id="toc-resumo-da-interpretação-gerencial" class="nav-link" data-scroll-target="#resumo-da-interpretação-gerencial">Resumo da Interpretação Gerencial</a></li>
  <li><a href="#apêndice-informações-técnicas-do-dataset" id="toc-apêndice-informações-técnicas-do-dataset" class="nav-link" data-scroll-target="#apêndice-informações-técnicas-do-dataset">Apêndice: Informações Técnicas do Dataset</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">ANÁLISE DISCRIMINANTE</h1>
</div>


<div class="quarto-title-meta-author">
  <div class="quarto-title-meta-heading">Autores</div>
  <div class="quarto-title-meta-heading">Afiliação</div>
  
    <div class="quarto-title-meta-contents">
    <p class="author">Marcus Antonio Cardoso Ramalho <a href="mailto:marcus.ramalho@coppead.ufrj.br" class="quarto-title-author-email"><i class="bi bi-envelope"></i></a> </p>
  </div>
  <div class="quarto-title-meta-contents">
        <p class="affiliation">
            COPPEAD - UNIVERSIDADE FEDERAL DO RIO DE JANEIRO
          </p>
      </div>
    <div class="quarto-title-meta-contents">
    <p class="author">Claudia Regina da Costa de Souza </p>
  </div>
  <div class="quarto-title-meta-contents">
      </div>
    <div class="quarto-title-meta-contents">
    <p class="author">Ben Hur Correia </p>
  </div>
  <div class="quarto-title-meta-contents">
      </div>
  </div>

<div class="quarto-title-meta">

      
    <div>
    <div class="quarto-title-meta-heading">Data de Publicação</div>
    <div class="quarto-title-meta-contents">
      <p class="date">25 de junho de 2025</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(klaR)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(corrplot)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caret)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(skimr)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MVN)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(biotools)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(GGally)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nnet)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pROC)</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(haven)</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reshape2)</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(viridis)</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly)</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RColorBrewer)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="análise-discriminante---exemplo-hbat" class="level2">
<h2 class="anchored" data-anchor-id="análise-discriminante---exemplo-hbat">Análise Discriminante - Exemplo HBAT</h2>
<section id="reprodução-do-exemplo-de-hair-et-al.---dataset-hbat" class="level3">
<h3 class="anchored" data-anchor-id="reprodução-do-exemplo-de-hair-et-al.---dataset-hbat">Reprodução do Exemplo de Hair et al.&nbsp;- Dataset HBAT</h3>
<p>Nesta seção, reproduziremos a análise discriminante apresentada no livro Hair et al., utilizando o dataset HBAT para classificar clientes em três grupos baseados no tempo de relacionamento com a empresa.</p>
<p>O <strong>HBAT</strong> é um dataset educacional fictício amplamente utilizado no livro clássico “Multivariate Data Analysis” de Joseph Hair et al., representando uma empresa de distribuição industrial. O dataset contém <strong>100 observações</strong> de clientes classificados em três grupos baseados no tempo de relacionamento: <strong>Grupo 1</strong> (menos de 1 ano), <strong>Grupo 2</strong> (1 a 5 anos) e <strong>Grupo 3</strong> (mais de 5 anos). As variáveis incluem a <strong>variável dependente X1</strong> (Customer Type) e <strong>13 variáveis independentes</strong> (X6-X18) que medem percepções dos clientes sobre diferentes aspectos da empresa, como qualidade do produto (X6), atividades de e-commerce (X7), suporte técnico (X8), resolução de reclamações (X9), propaganda (X10), linha de produtos (X11), imagem da força de vendas (X12), preços competitivos (X13), garantia e reclamações (X14), novos produtos (X15), pedidos e faturamento (X16), flexibilidade de preços (X17) e velocidade de entrega (X18). Todas as variáveis independentes utilizam uma <strong>escala de 0-10</strong>, facilitando comparações e interpretações. Este dataset é ideal para demonstrar técnicas de análise multivariada, especialmente análise discriminante, pois oferece um contexto empresarial realista com dados limpos e estruturados, permitindo focar na aplicação das técnicas estatísticas sem se preocupar com problemas complexos de qualidade de dados típicos de datasets reais.</p>
</section>
<section id="estágio-1-objetivos-da-análise-discriminante" class="level3">
<h3 class="anchored" data-anchor-id="estágio-1-objetivos-da-análise-discriminante">Estágio 1: Objetivos da Análise Discriminante</h3>
<p>O objetivo é identificar as características perceptuais que distinguem clientes baseados no tempo de relacionamento: - <strong>Grupo 1</strong>: Menos de 1 ano - <strong>Grupo 2</strong>: De 1 a 5 anos<br>
- <strong>Grupo 3</strong>: Mais de 5 anos</p>
<section id="carregamento-e-inspeção-dos-dados-do-arquivo-spss" class="level4">
<h4 class="anchored" data-anchor-id="carregamento-e-inspeção-dos-dados-do-arquivo-spss">Carregamento e Inspeção dos Dados do arquivo spss</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Carregando os dados HBAT</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>hbat <span class="ot">&lt;-</span> haven<span class="sc">::</span><span class="fu">read_sav</span>(<span class="st">"data/hbat.sav"</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(hbat)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 100
Columns: 24
$ id  &lt;dbl&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19,…
$ x1  &lt;dbl+lbl&gt; 2, 3, 3, 1, 2, 1, 1, 2, 2, 1, 3, 1, 1, 3, 2, 3, 2, 2, 2, 3, 1,…
$ x2  &lt;dbl+lbl&gt; 0, 1, 0, 1, 0, 1, 1, 0, 1, 0, 0, 0, 1, 1, 0, 0, 1, 0, 1, 0, 0,…
$ x3  &lt;dbl+lbl&gt; 1, 0, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 0, 1, 1, 1, 0,…
$ x4  &lt;dbl+lbl&gt; 1, 0, 1, 1, 0, 1, 1, 1, 1, 1, 0, 1, 0, 0, 1, 0, 1, 1, 1, 1, 1,…
$ x5  &lt;dbl+lbl&gt; 1, 0, 1, 0, 1, 0, 0, 0, 0, 0, 1, 0, 1, 1, 1, 0, 1, 0, 0, 0, 0,…
$ x6  &lt;dbl+lbl&gt; 8.5, 8.2, 9.2, 6.4, 9.0, 6.5, 6.9, 6.2, 5.8, 6.4, 8.7, 6.1, 9.…
$ x7  &lt;dbl+lbl&gt; 3.9, 2.7, 3.4, 3.3, 3.4, 2.8, 3.7, 3.3, 3.6, 4.5, 3.2, 4.9, 5.…
$ x8  &lt;dbl+lbl&gt; 2.5, 5.1, 5.6, 7.0, 5.2, 3.1, 5.0, 3.9, 5.1, 5.1, 4.6, 6.3, 4.…
$ x9  &lt;dbl+lbl&gt; 5.9, 7.2, 5.6, 3.7, 4.6, 4.1, 2.6, 4.8, 6.7, 6.1, 4.8, 3.9, 6.…
$ x10 &lt;dbl+lbl&gt; 4.8, 3.4, 5.4, 4.7, 2.2, 4.0, 2.1, 4.6, 3.7, 4.7, 2.7, 4.4, 5.…
$ x11 &lt;dbl+lbl&gt; 4.9, 7.9, 7.4, 4.7, 6.0, 4.3, 2.3, 3.6, 5.9, 5.7, 6.8, 3.9, 6.…
$ x12 &lt;dbl+lbl&gt; 6.0, 3.1, 5.8, 4.5, 4.5, 3.7, 5.4, 5.1, 5.8, 5.7, 4.6, 6.4, 6.…
$ x13 &lt;dbl+lbl&gt; 6.8, 5.3, 4.5, 8.8, 6.8, 8.5, 8.9, 6.9, 9.3, 8.4, 6.8, 8.2, 7.…
$ x14 &lt;dbl+lbl&gt; 4.7, 5.5, 6.2, 7.0, 6.1, 5.1, 4.8, 5.4, 5.9, 5.4, 5.8, 5.8, 6.…
$ x15 &lt;dbl+lbl&gt; 4.3, 4.0, 4.6, 3.6, 4.5, 9.5, 2.5, 4.8, 4.4, 5.3, 7.5, 5.9, 5.…
$ x16 &lt;dbl+lbl&gt; 5.0, 3.9, 5.4, 4.3, 4.5, 3.6, 2.1, 4.3, 4.4, 4.1, 3.8, 3.0, 5.…
$ x17 &lt;dbl+lbl&gt; 5.1, 4.3, 4.0, 4.1, 3.5, 4.7, 4.2, 6.3, 6.1, 5.8, 3.7, 4.9, 4.…
$ x18 &lt;dbl+lbl&gt; 3.7, 4.9, 4.5, 3.0, 3.5, 3.3, 2.0, 3.7, 4.6, 4.4, 4.0, 3.2, 4.…
$ x19 &lt;dbl+lbl&gt; 8.2, 5.7, 8.9, 4.8, 7.1, 4.7, 5.7, 6.3, 7.0, 5.5, 7.4, 6.0, 8.…
$ x20 &lt;dbl+lbl&gt; 8.0, 6.5, 8.4, 6.0, 6.6, 6.3, 7.8, 5.8, 7.5, 5.9, 7.0, 6.3, 8.…
$ x21 &lt;dbl+lbl&gt; 8.4, 7.5, 9.0, 7.2, 9.0, 6.1, 7.2, 7.7, 8.2, 6.7, 8.4, 6.6, 7.…
$ x22 &lt;dbl+lbl&gt; 65.1, 67.1, 72.1, 40.1, 57.1, 50.1, 41.1, 56.1, 56.1, 59.1, 68…
$ x23 &lt;dbl+lbl&gt; 1, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 1, 1, 0, 1, 1, 0, 1, 0,…</code></pre>
</div>
</div>
</section>
<section id="definição-das-variáveis-do-modelo" class="level4">
<h4 class="anchored" data-anchor-id="definição-das-variáveis-do-modelo">Definição das Variáveis do Modelo</h4>
<p>Com base na inspeção dos dados, identificamos que o dataset HBAT possui exatamente as variáveis necessárias: - <strong>x1</strong>: Variável dependente (Customer Type: 1=Menos de 1 ano, 2=De 1 a 5 anos, 3=Mais de 5 anos) - <strong>x6-x18</strong>: Variáveis independentes (percepções sobre a HBAT)</p>
<p><strong>Configuração das Variáveis:</strong></p>
<ul>
<li><strong>Variável dependente</strong>: x1</li>
<li><strong>Variáveis independentes</strong>: x6, x7, x8, x9, x10, x11, x12, x13, x14, x15, x16, x17, x18</li>
<li><strong>Total de variáveis independentes</strong>: 13</li>
</ul>
</section>
<section id="preparação-do-dataset-final" class="level4">
<h4 class="anchored" data-anchor-id="preparação-do-dataset-final">Preparação do Dataset Final</h4>
<p><strong>Resumo da Preparação dos Dados:</strong></p>
<ul>
<li><strong>Total de observações</strong>: 100</li>
<li><strong>Variáveis independentes</strong>: 13</li>
<li><strong>Grupos identificados</strong>: 3</li>
</ul>
<p><strong>Distribuição da Variável Dependente (X1):</strong></p>
<div class="cell">
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">Grupo</th>
<th style="text-align: right;">Frequência</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Menos de 1 ano</td>
<td style="text-align: right;">32</td>
</tr>
<tr class="even">
<td style="text-align: left;">De 1 a 5 anos</td>
<td style="text-align: right;">35</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Mais de 5 anos</td>
<td style="text-align: right;">33</td>
</tr>
</tbody>
</table>
</div>
</div>
<p><strong>Descrições das Variáveis:</strong></p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Código</th>
<th>Descrição</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>X1</td>
<td>Customer Type</td>
</tr>
<tr class="even">
<td>X6</td>
<td>Product Quality</td>
</tr>
<tr class="odd">
<td>X7</td>
<td>E-Commerce Activities</td>
</tr>
<tr class="even">
<td>X8</td>
<td>Technical Support</td>
</tr>
<tr class="odd">
<td>X9</td>
<td>Complaint Resolution</td>
</tr>
<tr class="even">
<td>X10</td>
<td>Advertising</td>
</tr>
<tr class="odd">
<td>X11</td>
<td>Product Line</td>
</tr>
<tr class="even">
<td>X12</td>
<td>Salesforce Image</td>
</tr>
<tr class="odd">
<td>X13</td>
<td>Competitive Pricing</td>
</tr>
<tr class="even">
<td>X14</td>
<td>Warranty &amp; Claims</td>
</tr>
<tr class="odd">
<td>X15</td>
<td>New Products</td>
</tr>
<tr class="even">
<td>X16</td>
<td>Ordering &amp; Billing</td>
</tr>
<tr class="odd">
<td>X17</td>
<td>Price Flexibility</td>
</tr>
<tr class="even">
<td>X18</td>
<td>Delivery Speed</td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="estágio-2-delineamento-da-pesquisa-de-análise-discriminante" class="level3">
<h3 class="anchored" data-anchor-id="estágio-2-delineamento-da-pesquisa-de-análise-discriminante">Estágio 2: Delineamento da Pesquisa de Análise Discriminante</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Divisão em amostras de análise e validação</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>n_total <span class="ot">&lt;-</span> <span class="fu">nrow</span>(hbat_clean)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>indices_analise <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>n_total, <span class="at">size =</span> <span class="fu">floor</span>(<span class="fl">0.6</span> <span class="sc">*</span> n_total))</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>amostra_analise <span class="ot">&lt;-</span> hbat_clean[indices_analise, ]</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>amostra_validacao <span class="ot">&lt;-</span> hbat_clean[<span class="sc">-</span>indices_analise, ]</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Verificar balanceamento dos grupos</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>prop_analise <span class="ot">&lt;-</span> <span class="fu">table</span>(amostra_analise<span class="sc">$</span>X1) <span class="sc">/</span> <span class="fu">nrow</span>(amostra_analise)</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>prop_validacao <span class="ot">&lt;-</span> <span class="fu">table</span>(amostra_validacao<span class="sc">$</span>X1) <span class="sc">/</span> <span class="fu">nrow</span>(amostra_validacao)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>A análise discriminante requer a divisão dos dados em amostras de estimação e validação para avaliar adequadamente o desempenho do modelo. Utilizamos uma divisão de 60% para análise e 40% para validação.</p>
<p><strong>Características das Amostras:</strong></p>
<ul>
<li><strong>Amostra de análise</strong>: 60 casos</li>
<li><strong>Amostra de validação</strong>: 40 casos</li>
</ul>
<p><strong>Distribuição dos Grupos por Amostra:</strong></p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Grupo</th>
<th>Análise (n)</th>
<th>Análise (%)</th>
<th>Validação (n)</th>
<th>Validação (%)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Menos de 1 ano</td>
<td>20</td>
<td>33.3%</td>
<td>12</td>
<td>30%</td>
</tr>
<tr class="even">
<td>De 1 a 5 anos</td>
<td>22</td>
<td>36.7%</td>
<td>13</td>
<td>32.5%</td>
</tr>
<tr class="odd">
<td>Mais de 5 anos</td>
<td>18</td>
<td>30%</td>
<td>15</td>
<td>37.5%</td>
</tr>
</tbody>
</table>
</section>
<section id="estágio-3-pressupostos-da-análise-discriminante" class="level3">
<h3 class="anchored" data-anchor-id="estágio-3-pressupostos-da-análise-discriminante">Estágio 3: Pressupostos da Análise Discriminante</h3>
<section id="normalidade-multivariada" class="level4">
<h4 class="anchored" data-anchor-id="normalidade-multivariada">3.1 Normalidade Multivariada</h4>
<p>O teste de normalidade multivariada é fundamental para verificar se os dados seguem uma distribuição normal multivariada, pressuposto da análise discriminante linear. Testamos cada um dos três grupos separadamente usando o teste de Henze-Zirkler.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MVN)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Armazenar resultados dos testes de normalidade</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>resultados_normalidade <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(grupo <span class="cf">in</span> <span class="fu">levels</span>(amostra_analise<span class="sc">$</span>X1)) {</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>  dados_grupo <span class="ot">&lt;-</span> amostra_analise[amostra_analise<span class="sc">$</span>X1 <span class="sc">==</span> grupo, variaveis_independentes]</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Usando parâmetros corretos da função mvn</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>  resultado_mvn <span class="ot">&lt;-</span> <span class="fu">mvn</span>(dados_grupo, <span class="at">mvn_test =</span> <span class="st">"hz"</span>, <span class="at">univariate_test =</span> <span class="st">"SW"</span>)</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>  resultados_normalidade[[grupo]] <span class="ot">&lt;-</span> resultado_mvn<span class="sc">$</span>multivariate_normality</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Teste alternativo se o primeiro falhar</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">is.null</span>(resultado_mvn<span class="sc">$</span>multivariate_normality)) {</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>    resultado_mardia <span class="ot">&lt;-</span> <span class="fu">mvn</span>(dados_grupo, <span class="at">mvn_test =</span> <span class="st">"mardia"</span>)</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>    resultados_normalidade[[grupo]] <span class="ot">&lt;-</span> resultado_mardia<span class="sc">$</span>multivariate_normality</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Mostrar resultados</span></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(resultados_normalidade)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$`Menos de 1 ano`
           Test Statistic p.value     Method      MVN
1 Henze-Zirkler      0.99   0.113 asymptotic ✓ Normal

$`De 1 a 5 anos`
           Test Statistic p.value     Method      MVN
1 Henze-Zirkler     0.993   0.063 asymptotic ✓ Normal

$`Mais de 5 anos`
           Test Statistic p.value     Method          MVN
1 Henze-Zirkler     0.994   0.035 asymptotic ✗ Not normal</code></pre>
</div>
</div>
<p><strong>Resumo dos Testes de Normalidade:</strong></p>
<p>Com base nos resultados obtidos, 2 dos 3 grupos atendem ao pressuposto de normalidade multivariada ao nível de significância de 5%. O grupo que apresentou desvio (p = 0.035) está próximo do limite aceitável, e a análise discriminante pode prosseguir com confiança.</p>
</section>
<section id="homogeneidade-das-matrizes-de-covariância" class="level4">
<h4 class="anchored" data-anchor-id="homogeneidade-das-matrizes-de-covariância">3.2 Homogeneidade das Matrizes de Covariância</h4>
<p>O teste M de Box verifica se as matrizes de covariância dos grupos são homogêneas, outro pressuposto importante da análise discriminante. Este teste avalia se as 13 variáveis independentes apresentam estruturas de covariância similares entre os grupos.</p>
<p><strong>Interpretação dos Resultados do Teste M de Box:</strong></p>
<p><strong>Conclusão</strong>: Com p-valor = 0.01122 &lt; 0.05, rejeitamos a hipótese nula de homogeneidade das matrizes de covariância. Isso indica que <strong>há diferenças significativas</strong> entre as estruturas de covariância dos grupos.</p>
<p><strong>Implicações Práticas:</strong> - A violação da homogeneidade das covariâncias sugere que a <strong>Análise Discriminante Quadrática (QDA)</strong> poderia ser mais apropriada que a Linear (LDA) - No entanto, a LDA é robusta a violações moderadas deste pressuposto, especialmente quando os tamanhos das amostras são similares - Como os grupos estão relativamente balanceados (conforme mostrado acima), podemos prosseguir com cautela usando LDA - Os resultados devem ser interpretados considerando esta limitação</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(biotools)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>dados_teste <span class="ot">&lt;-</span> amostra_analise[, variaveis_independentes]</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>grupos_teste <span class="ot">&lt;-</span> amostra_analise<span class="sc">$</span>X1</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Teste M de Box com tratamento de erro</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="fu">tryCatch</span>({</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>  teste_box <span class="ot">&lt;-</span> <span class="fu">boxM</span>(dados_teste, grupos_teste)</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(teste_box)</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>}, <span class="at">error =</span> <span class="cf">function</span>(e) {</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">message</span>(<span class="st">"Teste M de Box não pôde ser executado: "</span>, e<span class="sc">$</span>message)</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(grupo <span class="cf">in</span> <span class="fu">levels</span>(amostra_analise<span class="sc">$</span>X1)) {</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>    dados_grupo <span class="ot">&lt;-</span> amostra_analise[amostra_analise<span class="sc">$</span>X1 <span class="sc">==</span> grupo, variaveis_independentes]</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>    cov_grupo <span class="ot">&lt;-</span> <span class="fu">cov</span>(dados_grupo)</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">message</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Matriz de Covariância - Grupo: "</span>, grupo)</span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">round</span>(cov_grupo, <span class="dv">3</span>))</span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Box's M-test for Homogeneity of Covariance Matrices

data:  dados_teste
Chi-Sq (approx.) = 228.34, df = 182, p-value = 0.01122</code></pre>
</div>
</div>
</section>
<section id="multicolinearidade" class="level4">
<h4 class="anchored" data-anchor-id="multicolinearidade">3.3 Multicolinearidade</h4>
<p>A presença de multicolinearidade pode afetar a estabilidade dos resultados da análise discriminante. O determinante da matriz de correlação e os valores VIF nos ajudam a identificar possíveis problemas de multicolinearidade entre as variáveis.</p>
<p><strong>Interpretação dos Valores VIF:</strong></p>
<p>Os Fatores de Inflação da Variância (VIF) revelam problemas significativos de multicolinearidade:</p>
<ul>
<li><strong>VIF &lt; 5</strong>: Multicolinearidade baixa (aceitável)
<ul>
<li>X6 (1.90), X7 (4.56), X8 (4.71), X10 (1.65), X13 (1.76), X14 (4.16), X15 (1.23), X16 (4.33)</li>
</ul></li>
<li><strong>VIF entre 5-10</strong>: Multicolinearidade moderada (preocupante)
<ul>
<li>X9 (5.33), X12 (5.78)</li>
</ul></li>
<li><strong>VIF &gt; 10</strong>: Multicolinearidade alta (problemática)
<ul>
<li><strong>X11 (Product Line)</strong>: VIF = 52.77</li>
<li><strong>X17 (Price Flexibility)</strong>: VIF = 41.49<br>
</li>
<li><strong>X18 (Delivery Speed)</strong>: VIF = 56.34</li>
</ul></li>
</ul>
<p><strong>Implicações:</strong> - As variáveis X11, X17 e X18 apresentam alta correlação com outras variáveis independentes - Isso pode causar instabilidade nos coeficientes discriminantes - O determinante da matriz de correlação confirma a presença de multicolinearidade - Apesar disso, seguimos o exemplo de Hair et al.&nbsp;usando X6 e X18, reconhecendo esta limitação</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Matriz de correlação com visualização aprimorada</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>matriz_cor <span class="ot">&lt;-</span> <span class="fu">cor</span>(amostra_analise[, variaveis_independentes])</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Gráfico de correlação personalizado</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>corrplot<span class="sc">::</span><span class="fu">corrplot</span>(matriz_cor, <span class="at">method =</span> <span class="st">"color"</span>, <span class="at">type =</span> <span class="st">"upper"</span>, </span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>                   <span class="at">order =</span> <span class="st">"hclust"</span>, <span class="at">tl.cex =</span> <span class="fl">0.8</span>, <span class="at">tl.col =</span> <span class="st">"black"</span>,</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>                   <span class="at">col =</span> RColorBrewer<span class="sc">::</span><span class="fu">brewer.pal</span>(<span class="at">n =</span> <span class="dv">8</span>, <span class="at">name =</span> <span class="st">"RdYlBu"</span>),</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>                   <span class="at">title =</span> <span class="st">"Matriz de Correlação das Variáveis Independentes"</span>,</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>                   <span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">2</span>,<span class="dv">0</span>))</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Determinante da matriz de correlação</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>det_cor <span class="ot">&lt;-</span> <span class="fu">det</span>(matriz_cor)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="co"># VIF para identificar multicolinearidade</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>modelo_temp <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">as.numeric</span>(X1) <span class="sc">~</span> ., <span class="at">data =</span> amostra_analise[, <span class="fu">c</span>(<span class="st">"X1"</span>, variaveis_independentes)])</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>vif_valores <span class="ot">&lt;-</span> car<span class="sc">::</span><span class="fu">vif</span>(modelo_temp)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Análise de Multicolinearidade:</strong></p>
<ul>
<li><strong>Determinante da matriz de correlação</strong>: 8^{-6}</li>
</ul>
<p><strong>Classificação dos Valores VIF:</strong></p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Categoria</th>
<th>Critério</th>
<th>Variáveis</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Baixa</strong> (&lt; 5)</td>
<td>Aceitável</td>
<td>X6, X7, X8, X10, X13, X14, X15, X16</td>
</tr>
<tr class="even">
<td><strong>Moderada</strong> (5-10)</td>
<td>Preocupante</td>
<td>X9, X12</td>
</tr>
<tr class="odd">
<td><strong>Alta</strong> (≥ 10)</td>
<td>Problemática</td>
<td>X11, X17, X18</td>
</tr>
</tbody>
</table>
<p><strong>Variáveis com Multicolinearidade Severa:</strong></p>
<div class="cell">
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">Variável</th>
<th style="text-align: left;">Descrição</th>
<th style="text-align: right;">VIF</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">X11</td>
<td style="text-align: left;">Product Line</td>
<td style="text-align: right;">52.77</td>
</tr>
<tr class="even">
<td style="text-align: left;">X17</td>
<td style="text-align: left;">Price Flexibility</td>
<td style="text-align: right;">41.49</td>
</tr>
<tr class="odd">
<td style="text-align: left;">X18</td>
<td style="text-align: left;">Delivery Speed</td>
<td style="text-align: right;">56.34</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
</section>
<section id="estágio-4-estimação-do-modelo-discriminante-e-avaliação-do-ajuste-geral" class="level3">
<h3 class="anchored" data-anchor-id="estágio-4-estimação-do-modelo-discriminante-e-avaliação-do-ajuste-geral">Estágio 4: Estimação do Modelo Discriminante e Avaliação do Ajuste Geral</h3>
<section id="método-stepwise" class="level4">
<h4 class="anchored" data-anchor-id="método-stepwise">4.1 Método Stepwise</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(klaR)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Implementando stepwise manual baseado em critérios estatísticos</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>f_univariados <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="fu">length</span>(variaveis_independentes))</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>p_univariados <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="fu">length</span>(variaveis_independentes))</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(f_univariados) <span class="ot">&lt;-</span> variaveis_independentes</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(p_univariados) <span class="ot">&lt;-</span> variaveis_independentes</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="fu">seq_along</span>(variaveis_independentes)) {</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>  var <span class="ot">&lt;-</span> variaveis_independentes[i]</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>  formula_temp <span class="ot">&lt;-</span> <span class="fu">as.formula</span>(<span class="fu">paste</span>(var, <span class="st">"~ X1"</span>))</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tryCatch</span>({</span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>    anova_temp <span class="ot">&lt;-</span> <span class="fu">aov</span>(formula_temp, <span class="at">data =</span> amostra_analise)</span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>    anova_summary <span class="ot">&lt;-</span> <span class="fu">summary</span>(anova_temp)</span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>    f_univariados[i] <span class="ot">&lt;-</span> anova_summary[[<span class="dv">1</span>]][<span class="st">"X1"</span>, <span class="st">"F value"</span>]</span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>    p_univariados[i] <span class="ot">&lt;-</span> anova_summary[[<span class="dv">1</span>]][<span class="st">"X1"</span>, <span class="st">"Pr(&gt;F)"</span>]</span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>  }, <span class="at">error =</span> <span class="cf">function</span>(e) {</span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a>    f_univariados[i] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a>    p_univariados[i] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Ordenando variáveis por poder discriminante</span></span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a>ordem_importancia <span class="ot">&lt;-</span> <span class="fu">order</span>(f_univariados, <span class="at">decreasing =</span> <span class="cn">TRUE</span>)</span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a>vars_ordenadas <span class="ot">&lt;-</span> variaveis_independentes[ordem_importancia]</span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a>vars_significativas <span class="ot">&lt;-</span> <span class="fu">names</span>(p_univariados[p_univariados <span class="sc">&lt;</span> <span class="fl">0.05</span>])</span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-30"><a href="#cb11-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Testando modelo Hair et al.: X6 + X18</span></span>
<span id="cb11-31"><a href="#cb11-31" aria-hidden="true" tabindex="-1"></a>formula_hair <span class="ot">&lt;-</span> <span class="fu">as.formula</span>(<span class="st">"cbind(X6, X18) ~ X1"</span>)</span>
<span id="cb11-32"><a href="#cb11-32" aria-hidden="true" tabindex="-1"></a>manova_hair <span class="ot">&lt;-</span> <span class="fu">manova</span>(formula_hair, <span class="at">data =</span> amostra_analise)</span>
<span id="cb11-33"><a href="#cb11-33" aria-hidden="true" tabindex="-1"></a>resultado_hair <span class="ot">&lt;-</span> <span class="fu">summary</span>(manova_hair, <span class="at">test =</span> <span class="st">"Wilks"</span>)</span>
<span id="cb11-34"><a href="#cb11-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-35"><a href="#cb11-35" aria-hidden="true" tabindex="-1"></a>modelo_stepwise <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb11-36"><a href="#cb11-36" aria-hidden="true" tabindex="-1"></a>  <span class="at">formula =</span> <span class="st">"X1 ~ X6 + X18"</span>,</span>
<span id="cb11-37"><a href="#cb11-37" aria-hidden="true" tabindex="-1"></a>  <span class="at">selected_vars =</span> <span class="fu">c</span>(<span class="st">"X6"</span>, <span class="st">"X18"</span>),</span>
<span id="cb11-38"><a href="#cb11-38" aria-hidden="true" tabindex="-1"></a>  <span class="at">wilks_lambda =</span> resultado_hair<span class="sc">$</span>stats[<span class="st">"X1"</span>, <span class="st">"Wilks"</span>],</span>
<span id="cb11-39"><a href="#cb11-39" aria-hidden="true" tabindex="-1"></a>  <span class="at">f_statistic =</span> resultado_hair<span class="sc">$</span>stats[<span class="st">"X1"</span>, <span class="st">"approx F"</span>],</span>
<span id="cb11-40"><a href="#cb11-40" aria-hidden="true" tabindex="-1"></a>  <span class="at">p_value =</span> resultado_hair<span class="sc">$</span>stats[<span class="st">"X1"</span>, <span class="st">"Pr(&gt;F)"</span>]</span>
<span id="cb11-41"><a href="#cb11-41" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Análise Univariada de Variáveis:</strong></p>
<p><strong>Ranking por Poder Discriminante (Top 5):</strong></p>
<div class="cell">
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 11%">
<col style="width: 13%">
<col style="width: 30%">
<col style="width: 11%">
<col style="width: 11%">
<col style="width: 20%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;">Posição</th>
<th style="text-align: left;">Variável</th>
<th style="text-align: left;">Descrição</th>
<th style="text-align: right;">F.value</th>
<th style="text-align: right;">p.valor</th>
<th style="text-align: left;">Significância</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: left;">X18</td>
<td style="text-align: left;">Delivery Speed</td>
<td style="text-align: right;">24.425</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">***</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: left;">X6</td>
<td style="text-align: left;">Product Quality</td>
<td style="text-align: right;">22.885</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">***</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: left;">X9</td>
<td style="text-align: left;">Complaint Resolution</td>
<td style="text-align: right;">22.739</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">***</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: left;">X11</td>
<td style="text-align: left;">Product Line</td>
<td style="text-align: right;">20.721</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">***</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5</td>
<td style="text-align: left;">X16</td>
<td style="text-align: left;">Ordering &amp; Billing</td>
<td style="text-align: right;">17.664</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">***</td>
</tr>
</tbody>
</table>
</div>
</div>
<p><strong>Modelo Stepwise Final:</strong></p>
<ul>
<li><strong>Fórmula selecionada</strong>: X1 ~ X6 + X18</li>
<li><strong>Variáveis incluídas</strong>: X6 + X18</li>
<li><strong>Lambda de Wilks</strong>: 0.2901</li>
<li><strong>Estatística F</strong>: 23.99</li>
<li><strong>p-valor</strong>: 2.388e-14</li>
<li><strong>Total de variáveis significativas</strong>: 7 de 13</li>
</ul>
<p><strong>Justificativa da Seleção:</strong> Embora X18 seja a variável mais discriminante univariadamente, seguimos o exemplo de Hair et al.&nbsp;usando X6 (Product Quality) + X18 (Delivery Speed) por razões teóricas e interpretabilidade gerencial.</p>
</section>
<section id="análise-discriminante-linear" class="level4">
<h4 class="anchored" data-anchor-id="análise-discriminante-linear">4.2 Análise Discriminante Linear</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Modelo final conforme Hair et al. (X6 e X18)</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>modelo_final <span class="ot">&lt;-</span> <span class="fu">lda</span>(X1 <span class="sc">~</span> X6 <span class="sc">+</span> X18, <span class="at">data =</span> amostra_analise)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Autovalores e variância explicada</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>eigenvalues <span class="ot">&lt;-</span> modelo_final<span class="sc">$</span>svd<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>variancia_explicada <span class="ot">&lt;-</span> eigenvalues <span class="sc">/</span> <span class="fu">sum</span>(eigenvalues) <span class="sc">*</span> <span class="dv">100</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>O modelo discriminante final utiliza as variáveis X6 (Product Quality) e X18 (Delivery Speed), seguindo o exemplo de Hair et al.</p>
<p><strong>Características do Modelo:</strong></p>
<ul>
<li><strong>Número de funções discriminantes</strong>: 2</li>
<li><strong>Variância explicada pela Função 1</strong>: 83.5%</li>
<li><strong>Variância explicada pela Função 2</strong>: 16.5%</li>
<li><strong>Variância total explicada</strong>: 100%</li>
</ul>
<p><strong>Autovalores:</strong></p>
<div class="cell">
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">Função</th>
<th style="text-align: right;">Autovalor</th>
<th style="text-align: right;">Variância.Explicada….</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">LD 1</td>
<td style="text-align: right;">45.9897</td>
<td style="text-align: right;">83.5</td>
</tr>
<tr class="even">
<td style="text-align: left;">LD 2</td>
<td style="text-align: right;">9.0940</td>
<td style="text-align: right;">16.5</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="significância-estatística" class="level4">
<h4 class="anchored" data-anchor-id="significância-estatística">4.3 Significância Estatística</h4>
<p>O teste de significância avalia se o modelo discriminante é estatisticamente significativo.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>modelo_manova <span class="ot">&lt;-</span> <span class="fu">manova</span>(<span class="fu">cbind</span>(X6, X18) <span class="sc">~</span> X1, <span class="at">data =</span> amostra_analise)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modelo_manova, <span class="at">test =</span> <span class="st">"Wilks"</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          Df   Wilks approx F num Df den Df    Pr(&gt;F)    
X1         2 0.29005    23.99      4    112 2.388e-14 ***
Residuals 57                                             
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary.aov</span>(modelo_manova)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Response X6 :
            Df Sum Sq Mean Sq F value    Pr(&gt;F)    
X1           2 51.890 25.9451  22.885 5.062e-08 ***
Residuals   57 64.622  1.1337                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

 Response X18 :
            Df Sum Sq Mean Sq F value    Pr(&gt;F)    
X1           2 15.643  7.8216  24.425 2.182e-08 ***
Residuals   57 18.253  0.3202                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p><strong>Interpretação dos Resultados de Significância:</strong></p>
<p><strong>Teste MANOVA (Multivariado):</strong> - <strong>Lambda de Wilks = 0.29005</strong>: Valor baixo indica boa discriminação entre grupos - <strong>F aproximado = 23.99</strong>: Estatística F alta sugere diferenças significativas - <strong>p-valor = 2.388e-14</strong>: Altamente significativo (p &lt; 0.001) - <strong>Conclusão</strong>: O modelo discriminante é estatisticamente significativo</p>
<p><strong>Análises Univariadas por Variável:</strong></p>
<p><strong>X6 (Product Quality):</strong> - <strong>F = 22.885</strong>: Alta capacidade discriminante individual - <strong>p-valor = 5.062e-08</strong>: Altamente significativo - <strong>Interpretação</strong>: A qualidade do produto varia significativamente entre os grupos de tempo de relacionamento</p>
<p><strong>X18 (Delivery Speed):</strong> - <strong>F = 24.425</strong>: Maior capacidade discriminante individual entre as duas variáveis - <strong>p-valor = 2.182e-08</strong>: Altamente significativo<br>
- <strong>Interpretação</strong>: A percepção da velocidade de entrega é o melhor discriminador individual entre os grupos</p>
<p><strong>Implicações Gerenciais:</strong> 1. Ambas as variáveis contribuem significativamente para distinguir os grupos 2. Velocidade de entrega (X18) é ligeiramente mais discriminante que qualidade (X6) 3. O modelo como um todo tem poder discriminante muito forte 4. As percepções evoluem significativamente com o tempo de relacionamento</p>
</section>
<section id="centróides-dos-grupos" class="level4">
<h4 class="anchored" data-anchor-id="centróides-dos-grupos">4.4 Centróides dos Grupos</h4>
<p>Os centróides representam o “centro” de cada grupo no espaço discriminante.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>centroides <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(amostra_analise[, <span class="fu">c</span>(<span class="st">"X6"</span>, <span class="st">"X18"</span>)], </span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>                       <span class="at">by =</span> <span class="fu">list</span>(amostra_analise<span class="sc">$</span>X1), <span class="at">FUN =</span> mean)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(centroides)[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="st">"Grupo"</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>predict_centroides <span class="ot">&lt;-</span> <span class="fu">predict</span>(modelo_final, centroides[, <span class="fu">c</span>(<span class="st">"X6"</span>, <span class="st">"X18"</span>)])</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>centroides_discriminantes <span class="ot">&lt;-</span> predict_centroides<span class="sc">$</span>x</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(centroides_discriminantes) <span class="ot">&lt;-</span> centroides<span class="sc">$</span>Grupo</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Centróides no Espaço Discriminante:"</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "\nCentróides no Espaço Discriminante:"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(centroides_discriminantes)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                      LD1        LD2
Menos de 1 ano -1.6066271  0.3095983
De 1 a 5 anos   0.2579251 -0.7144520
Mais de 5 anos  1.4698995  0.5292210</code></pre>
</div>
</div>
<p><strong>Análise dos Centróides no Espaço Discriminante:</strong></p>
<p><strong>Posicionamento dos Grupos:</strong></p>
<table class="caption-top table">
<colgroup>
<col style="width: 21%">
<col style="width: 15%">
<col style="width: 15%">
<col style="width: 46%">
</colgroup>
<thead>
<tr class="header">
<th>Grupo</th>
<th>LD1</th>
<th>LD2</th>
<th>Interpretação</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Menos de 1 ano</td>
<td>-1.61</td>
<td>0.31</td>
<td>Percepções mais baixas, posicionamento único</td>
</tr>
<tr class="even">
<td>De 1 a 5 anos</td>
<td>0.26</td>
<td>-0.71</td>
<td>Percepções intermediárias, diferenciação moderada</td>
</tr>
<tr class="odd">
<td>Mais de 5 anos</td>
<td>1.47</td>
<td>0.53</td>
<td>Percepções mais elevadas, alta satisfação</td>
</tr>
</tbody>
</table>
<p><strong>Padrões Identificados:</strong></p>
<ol type="1">
<li><p><strong>Evolução Linear em LD1</strong>: Os valores de LD1 crescem progressivamente (-1.61 → 0.26 → 1.47), indicando melhoria das percepções com o tempo de relacionamento</p></li>
<li><p><strong>Separação Clara</strong>: A distância entre centróides confirma que os grupos são bem diferenciados no espaço discriminante</p></li>
<li><p><strong>Trajetória de Relacionamento</strong>:</p>
<ul>
<li><strong>Clientes novos</strong> (&lt; 1 ano): Expectativas em formação, percepções iniciais mais críticas</li>
<li><strong>Clientes intermediários</strong> (1-5 anos): Período de consolidação das percepções</li>
<li><strong>Clientes estabelecidos</strong> (&gt; 5 anos): Relacionamento maduro, percepções mais positivas</li>
</ul></li>
</ol>
<p><strong>Interpretação das Funções Discriminantes:</strong></p>
<ul>
<li><strong>LD1</strong>: Representa principalmente a <strong>evolução temporal</strong> das percepções (experiência acumulada)</li>
<li><strong>LD2</strong>: Representa <strong>diferenças qualitativas</strong> específicas entre os grupos intermediários e extremos</li>
</ul>
<p><strong>Implicações Estratégicas:</strong> - Foco na <strong>retenção inicial</strong>: Clientes novos precisam de atenção especial - <strong>Gestão da jornada</strong>: Processo gradual de melhoria das percepções - <strong>Fidelização</strong>: Clientes de longo prazo são verdadeiros advogados da marca</p>
</section>
</section>
<section id="estágio-5-interpretação-dos-resultados" class="level3">
<h3 class="anchored" data-anchor-id="estágio-5-interpretação-dos-resultados">Estágio 5: Interpretação dos Resultados</h3>
<section id="cargas-discriminantes-matriz-estrutural" class="level4">
<h4 class="anchored" data-anchor-id="cargas-discriminantes-matriz-estrutural">5.1 Cargas Discriminantes (Matriz Estrutural)</h4>
<p>As cargas discriminantes mostram a correlação entre cada variável independente e as funções discriminantes.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculando cargas discriminantes (correlações entre variáveis e funções)</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Escores discriminantes para todas as observações</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>escores_discriminantes <span class="ot">&lt;-</span> <span class="fu">predict</span>(modelo_final, amostra_analise)<span class="sc">$</span>x</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Matriz de cargas (correlações)</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>variaveis_completas <span class="ot">&lt;-</span> amostra_analise[, variaveis_independentes]</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>cargas_discriminantes <span class="ot">&lt;-</span> <span class="fu">cor</span>(variaveis_completas, escores_discriminantes)</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Matriz de Cargas Discriminantes (não-rotacionadas):"</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Matriz de Cargas Discriminantes (não-rotacionadas):"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">round</span>(cargas_discriminantes, <span class="dv">3</span>))</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       LD1    LD2
X6   0.736  0.677
X7   0.235 -0.313
X8   0.103  0.182
X9   0.728 -0.467
X10  0.177 -0.237
X11  0.773 -0.049
X12  0.192 -0.418
X13 -0.251 -0.286
X14  0.163  0.058
X15  0.041 -0.084
X16  0.699 -0.416
X17  0.012 -0.699
X18  0.765 -0.644</code></pre>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Identificando variáveis descritivas (|carga| &gt;= 0.40)</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>cargas_importantes <span class="ot">&lt;-</span> <span class="fu">abs</span>(cargas_discriminantes) <span class="sc">&gt;=</span> <span class="fl">0.40</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Variáveis Descritivas por Função (|carga| &gt;= 0.40):"</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "\nVariáveis Descritivas por Função (|carga| &gt;= 0.40):"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(cargas_discriminantes)) {</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Função"</span>, i, <span class="st">":"</span>, <span class="fu">names</span>(<span class="fu">which</span>(cargas_importantes[, i])), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Função 1 : X6 X9 X11 X16 X18 
Função 2 : X6 X9 X12 X16 X17 X18 </code></pre>
</div>
</div>
<p><strong>Interpretação da Matriz de Cargas Discriminantes:</strong></p>
<p><strong>Análise da Função Discriminante 1 (LD1):</strong></p>
<p><strong>Variáveis com Cargas Altas (|carga| ≥ 0.40):</strong> - <strong>X11 (Product Line)</strong>: 0.773 - Maior contribuição para LD1 - <strong>X18 (Delivery Speed)</strong>: 0.765 - Forte correlação positiva - <strong>X6 (Product Quality)</strong>: 0.736 - Alta correlação positiva<br>
- <strong>X9 (Complaint Resolution)</strong>: 0.728 - Contribuição significativa - <strong>X16 (Ordering &amp; Billing)</strong>: 0.699 - Forte correlação</p>
<p><strong>Interpretação de LD1</strong>: Representa a <strong>dimensão geral de satisfação</strong> com aspectos operacionais e de qualidade da HBAT. Valores altos indicam percepções positivas em qualidade, entrega, linha de produtos e resolução de problemas.</p>
<p><strong>Análise da Função Discriminante 2 (LD2):</strong></p>
<p><strong>Variáveis com Cargas Altas (|carga| ≥ 0.40):</strong> - <strong>X17 (Price Flexibility)</strong>: -0.699 - Maior magnitude (negativa) - <strong>X6 (Product Quality)</strong>: 0.677 - Correlação positiva forte - <strong>X18 (Delivery Speed)</strong>: -0.644 - Correlação negativa significativa - <strong>X9 (Complaint Resolution)</strong>: -0.467 - Contribuição moderada negativa - <strong>X16 (Ordering &amp; Billing)</strong>: -0.416 - Correlação negativa - <strong>X12 (Salesforce Image)</strong>: -0.418 - Contribuição moderada negativa</p>
<p><strong>Interpretação de LD2</strong>: Representa um <strong>contraste entre qualidade percebida</strong> versus <strong>flexibilidade operacional</strong>. Separa grupos com diferentes prioridades: qualidade versus agilidade/flexibilidade.</p>
</section>
<section id="rotação-varimax" class="level4">
<h4 class="anchored" data-anchor-id="rotação-varimax">5.2 Rotação VARIMAX</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Aplicando rotação VARIMAX às cargas discriminantes</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stats)</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">ncol</span>(cargas_discriminantes) <span class="sc">&gt;</span> <span class="dv">1</span>) {</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>  rotacao_varimax <span class="ot">&lt;-</span> <span class="fu">varimax</span>(cargas_discriminantes)</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>  cargas_rotacionadas <span class="ot">&lt;-</span> rotacao_varimax<span class="sc">$</span>loadings[]</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="st">"Matriz de Cargas Discriminantes (rotacionadas - VARIMAX):"</span>)</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">round</span>(cargas_rotacionadas, <span class="dv">3</span>))</span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Variáveis descritivas após rotação</span></span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>  cargas_rot_importantes <span class="ot">&lt;-</span> <span class="fu">abs</span>(cargas_rotacionadas) <span class="sc">&gt;=</span> <span class="fl">0.40</span></span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Variáveis Descritivas por Função Rotacionada (|carga| &gt;= 0.40):"</span>)</span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(cargas_rotacionadas)) {</span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"Função"</span>, i, <span class="st">":"</span>, <span class="fu">names</span>(<span class="fu">which</span>(cargas_rot_importantes[, i])), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a>  cargas_rotacionadas <span class="ot">&lt;-</span> cargas_discriminantes</span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="st">"Apenas uma função discriminante - rotação não aplicável"</span>)</span>
<span id="cb29-20"><a href="#cb29-20" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Matriz de Cargas Discriminantes (rotacionadas - VARIMAX):"
       LD1    LD2
X6   1.000  0.003
X7  -0.038 -0.390
X8   0.199  0.064
X9   0.222 -0.836
X10 -0.029 -0.294
X11  0.538 -0.558
X12 -0.140 -0.438
X13 -0.378 -0.042
X14  0.160 -0.067
X15 -0.027 -0.090
X16  0.235 -0.779
X17 -0.462 -0.524
X18  0.129 -0.992
[1] "\nVariáveis Descritivas por Função Rotacionada (|carga| &gt;= 0.40):"
Função 1 : X6 X11 X17 
Função 2 : X9 X11 X12 X16 X17 X18 </code></pre>
</div>
</div>
<p><strong>Interpretação das Cargas Rotacionadas (VARIMAX):</strong></p>
<p>A rotação VARIMAX simplifica a estrutura, criando fatores mais interpretáveis:</p>
<p><strong>Função 1 Rotacionada:</strong> - <strong>X6 (Product Quality)</strong>: 1.000 - Carga perfeitamente concentrada - <strong>X11 (Product Line)</strong>: 0.538 - Contribuição moderada - <strong>X17 (Price Flexibility)</strong>: -0.462 - Contribuição negativa moderada</p>
<p><strong>Interpretação</strong>: LD1 rotacionada representa essencialmente a <strong>“Dimensão de Qualidade”</strong>, contrastando qualidade percebida com flexibilidade de preços.</p>
<p><strong>Função 2 Rotacionada:</strong> - <strong>X18 (Delivery Speed)</strong>: -0.992 - Concentração quase perfeita (negativa) - <strong>X9 (Complaint Resolution)</strong>: -0.836 - Alta correlação negativa<br>
- <strong>X16 (Ordering &amp; Billing)</strong>: -0.779 - Correlação negativa forte - <strong>X11 (Product Line)</strong>: -0.558 - Contribuição moderada - <strong>X17 (Price Flexibility)</strong>: -0.524 - Contribuição moderada</p>
<p><strong>Interpretação</strong>: LD2 rotacionada representa a <strong>“Dimensão Operacional”</strong>, focando em velocidade, eficiência e aspectos transacionais.</p>
<p><strong>Vantagem da Rotação:</strong> - <strong>Simplifica interpretação</strong>: Cada função tem foco mais claro - <strong>Reduz ambiguidade</strong>: Menos variáveis com cargas altas em múltiplas funções - <strong>Facilita comunicação gerencial</strong>: Dimensões mais intuitivas</p>
</section>
<section id="índice-de-potência" class="level4">
<h4 class="anchored" data-anchor-id="índice-de-potência">5.3 Índice de Potência</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculando índice de potência conforme Hair et al.</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">ncol</span>(cargas_discriminantes) <span class="sc">&gt;</span> <span class="dv">1</span>) {</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Autovalores relativos</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>  autovalores_relativos <span class="ot">&lt;-</span> eigenvalues <span class="sc">/</span> <span class="fu">sum</span>(eigenvalues)</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Índice de potência para cada variável</span></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>  indice_potencia <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="fu">nrow</span>(cargas_rotacionadas))</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">names</span>(indice_potencia) <span class="ot">&lt;-</span> <span class="fu">rownames</span>(cargas_rotacionadas)</span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(cargas_rotacionadas)) {</span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>    potencia_total <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(cargas_rotacionadas)) {</span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>      potencia_total <span class="ot">&lt;-</span> potencia_total <span class="sc">+</span> (cargas_rotacionadas[i, j]<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> autovalores_relativos[j])</span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a>    indice_potencia[i] <span class="ot">&lt;-</span> potencia_total</span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Ordenando por índice de potência</span></span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a>  indice_potencia_ordenado <span class="ot">&lt;-</span> <span class="fu">sort</span>(indice_potencia, <span class="at">decreasing =</span> <span class="cn">TRUE</span>)</span>
<span id="cb31-20"><a href="#cb31-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb31-21"><a href="#cb31-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="st">"Índice de Potência das Variáveis:"</span>)</span>
<span id="cb31-22"><a href="#cb31-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">round</span>(indice_potencia_ordenado, <span class="dv">3</span>))</span>
<span id="cb31-23"><a href="#cb31-23" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Índice de Potência das Variáveis:"
   X6   X11   X17   X18    X9   X16   X13   X12    X8    X7   X14   X10   X15 
0.835 0.293 0.224 0.176 0.157 0.146 0.120 0.048 0.034 0.026 0.022 0.015 0.002 </code></pre>
</div>
</div>
<p><strong>Interpretação do Índice de Potência:</strong></p>
<p>O índice de potência combina a contribuição de cada variável em todas as funções, ponderada pela importância relativa de cada função:</p>
<p><strong>Ranking por Poder Discriminante Total:</strong></p>
<table class="caption-top table">
<colgroup>
<col style="width: 16%">
<col style="width: 18%">
<col style="width: 20%">
<col style="width: 15%">
<col style="width: 28%">
</colgroup>
<thead>
<tr class="header">
<th>Posição</th>
<th>Variável</th>
<th>Descrição</th>
<th>Índice</th>
<th>Interpretação</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1º</td>
<td>X6</td>
<td>Product Quality</td>
<td>0.835</td>
<td><strong>Discriminador principal</strong> - fundamental para diferenciação</td>
</tr>
<tr class="even">
<td>2º</td>
<td>X11</td>
<td>Product Line</td>
<td>0.293</td>
<td><strong>Segundo mais importante</strong> - variedade de produtos relevante</td>
</tr>
<tr class="odd">
<td>3º</td>
<td>X17</td>
<td>Price Flexibility</td>
<td>0.224</td>
<td><strong>Terceiro lugar</strong> - flexibilidade de preços diferencia grupos</td>
</tr>
<tr class="even">
<td>4º</td>
<td>X18</td>
<td>Delivery Speed</td>
<td>0.176</td>
<td><strong>Quarto lugar</strong> - velocidade importante apesar de estar no modelo</td>
</tr>
<tr class="odd">
<td>5º</td>
<td>X9</td>
<td>Complaint Resolution</td>
<td>0.157</td>
<td><strong>Moderadamente importante</strong> - resolução de problemas diferencia</td>
</tr>
</tbody>
</table>
<p><strong>Insights Principais:</strong></p>
<ol type="1">
<li><strong>X6 (Product Quality)</strong> é o discriminador dominante, responsável por mais de 83% do poder discriminante total</li>
<li><strong>X18 (Delivery Speed)</strong>, apesar de estar no modelo final, ocupa apenas a 4ª posição no índice de potência</li>
<li><strong>X11 (Product Line)</strong> aparece como segundo mais importante, sugerindo que variedade de produtos é crucial</li>
<li>A <strong>concentração de poder</strong> nas primeiras variáveis indica que poucas dimensões explicam a maior parte da discriminação</li>
</ol>
<p><strong>Implicações Gerenciais:</strong> - <strong>Prioridade máxima</strong>: Investir em qualidade do produto - <strong>Segunda prioridade</strong>: Expandir e melhorar linha de produtos - <strong>Terceira prioridade</strong>: Desenvolver flexibilidade de preços - <strong>Monitoramento</strong>: Acompanhar velocidade de entrega e resolução de reclamações</p>
</section>
<section id="razões-f-univariadas" class="level4">
<h4 class="anchored" data-anchor-id="razões-f-univariadas">5.4 Razões F Univariadas</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculando razões F univariadas para cada variável</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>razoes_f <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="fu">length</span>(variaveis_independentes))</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(razoes_f) <span class="ot">&lt;-</span> variaveis_independentes</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(var <span class="cf">in</span> variaveis_independentes) {</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>  formula_temp <span class="ot">&lt;-</span> <span class="fu">as.formula</span>(<span class="fu">paste</span>(var, <span class="st">"~ X1"</span>))</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>  anova_temp <span class="ot">&lt;-</span> <span class="fu">aov</span>(formula_temp, <span class="at">data =</span> amostra_analise)</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>  razoes_f[var] <span class="ot">&lt;-</span> <span class="fu">summary</span>(anova_temp)[[<span class="dv">1</span>]][<span class="st">"X1"</span>, <span class="st">"F value"</span>]</span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Ordenando por valor F</span></span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>razoes_f_ordenadas <span class="ot">&lt;-</span> <span class="fu">sort</span>(razoes_f, <span class="at">decreasing =</span> <span class="cn">TRUE</span>)</span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Razões F Univariadas:"</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Razões F Univariadas:"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">round</span>(razoes_f_ordenadas, <span class="dv">3</span>))</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   X18     X6     X9    X11    X16    X17    X13    X12    X14     X7    X10 
24.425 22.885 22.739 20.721 17.664 13.892  9.075  2.873  0.919  0.799  0.753 
    X8    X15 
 0.715  0.599 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Teste de significância (α = 0.05)</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>p_valores <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="fu">length</span>(variaveis_independentes))</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(p_valores) <span class="ot">&lt;-</span> variaveis_independentes</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(var <span class="cf">in</span> variaveis_independentes) {</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>  formula_temp <span class="ot">&lt;-</span> <span class="fu">as.formula</span>(<span class="fu">paste</span>(var, <span class="st">"~ X1"</span>))</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>  anova_temp <span class="ot">&lt;-</span> <span class="fu">aov</span>(formula_temp, <span class="at">data =</span> amostra_analise)</span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>  p_valores[var] <span class="ot">&lt;-</span> <span class="fu">summary</span>(anova_temp)[[<span class="dv">1</span>]][<span class="st">"X1"</span>, <span class="st">"Pr(&gt;F)"</span>]</span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Variáveis Significativas (p &lt; 0.05):"</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "\nVariáveis Significativas (p &lt; 0.05):"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">names</span>(p_valores[p_valores <span class="sc">&lt;</span> <span class="fl">0.05</span>]))</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "X6"  "X9"  "X11" "X13" "X16" "X17" "X18"</code></pre>
</div>
</div>
<p><strong>Interpretação das Razões F Univariadas:</strong></p>
<p><strong>Ranking de Poder Discriminante Individual:</strong></p>
<table class="caption-top table">
<colgroup>
<col style="width: 15%">
<col style="width: 16%">
<col style="width: 15%">
<col style="width: 15%">
<col style="width: 13%">
<col style="width: 25%">
</colgroup>
<thead>
<tr class="header">
<th>Posição</th>
<th>Variável</th>
<th>F-value</th>
<th>p-valor</th>
<th>Status</th>
<th>Interpretação</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1º</td>
<td>X18 (Delivery Speed)</td>
<td>24.425</td>
<td>&lt; 0.001</td>
<td>***</td>
<td><strong>Melhor discriminador individual</strong></td>
</tr>
<tr class="even">
<td>2º</td>
<td>X6 (Product Quality)</td>
<td>22.885</td>
<td>&lt; 0.001</td>
<td>***</td>
<td><strong>Segundo melhor discriminador</strong></td>
</tr>
<tr class="odd">
<td>3º</td>
<td>X9 (Complaint Resolution)</td>
<td>22.739</td>
<td>&lt; 0.001</td>
<td>***</td>
<td><strong>Terceiro em poder discriminante</strong></td>
</tr>
<tr class="even">
<td>4º</td>
<td>X11 (Product Line)</td>
<td>20.721</td>
<td>&lt; 0.001</td>
<td>***</td>
<td><strong>Quarto colocado significativo</strong></td>
</tr>
<tr class="odd">
<td>5º</td>
<td>X16 (Ordering &amp; Billing)</td>
<td>17.664</td>
<td>&lt; 0.001</td>
<td>***</td>
<td><strong>Quinto em importância</strong></td>
</tr>
</tbody>
</table>
<p><strong>Variáveis Significativas (p &lt; 0.05):</strong> X6, X9, X11, X13, X16, X17, X18 (7 de 13 variáveis)</p>
<p><strong>Comparação: Poder Individual vs.&nbsp;Poder Combinado:</strong></p>
<ol type="1">
<li><strong>X18 (Delivery Speed)</strong>:
<ul>
<li>Individual: 1º lugar (F = 24.425)</li>
<li>Combinado: 4º lugar (Índice = 0.176)</li>
<li><strong>Interpretação</strong>: Excelente discriminador individual, mas com alguma redundância no modelo conjunto</li>
</ul></li>
<li><strong>X6 (Product Quality)</strong>:
<ul>
<li>Individual: 2º lugar (F = 22.885)<br>
</li>
<li>Combinado: 1º lugar (Índice = 0.835)</li>
<li><strong>Interpretação</strong>: Forte individual e dominante no modelo conjunto</li>
</ul></li>
</ol>
<p><strong>Insights sobre Seleção de Variáveis:</strong></p>
<ul>
<li><strong>Critério Hair et al.</strong>: Usar X6 + X18 é justificado pelo alto poder discriminante individual de ambas</li>
<li><strong>Potencial de otimização</strong>: X9 (Complaint Resolution) tem poder individual muito alto e poderia ser considerada</li>
<li><strong>Redundância</strong>: Várias variáveis significativas sugerem multicolinearidade (confirmada pelos VIF altos)</li>
</ul>
<p><strong>Recomendações Gerenciais:</strong> 1. <strong>Foco primário</strong>: Delivery Speed e Product Quality (variáveis do modelo) 2. <strong>Foco secundário</strong>: Complaint Resolution (alto poder discriminante individual)<br>
3. <strong>Monitoramento</strong>: Product Line e Ordering &amp; Billing (significativas e importantes) 4. <strong>Revisão</strong>: Considerar modelo expandido incluindo X9 para melhor discriminação</p>
</section>
<section id="gráfico-de-vetores-de-atribuição-no-espaço-discriminante" class="level4">
<h4 class="anchored" data-anchor-id="gráfico-de-vetores-de-atribuição-no-espaço-discriminante">5.5 Gráfico de Vetores de Atribuição no Espaço Discriminante</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Gráfico dos valores F univariados com descrições</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>f_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">Variavel =</span> <span class="fu">names</span>(f_univariados),</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">F_Value =</span> f_univariados,</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">P_Value =</span> p_univariados,</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">Significativo =</span> p_univariados <span class="sc">&lt;</span> <span class="fl">0.05</span></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">Variavel_Desc =</span> <span class="fu">sapply</span>(Variavel, obter_descricao))</span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>p_f_values <span class="ot">&lt;-</span> ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(f_df, ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(Variavel_Desc, F_Value), </span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a>                                                 <span class="at">y =</span> F_Value, <span class="at">fill =</span> Significativo)) <span class="sc">+</span></span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_col</span>(<span class="at">alpha =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_text</span>(ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">round</span>(F_Value, <span class="dv">1</span>)), <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.1</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"TRUE"</span> <span class="ot">=</span> <span class="st">"steelblue"</span>, <span class="st">"FALSE"</span> <span class="ot">=</span> <span class="st">"gray70"</span>),</span>
<span id="cb41-16"><a href="#cb41-16" aria-hidden="true" tabindex="-1"></a>                            <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"FALSE"</span> <span class="ot">=</span> <span class="st">"Não Significativo"</span>, <span class="st">"TRUE"</span> <span class="ot">=</span> <span class="st">"Significativo"</span>)) <span class="sc">+</span></span>
<span id="cb41-17"><a href="#cb41-17" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Valores F Univariados para Seleção de Variáveis"</span>,</span>
<span id="cb41-18"><a href="#cb41-18" aria-hidden="true" tabindex="-1"></a>                <span class="at">subtitle =</span> <span class="st">"Poder discriminante individual de cada variável"</span>,</span>
<span id="cb41-19"><a href="#cb41-19" aria-hidden="true" tabindex="-1"></a>                <span class="at">x =</span> <span class="st">"Variáveis"</span>, <span class="at">y =</span> <span class="st">"Estatística F"</span>,</span>
<span id="cb41-20"><a href="#cb41-20" aria-hidden="true" tabindex="-1"></a>                <span class="at">fill =</span> <span class="st">"Significância</span><span class="sc">\n</span><span class="st">(p &lt; 0.05)"</span>) <span class="sc">+</span></span>
<span id="cb41-21"><a href="#cb41-21" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb41-22"><a href="#cb41-22" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme</span>(<span class="at">plot.title =</span> ggplot2<span class="sc">::</span><span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb41-23"><a href="#cb41-23" aria-hidden="true" tabindex="-1"></a>                 <span class="at">axis.text.y =</span> ggplot2<span class="sc">::</span><span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>))</span>
<span id="cb41-24"><a href="#cb41-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-25"><a href="#cb41-25" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p_f_values)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Criando gráfico de vetores de atribuição (variáveis no espaço discriminante)</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>escores_todos <span class="ot">&lt;-</span> <span class="fu">predict</span>(modelo_final, amostra_analise)<span class="sc">$</span>x</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>df_escores <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">Funcao1 =</span> escores_todos[, <span class="dv">1</span>],</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">Funcao2 =</span> escores_todos[, <span class="dv">2</span>],</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">Grupo =</span> amostra_analise<span class="sc">$</span>X1,</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">Probabilidades =</span> <span class="fu">apply</span>(<span class="fu">predict</span>(modelo_final, amostra_analise)<span class="sc">$</span>posterior, <span class="dv">1</span>, max)</span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Adicionando centróides</span></span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>df_centroides <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">Funcao1 =</span> centroides_discriminantes[, <span class="dv">1</span>],</span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">Funcao2 =</span> centroides_discriminantes[, <span class="dv">2</span>],</span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">Grupo =</span> <span class="fu">factor</span>(<span class="fu">rownames</span>(centroides_discriminantes), </span>
<span id="cb42-15"><a href="#cb42-15" aria-hidden="true" tabindex="-1"></a>                <span class="at">levels =</span> <span class="fu">levels</span>(amostra_analise<span class="sc">$</span>X1))</span>
<span id="cb42-16"><a href="#cb42-16" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb42-17"><a href="#cb42-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-18"><a href="#cb42-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Escalonando as cargas para melhor visualização</span></span>
<span id="cb42-19"><a href="#cb42-19" aria-hidden="true" tabindex="-1"></a>escala_vetor <span class="ot">&lt;-</span> <span class="dv">3</span>  <span class="co"># Fator de escala para os vetores</span></span>
<span id="cb42-20"><a href="#cb42-20" aria-hidden="true" tabindex="-1"></a>cargas_escalonadas <span class="ot">&lt;-</span> cargas_discriminantes <span class="sc">*</span> escala_vetor</span>
<span id="cb42-21"><a href="#cb42-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-22"><a href="#cb42-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Preparando dados dos vetores com descrições</span></span>
<span id="cb42-23"><a href="#cb42-23" aria-hidden="true" tabindex="-1"></a>vetores_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb42-24"><a href="#cb42-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">Variavel =</span> <span class="fu">rownames</span>(cargas_discriminantes),</span>
<span id="cb42-25"><a href="#cb42-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">LD1_start =</span> <span class="dv">0</span>,</span>
<span id="cb42-26"><a href="#cb42-26" aria-hidden="true" tabindex="-1"></a>  <span class="at">LD2_start =</span> <span class="dv">0</span>,</span>
<span id="cb42-27"><a href="#cb42-27" aria-hidden="true" tabindex="-1"></a>  <span class="at">LD1_end =</span> cargas_escalonadas[, <span class="dv">1</span>],</span>
<span id="cb42-28"><a href="#cb42-28" aria-hidden="true" tabindex="-1"></a>  <span class="at">LD2_end =</span> cargas_escalonadas[, <span class="dv">2</span>],</span>
<span id="cb42-29"><a href="#cb42-29" aria-hidden="true" tabindex="-1"></a>  <span class="at">Magnitude =</span> <span class="fu">sqrt</span>(cargas_discriminantes[, <span class="dv">1</span>]<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> cargas_discriminantes[, <span class="dv">2</span>]<span class="sc">^</span><span class="dv">2</span>),</span>
<span id="cb42-30"><a href="#cb42-30" aria-hidden="true" tabindex="-1"></a>  <span class="at">Significativa =</span> <span class="fu">rownames</span>(cargas_discriminantes) <span class="sc">%in%</span> vars_significativas</span>
<span id="cb42-31"><a href="#cb42-31" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb42-32"><a href="#cb42-32" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">Variavel_Desc =</span> <span class="fu">sapply</span>(Variavel, obter_descricao))</span>
<span id="cb42-33"><a href="#cb42-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-34"><a href="#cb42-34" aria-hidden="true" tabindex="-1"></a><span class="co"># Gráfico de vetores de atribuição expandidos</span></span>
<span id="cb42-35"><a href="#cb42-35" aria-hidden="true" tabindex="-1"></a>p_vetores <span class="ot">&lt;-</span> ggplot2<span class="sc">::</span><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb42-36"><a href="#cb42-36" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Pontos dos grupos (mais transparentes para não ofuscar os vetores)</span></span>
<span id="cb42-37"><a href="#cb42-37" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_point</span>(<span class="at">data =</span> df_escores, ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> Funcao1, <span class="at">y =</span> Funcao2, <span class="at">color =</span> Grupo), </span>
<span id="cb42-38"><a href="#cb42-38" aria-hidden="true" tabindex="-1"></a>                      <span class="at">alpha =</span> <span class="fl">0.3</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb42-39"><a href="#cb42-39" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Centróides dos grupos</span></span>
<span id="cb42-40"><a href="#cb42-40" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_point</span>(<span class="at">data =</span> df_centroides, ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> Funcao1, <span class="at">y =</span> Funcao2), </span>
<span id="cb42-41"><a href="#cb42-41" aria-hidden="true" tabindex="-1"></a>                      <span class="at">size =</span> <span class="dv">6</span>, <span class="at">shape =</span> <span class="dv">17</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb42-42"><a href="#cb42-42" aria-hidden="true" tabindex="-1"></a>  <span class="co"># LABELS DOS CENTRÓIDES - NOVO</span></span>
<span id="cb42-43"><a href="#cb42-43" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_text</span>(<span class="at">data =</span> df_centroides, </span>
<span id="cb42-44"><a href="#cb42-44" aria-hidden="true" tabindex="-1"></a>                     ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> Funcao1, <span class="at">y =</span> Funcao2, <span class="at">label =</span> Grupo),</span>
<span id="cb42-45"><a href="#cb42-45" aria-hidden="true" tabindex="-1"></a>                     <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">1.5</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">"black"</span>, </span>
<span id="cb42-46"><a href="#cb42-46" aria-hidden="true" tabindex="-1"></a>                     <span class="at">fontface =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="fl">3.5</span>,</span>
<span id="cb42-47"><a href="#cb42-47" aria-hidden="true" tabindex="-1"></a>                     <span class="at">box.padding =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb42-48"><a href="#cb42-48" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Vetores das variáveis</span></span>
<span id="cb42-49"><a href="#cb42-49" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_segment</span>(<span class="at">data =</span> vetores_df,</span>
<span id="cb42-50"><a href="#cb42-50" aria-hidden="true" tabindex="-1"></a>                        ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> LD1_start, <span class="at">y =</span> LD2_start, </span>
<span id="cb42-51"><a href="#cb42-51" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">xend =</span> LD1_end, <span class="at">yend =</span> LD2_end,</span>
<span id="cb42-52"><a href="#cb42-52" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">color =</span> Significativa, <span class="at">size =</span> Magnitude),</span>
<span id="cb42-53"><a href="#cb42-53" aria-hidden="true" tabindex="-1"></a>                        <span class="at">arrow =</span> ggplot2<span class="sc">::</span><span class="fu">arrow</span>(<span class="at">length =</span> ggplot2<span class="sc">::</span><span class="fu">unit</span>(<span class="fl">0.3</span>, <span class="st">"cm"</span>)),</span>
<span id="cb42-54"><a href="#cb42-54" aria-hidden="true" tabindex="-1"></a>                        <span class="at">alpha =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb42-55"><a href="#cb42-55" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Labels das variáveis com descrições</span></span>
<span id="cb42-56"><a href="#cb42-56" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_text</span>(<span class="at">data =</span> vetores_df,</span>
<span id="cb42-57"><a href="#cb42-57" aria-hidden="true" tabindex="-1"></a>                     ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> LD1_end <span class="sc">*</span> <span class="fl">1.1</span>, <span class="at">y =</span> LD2_end <span class="sc">*</span> <span class="fl">1.1</span>, </span>
<span id="cb42-58"><a href="#cb42-58" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">label =</span> Variavel_Desc, <span class="at">color =</span> Significativa),</span>
<span id="cb42-59"><a href="#cb42-59" aria-hidden="true" tabindex="-1"></a>                     <span class="at">size =</span> <span class="fl">2.5</span>, <span class="at">fontface =</span> <span class="st">"bold"</span>) <span class="sc">+</span></span>
<span id="cb42-60"><a href="#cb42-60" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Eixos de referência</span></span>
<span id="cb42-61"><a href="#cb42-61" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb42-62"><a href="#cb42-62" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb42-63"><a href="#cb42-63" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Escalas e temas</span></span>
<span id="cb42-64"><a href="#cb42-64" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"FALSE"</span> <span class="ot">=</span> <span class="st">"gray50"</span>, <span class="st">"TRUE"</span> <span class="ot">=</span> <span class="st">"red"</span>)) <span class="sc">+</span></span>
<span id="cb42-65"><a href="#cb42-65" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">scale_size_continuous</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="dv">2</span>), <span class="at">guide =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb42-66"><a href="#cb42-66" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Vetores de Atribuição das Variáveis no Espaço Discriminante"</span>,</span>
<span id="cb42-67"><a href="#cb42-67" aria-hidden="true" tabindex="-1"></a>                <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">"Vetores mostram contribuição das variáveis para as funções discriminantes</span><span class="sc">\n</span><span class="st">"</span>,</span>
<span id="cb42-68"><a href="#cb42-68" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"Triângulos pretos = centróides dos grupos | Escala dos vetores: "</span>, escala_vetor, <span class="st">"x"</span>),</span>
<span id="cb42-69"><a href="#cb42-69" aria-hidden="true" tabindex="-1"></a>                <span class="at">x =</span> <span class="fu">paste</span>(<span class="st">"Função Discriminante 1 ("</span>, <span class="fu">round</span>(variancia_explicada[<span class="dv">1</span>], <span class="dv">1</span>), <span class="st">"%)"</span>),</span>
<span id="cb42-70"><a href="#cb42-70" aria-hidden="true" tabindex="-1"></a>                <span class="at">y =</span> <span class="fu">paste</span>(<span class="st">"Função Discriminante 2 ("</span>, <span class="fu">round</span>(variancia_explicada[<span class="dv">2</span>], <span class="dv">1</span>), <span class="st">"%)"</span>),</span>
<span id="cb42-71"><a href="#cb42-71" aria-hidden="true" tabindex="-1"></a>                <span class="at">color =</span> <span class="st">"Variável</span><span class="sc">\n</span><span class="st">Significativa"</span>) <span class="sc">+</span></span>
<span id="cb42-72"><a href="#cb42-72" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb42-73"><a href="#cb42-73" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb42-74"><a href="#cb42-74" aria-hidden="true" tabindex="-1"></a>                 <span class="at">plot.title =</span> ggplot2<span class="sc">::</span><span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb42-75"><a href="#cb42-75" aria-hidden="true" tabindex="-1"></a>                 <span class="at">plot.subtitle =</span> ggplot2<span class="sc">::</span><span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>))</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in ggplot2::geom_text(data = df_centroides, ggplot2::aes(x = Funcao1, :
Ignoring unknown parameters: `box.padding`</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.
ℹ Please use `linewidth` instead.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p_vetores)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-25-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># IDENTIFICAÇÃO DOS GRUPOS DA VARIÁVEL DEPENDENTE</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">=== IDENTIFICAÇÃO DOS GRUPOS DA VARIÁVEL DEPENDENTE ===</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
=== IDENTIFICAÇÃO DOS GRUPOS DA VARIÁVEL DEPENDENTE ===</code></pre>
</div>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Variável Dependente: X1 (Customer Type)</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Variável Dependente: X1 (Customer Type)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Descrição: Tempo de relacionamento com a empresa HBAT</span><span class="sc">\n\n</span><span class="st">"</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Descrição: Tempo de relacionamento com a empresa HBAT</code></pre>
</div>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Grupos identificados no gráfico</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>grupos_identificados <span class="ot">&lt;-</span> <span class="fu">levels</span>(amostra_analise<span class="sc">$</span>X1)</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>freq_grupos <span class="ot">&lt;-</span> <span class="fu">table</span>(amostra_analise<span class="sc">$</span>X1)</span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>centroides_info <span class="ot">&lt;-</span> centroides_discriminantes</span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"GRUPOS REPRESENTADOS NO GRÁFICO:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>GRUPOS REPRESENTADOS NO GRÁFICO:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(grupos_identificados)) {</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>  grupo_nome <span class="ot">&lt;-</span> grupos_identificados[i]</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>  freq <span class="ot">&lt;-</span> freq_grupos[i]</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>  ld1_pos <span class="ot">&lt;-</span> <span class="fu">round</span>(centroides_info[grupo_nome, <span class="st">"LD1"</span>], <span class="dv">2</span>)</span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>  ld2_pos <span class="ot">&lt;-</span> <span class="fu">round</span>(centroides_info[grupo_nome, <span class="st">"LD2"</span>], <span class="dv">2</span>)</span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"🔺 GRUPO %d: %s</span><span class="sc">\n</span><span class="st">"</span>, i, grupo_nome))</span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"   - Frequência: %d casos (%.1f%%)</span><span class="sc">\n</span><span class="st">"</span>, </span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a>              freq, (freq<span class="sc">/</span><span class="fu">sum</span>(freq_grupos))<span class="sc">*</span><span class="dv">100</span>))</span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"   - Posição no gráfico: LD1 = %.2f, LD2 = %.2f</span><span class="sc">\n</span><span class="st">"</span>, ld1_pos, ld2_pos))</span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"   - Característica: %s</span><span class="sc">\n</span><span class="st">"</span>, </span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true" tabindex="-1"></a>              <span class="cf">switch</span>(i,</span>
<span id="cb54-13"><a href="#cb54-13" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"Clientes com relacionamento recente - percepções iniciais"</span>,</span>
<span id="cb54-14"><a href="#cb54-14" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"Clientes com relacionamento estabelecido - percepções moderadas"</span>, </span>
<span id="cb54-15"><a href="#cb54-15" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"Clientes com relacionamento consolidado - percepções elevadas"</span>)))</span>
<span id="cb54-16"><a href="#cb54-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb54-17"><a href="#cb54-17" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>🔺 GRUPO 1: Menos de 1 ano
   - Frequência: 20 casos (33.3%)
   - Posição no gráfico: LD1 = -1.61, LD2 = 0.31
   - Característica: Clientes com relacionamento recente - percepções iniciais

🔺 GRUPO 2: De 1 a 5 anos
   - Frequência: 22 casos (36.7%)
   - Posição no gráfico: LD1 = 0.26, LD2 = -0.71
   - Característica: Clientes com relacionamento estabelecido - percepções moderadas

🔺 GRUPO 3: Mais de 5 anos
   - Frequência: 18 casos (30.0%)
   - Posição no gráfico: LD1 = 1.47, LD2 = 0.53
   - Característica: Clientes com relacionamento consolidado - percepções elevadas</code></pre>
</div>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Interpretação dos centróides no espaço discriminante</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"INTERPRETAÇÃO DOS CENTRÓIDES (TRIÂNGULOS PRETOS):</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>INTERPRETAÇÃO DOS CENTRÓIDES (TRIÂNGULOS PRETOS):</code></pre>
</div>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"- Os triângulos pretos representam o 'centro' de cada grupo no espaço discriminante</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>- Os triângulos pretos representam o 'centro' de cada grupo no espaço discriminante</code></pre>
</div>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"- Sua posição indica as características médias de cada grupo</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>- Sua posição indica as características médias de cada grupo</code></pre>
</div>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"- A distância entre centróides mostra o grau de separação entre grupos</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>- A distância entre centróides mostra o grau de separação entre grupos</code></pre>
</div>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Análise das posições dos centróides</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">ANÁLISE DAS POSIÇÕES:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
ANÁLISE DAS POSIÇÕES:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(centroides_info)) {</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>  grupo_nome <span class="ot">&lt;-</span> <span class="fu">rownames</span>(centroides_info)[i]</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>  ld1_val <span class="ot">&lt;-</span> centroides_info[i, <span class="st">"LD1"</span>]</span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>  ld2_val <span class="ot">&lt;-</span> centroides_info[i, <span class="st">"LD2"</span>]</span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Interpretação baseada na posição</span></span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a>  interpretacao_ld1 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(ld1_val <span class="sc">&gt;</span> <span class="dv">0</span>, <span class="st">"valores altos em LD1"</span>, <span class="st">"valores baixos em LD1"</span>)</span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a>  interpretacao_ld2 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(ld2_val <span class="sc">&gt;</span> <span class="dv">0</span>, <span class="st">"valores altos em LD2"</span>, <span class="st">"valores baixos em LD2"</span>)</span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb66-10"><a href="#cb66-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"- %s: Caracterizado por %s e %s</span><span class="sc">\n</span><span class="st">"</span>, </span>
<span id="cb66-11"><a href="#cb66-11" aria-hidden="true" tabindex="-1"></a>              grupo_nome, interpretacao_ld1, interpretacao_ld2))</span>
<span id="cb66-12"><a href="#cb66-12" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>- Menos de 1 ano: Caracterizado por valores baixos em LD1 e valores altos em LD2
- De 1 a 5 anos: Caracterizado por valores altos em LD1 e valores baixos em LD2
- Mais de 5 anos: Caracterizado por valores altos em LD1 e valores altos em LD2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">LEGENDA DO GRÁFICO:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
LEGENDA DO GRÁFICO:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"🔺 Triângulos pretos = Centróides dos grupos</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>🔺 Triângulos pretos = Centróides dos grupos</code></pre>
</div>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"● Pontos coloridos = Observações individuais por grupo</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>● Pontos coloridos = Observações individuais por grupo</code></pre>
</div>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"→ Vetores vermelhos = Variáveis significativas (p &lt; 0.05)</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>→ Vetores vermelhos = Variáveis significativas (p &lt; 0.05)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"→ Vetores cinza = Variáveis não significativas</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>→ Vetores cinza = Variáveis não significativas</code></pre>
</div>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"📏 Comprimento do vetor = Magnitude da contribuição discriminante</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>📏 Comprimento do vetor = Magnitude da contribuição discriminante</code></pre>
</div>
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Interpretação dos vetores</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">=== INTERPRETAÇÃO DOS VETORES DE ATRIBUIÇÃO ===</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
=== INTERPRETAÇÃO DOS VETORES DE ATRIBUIÇÃO ===</code></pre>
</div>
</div>
</section>
<section id="análise-das-distâncias-entre-grupos" class="level4">
<h4 class="anchored" data-anchor-id="análise-das-distâncias-entre-grupos">6.4 Análise das Distâncias entre Grupos</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculando distâncias Mahalanobis entre centróides</span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>centroides_matriz <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(centroides_discriminantes)</span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Matriz de distâncias entre centróides</span></span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a>n_grupos <span class="ot">&lt;-</span> <span class="fu">nrow</span>(centroides_matriz)</span>
<span id="cb82-6"><a href="#cb82-6" aria-hidden="true" tabindex="-1"></a>dist_centroides <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, n_grupos, n_grupos)</span>
<span id="cb82-7"><a href="#cb82-7" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(dist_centroides) <span class="ot">&lt;-</span> <span class="fu">rownames</span>(centroides_matriz)</span>
<span id="cb82-8"><a href="#cb82-8" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(dist_centroides) <span class="ot">&lt;-</span> <span class="fu">rownames</span>(centroides_matriz)</span>
<span id="cb82-9"><a href="#cb82-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-10"><a href="#cb82-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_grupos) {</span>
<span id="cb82-11"><a href="#cb82-11" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_grupos) {</span>
<span id="cb82-12"><a href="#cb82-12" aria-hidden="true" tabindex="-1"></a>    dist_centroides[i, j] <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">sum</span>((centroides_matriz[i, ] <span class="sc">-</span> centroides_matriz[j, ])<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb82-13"><a href="#cb82-13" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb82-14"><a href="#cb82-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb82-15"><a href="#cb82-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-16"><a href="#cb82-16" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Matriz de Distâncias Euclidianas entre Centróides:"</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Matriz de Distâncias Euclidianas entre Centróides:"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">round</span>(dist_centroides, <span class="dv">3</span>))</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>               Menos de 1 ano De 1 a 5 anos Mais de 5 anos
Menos de 1 ano          0.000         2.127          3.084
De 1 a 5 anos           2.127         0.000          1.737
Mais de 5 anos          3.084         1.737          0.000</code></pre>
</div>
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualização das distâncias como heatmap</span></span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>dist_df <span class="ot">&lt;-</span> reshape2<span class="sc">::</span><span class="fu">melt</span>(dist_centroides)</span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(dist_df) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Grupo1"</span>, <span class="st">"Grupo2"</span>, <span class="st">"Distancia"</span>)</span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-5"><a href="#cb86-5" aria-hidden="true" tabindex="-1"></a>p_distancias <span class="ot">&lt;-</span> ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(dist_df, ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> Grupo1, <span class="at">y =</span> Grupo2, <span class="at">fill =</span> Distancia)) <span class="sc">+</span></span>
<span id="cb86-6"><a href="#cb86-6" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_tile</span>(<span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb86-7"><a href="#cb86-7" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_text</span>(ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">round</span>(Distancia, <span class="dv">2</span>)), </span>
<span id="cb86-8"><a href="#cb86-8" aria-hidden="true" tabindex="-1"></a>                     <span class="at">color =</span> <span class="st">"white"</span>, <span class="at">fontface =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb86-9"><a href="#cb86-9" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">scale_fill_viridis_c</span>(<span class="at">name =</span> <span class="st">"Distância</span><span class="sc">\n</span><span class="st">Euclidiana"</span>) <span class="sc">+</span></span>
<span id="cb86-10"><a href="#cb86-10" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Matriz de Distâncias entre Centróides dos Grupos"</span>,</span>
<span id="cb86-11"><a href="#cb86-11" aria-hidden="true" tabindex="-1"></a>                <span class="at">subtitle =</span> <span class="st">"Distâncias calculadas no espaço discriminante"</span>,</span>
<span id="cb86-12"><a href="#cb86-12" aria-hidden="true" tabindex="-1"></a>                <span class="at">x =</span> <span class="st">"Grupo"</span>, <span class="at">y =</span> <span class="st">"Grupo"</span>) <span class="sc">+</span></span>
<span id="cb86-13"><a href="#cb86-13" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb86-14"><a href="#cb86-14" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme</span>(<span class="at">plot.title =</span> ggplot2<span class="sc">::</span><span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb86-15"><a href="#cb86-15" aria-hidden="true" tabindex="-1"></a>                 <span class="at">axis.text.x =</span> ggplot2<span class="sc">::</span><span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span>
<span id="cb86-16"><a href="#cb86-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-17"><a href="#cb86-17" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p_distancias)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Análise de separação</span></span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>dist_matrix_upper <span class="ot">&lt;-</span> dist_centroides[<span class="fu">upper.tri</span>(dist_centroides)]</span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Identificando grupos mais próximos e mais distantes</span></span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a>dist_indices <span class="ot">&lt;-</span> <span class="fu">which</span>(dist_centroides <span class="sc">==</span> <span class="fu">min</span>(dist_matrix_upper), <span class="at">arr.ind =</span> <span class="cn">TRUE</span>)[<span class="dv">1</span>, ]</span>
<span id="cb87-6"><a href="#cb87-6" aria-hidden="true" tabindex="-1"></a>grupos_proximos <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rownames</span>(dist_centroides)[dist_indices[<span class="dv">1</span>]], </span>
<span id="cb87-7"><a href="#cb87-7" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">colnames</span>(dist_centroides)[dist_indices[<span class="dv">2</span>]])</span>
<span id="cb87-8"><a href="#cb87-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-9"><a href="#cb87-9" aria-hidden="true" tabindex="-1"></a>dist_indices_max <span class="ot">&lt;-</span> <span class="fu">which</span>(dist_centroides <span class="sc">==</span> <span class="fu">max</span>(dist_matrix_upper), <span class="at">arr.ind =</span> <span class="cn">TRUE</span>)[<span class="dv">1</span>, ]</span>
<span id="cb87-10"><a href="#cb87-10" aria-hidden="true" tabindex="-1"></a>grupos_distantes <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rownames</span>(dist_centroides)[dist_indices_max[<span class="dv">1</span>]], </span>
<span id="cb87-11"><a href="#cb87-11" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">colnames</span>(dist_centroides)[dist_indices_max[<span class="dv">2</span>]])</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Interpretação da Análise de Distâncias:</strong></p>
<p><strong>Matriz de Distâncias Euclidianas:</strong> - <strong>Menor distância</strong>: “De 1 a 5 anos” ↔︎ “Mais de 5 anos” (1.737) - <strong>Maior distância</strong>: “Menos de 1 ano” ↔︎ “Mais de 5 anos” (3.084) - <strong>Distância intermediária</strong>: “Menos de 1 ano” ↔︎ “De 1 a 5 anos” (2.127)</p>
<p><strong>Padrões de Similaridade:</strong></p>
<ol type="1">
<li><strong>Grupos Intermediário e Maduro são mais próximos</strong>:
<ul>
<li>Distância de apenas 1.737 unidades</li>
<li><strong>Interpretação</strong>: Após 1 ano, as percepções começam a convergir</li>
<li><strong>Implicação</strong>: O primeiro ano é crítico para formar percepções duradouras</li>
</ul></li>
<li><strong>Clientes Novos são mais distantes de todos</strong>:
<ul>
<li>Maior distância dos clientes maduros (3.084)</li>
<li><strong>Interpretação</strong>: Período inicial tem características muito distintas</li>
<li><strong>Implicação</strong>: Estratégias específicas necessárias para novos clientes</li>
</ul></li>
<li><strong>Progressão Não-Linear</strong>:
<ul>
<li>A evolução “Novo → Intermediário → Maduro” não é uniforme</li>
<li>Maior salto entre “Novo” e “Intermediário” (2.127)</li>
<li>Menor progressão entre “Intermediário” e “Maduro” (1.737)</li>
</ul></li>
</ol>
<p><strong>Insights Gerenciais:</strong></p>
<ul>
<li><strong>Período Crítico</strong>: Os primeiros 12 meses são fundamentais para retenção</li>
<li><strong>Convergência</strong>: Após 1 ano, clientes tendem a desenvolver percepções similares</li>
<li><strong>Segmentação</strong>: Dois grandes segmentos emergem: “Novos” vs.&nbsp;“Estabelecidos” (intermediários + maduros)</li>
</ul>
</section>
<section id="comparação-visual-espaço-original-vs.-espaço-discriminante" class="level4">
<h4 class="anchored" data-anchor-id="comparação-visual-espaço-original-vs.-espaço-discriminante">6.5 Comparação Visual: Espaço Original vs.&nbsp;Espaço Discriminante</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Comparando visualização no espaço original (X6, X18) vs. espaço discriminante</span></span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>p_original <span class="ot">&lt;-</span> ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(amostra_analise, ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> X6, <span class="at">y =</span> X18, <span class="at">color =</span> X1)) <span class="sc">+</span></span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">stat_ellipse</span>(<span class="at">level =</span> <span class="fl">0.68</span>, <span class="at">type =</span> <span class="st">"norm"</span>, <span class="at">size =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb88-5"><a href="#cb88-5" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_point</span>(<span class="at">data =</span> centroides, ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> X6, <span class="at">y =</span> X18), </span>
<span id="cb88-6"><a href="#cb88-6" aria-hidden="true" tabindex="-1"></a>                      <span class="at">size =</span> <span class="dv">8</span>, <span class="at">shape =</span> <span class="dv">17</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb88-7"><a href="#cb88-7" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">scale_color_brewer</span>(<span class="at">type =</span> <span class="st">"qual"</span>, <span class="at">palette =</span> <span class="st">"Set1"</span>) <span class="sc">+</span></span>
<span id="cb88-8"><a href="#cb88-8" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Espaço Original"</span>,</span>
<span id="cb88-9"><a href="#cb88-9" aria-hidden="true" tabindex="-1"></a>                <span class="at">subtitle =</span> <span class="st">"Variáveis originais do modelo discriminante"</span>,</span>
<span id="cb88-10"><a href="#cb88-10" aria-hidden="true" tabindex="-1"></a>                <span class="at">x =</span> descricoes_variaveis[<span class="st">"X6"</span>], </span>
<span id="cb88-11"><a href="#cb88-11" aria-hidden="true" tabindex="-1"></a>                <span class="at">y =</span> descricoes_variaveis[<span class="st">"X18"</span>],</span>
<span id="cb88-12"><a href="#cb88-12" aria-hidden="true" tabindex="-1"></a>                <span class="at">color =</span> <span class="st">"Grupo"</span>) <span class="sc">+</span></span>
<span id="cb88-13"><a href="#cb88-13" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb88-14"><a href="#cb88-14" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb88-15"><a href="#cb88-15" aria-hidden="true" tabindex="-1"></a>                 <span class="at">plot.title =</span> ggplot2<span class="sc">::</span><span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">face =</span> <span class="st">"bold"</span>))</span>
<span id="cb88-16"><a href="#cb88-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-17"><a href="#cb88-17" aria-hidden="true" tabindex="-1"></a>p_discriminante <span class="ot">&lt;-</span> ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(df_escores, ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> Funcao1, <span class="at">y =</span> Funcao2, <span class="at">color =</span> Grupo)) <span class="sc">+</span></span>
<span id="cb88-18"><a href="#cb88-18" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb88-19"><a href="#cb88-19" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">stat_ellipse</span>(<span class="at">level =</span> <span class="fl">0.68</span>, <span class="at">type =</span> <span class="st">"norm"</span>, <span class="at">size =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb88-20"><a href="#cb88-20" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_point</span>(<span class="at">data =</span> df_centroides, ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> Funcao1, <span class="at">y =</span> Funcao2), </span>
<span id="cb88-21"><a href="#cb88-21" aria-hidden="true" tabindex="-1"></a>                      <span class="at">size =</span> <span class="dv">8</span>, <span class="at">shape =</span> <span class="dv">17</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb88-22"><a href="#cb88-22" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">scale_color_brewer</span>(<span class="at">type =</span> <span class="st">"qual"</span>, <span class="at">palette =</span> <span class="st">"Set1"</span>) <span class="sc">+</span></span>
<span id="cb88-23"><a href="#cb88-23" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Espaço Discriminante (LD1 vs LD2)"</span>,</span>
<span id="cb88-24"><a href="#cb88-24" aria-hidden="true" tabindex="-1"></a>                <span class="at">subtitle =</span> <span class="st">"Funções discriminantes otimizadas para separação"</span>,</span>
<span id="cb88-25"><a href="#cb88-25" aria-hidden="true" tabindex="-1"></a>                <span class="at">x =</span> <span class="fu">paste</span>(<span class="st">"LD1 ("</span>, <span class="fu">round</span>(variancia_explicada[<span class="dv">1</span>], <span class="dv">1</span>), <span class="st">"%)"</span>),</span>
<span id="cb88-26"><a href="#cb88-26" aria-hidden="true" tabindex="-1"></a>                <span class="at">y =</span> <span class="fu">paste</span>(<span class="st">"LD2 ("</span>, <span class="fu">round</span>(variancia_explicada[<span class="dv">2</span>], <span class="dv">1</span>), <span class="st">"%)"</span>),</span>
<span id="cb88-27"><a href="#cb88-27" aria-hidden="true" tabindex="-1"></a>                <span class="at">color =</span> <span class="st">"Grupo"</span>) <span class="sc">+</span></span>
<span id="cb88-28"><a href="#cb88-28" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb88-29"><a href="#cb88-29" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb88-30"><a href="#cb88-30" aria-hidden="true" tabindex="-1"></a>                 <span class="at">plot.title =</span> ggplot2<span class="sc">::</span><span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">face =</span> <span class="st">"bold"</span>))</span>
<span id="cb88-31"><a href="#cb88-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-32"><a href="#cb88-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Combinando os gráficos</span></span>
<span id="cb88-33"><a href="#cb88-33" aria-hidden="true" tabindex="-1"></a>comparacao <span class="ot">&lt;-</span> gridExtra<span class="sc">::</span><span class="fu">grid.arrange</span>(</span>
<span id="cb88-34"><a href="#cb88-34" aria-hidden="true" tabindex="-1"></a>  p_original, p_discriminante, </span>
<span id="cb88-35"><a href="#cb88-35" aria-hidden="true" tabindex="-1"></a>  <span class="at">ncol =</span> <span class="dv">2</span>,</span>
<span id="cb88-36"><a href="#cb88-36" aria-hidden="true" tabindex="-1"></a>  <span class="at">top =</span> grid<span class="sc">::</span><span class="fu">textGrob</span>(<span class="st">"Comparação: Espaço Original vs. Espaço Discriminante"</span>, </span>
<span id="cb88-37"><a href="#cb88-37" aria-hidden="true" tabindex="-1"></a>                       <span class="at">gp =</span> grid<span class="sc">::</span><span class="fu">gpar</span>(<span class="at">fontsize =</span> <span class="dv">16</span>, <span class="at">fontface =</span> <span class="st">"bold"</span>))</span>
<span id="cb88-38"><a href="#cb88-38" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(comparacao)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>TableGrob (2 x 2) "arrange": 3 grobs
  z     cells    name                grob
1 1 (2-2,1-1) arrange      gtable[layout]
2 2 (2-2,2-2) arrange      gtable[layout]
3 3 (1-1,1-2) arrange text[GRID.text.321]</code></pre>
</div>
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Interpretação da comparação</span></span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">=== INTERPRETAÇÃO DA COMPARAÇÃO ===</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
=== INTERPRETAÇÃO DA COMPARAÇÃO ===</code></pre>
</div>
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"- Espaço Original: mostra sobreposição entre grupos</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>- Espaço Original: mostra sobreposição entre grupos</code></pre>
</div>
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"- Espaço Discriminante: maximiza separação entre grupos</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>- Espaço Discriminante: maximiza separação entre grupos</code></pre>
</div>
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"- A transformação discriminante melhora a separabilidade</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>- A transformação discriminante melhora a separabilidade</code></pre>
</div>
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"- LD1 e LD2 são combinações lineares que maximizam discriminação</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>- LD1 e LD2 são combinações lineares que maximizam discriminação</code></pre>
</div>
</div>
</section>
</section>
<section id="estágio-6-validação-dos-resultados" class="level3">
<h3 class="anchored" data-anchor-id="estágio-6-validação-dos-resultados">Estágio 6: Validação dos Resultados</h3>
<section id="matriz-de-classificação-e-validação" class="level4">
<h4 class="anchored" data-anchor-id="matriz-de-classificação-e-validação">6.6 Matriz de Classificação e Validação</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Classificação da amostra de análise</span></span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a>predicoes_analise <span class="ot">&lt;-</span> <span class="fu">predict</span>(modelo_final, amostra_analise)</span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a>matriz_confusao_analise <span class="ot">&lt;-</span> <span class="fu">table</span>(<span class="at">Predito =</span> predicoes_analise<span class="sc">$</span>class, </span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a>                                <span class="at">Real =</span> amostra_analise<span class="sc">$</span>X1)</span>
<span id="cb101-5"><a href="#cb101-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-6"><a href="#cb101-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Matriz de Classificação - Amostra de Análise:"</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Matriz de Classificação - Amostra de Análise:"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(matriz_confusao_analise)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                Real
Predito          Menos de 1 ano De 1 a 5 anos Mais de 5 anos
  Menos de 1 ano             16             2              0
  De 1 a 5 anos               3            14              1
  Mais de 5 anos              1             6             17</code></pre>
</div>
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Taxa de acerto geral</span></span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a>acerto_geral_analise <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">diag</span>(matriz_confusao_analise)) <span class="sc">/</span> <span class="fu">sum</span>(matriz_confusao_analise)</span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-4"><a href="#cb105-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Taxa de acerto por grupo</span></span>
<span id="cb105-5"><a href="#cb105-5" aria-hidden="true" tabindex="-1"></a>acerto_por_grupo_analise <span class="ot">&lt;-</span> <span class="fu">diag</span>(matriz_confusao_analise) <span class="sc">/</span> <span class="fu">rowSums</span>(matriz_confusao_analise)</span>
<span id="cb105-6"><a href="#cb105-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Taxa de Acerto por Grupo (Análise):"</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Taxa de Acerto por Grupo (Análise):"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">round</span>(acerto_por_grupo_analise <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>))</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Menos de 1 ano  De 1 a 5 anos Mais de 5 anos 
          88.9           77.8           70.8 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualização da matriz de confusão</span></span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a>matriz_conf_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(matriz_confusao_analise)</span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(matriz_conf_df) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Predito"</span>, <span class="st">"Real"</span>, <span class="st">"Freq"</span>)</span>
<span id="cb109-4"><a href="#cb109-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-5"><a href="#cb109-5" aria-hidden="true" tabindex="-1"></a>p_matriz_conf <span class="ot">&lt;-</span> ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(matriz_conf_df, ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> Real, <span class="at">y =</span> Predito, <span class="at">fill =</span> Freq)) <span class="sc">+</span></span>
<span id="cb109-6"><a href="#cb109-6" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_tile</span>(<span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb109-7"><a href="#cb109-7" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_text</span>(ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">label =</span> Freq), <span class="at">color =</span> <span class="st">"white"</span>, <span class="at">size =</span> <span class="dv">6</span>, <span class="at">fontface =</span> <span class="st">"bold"</span>) <span class="sc">+</span></span>
<span id="cb109-8"><a href="#cb109-8" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">scale_fill_viridis_c</span>(<span class="at">name =</span> <span class="st">"Frequência"</span>) <span class="sc">+</span></span>
<span id="cb109-9"><a href="#cb109-9" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Matriz de Confusão - Amostra de Análise"</span>,</span>
<span id="cb109-10"><a href="#cb109-10" aria-hidden="true" tabindex="-1"></a>                <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">"Taxa de Acerto Geral:"</span>, <span class="fu">round</span>(acerto_geral_analise <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>), <span class="st">"%"</span>),</span>
<span id="cb109-11"><a href="#cb109-11" aria-hidden="true" tabindex="-1"></a>                <span class="at">x =</span> <span class="st">"Grupo Real"</span>, <span class="at">y =</span> <span class="st">"Grupo Predito"</span>) <span class="sc">+</span></span>
<span id="cb109-12"><a href="#cb109-12" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb109-13"><a href="#cb109-13" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme</span>(<span class="at">plot.title =</span> ggplot2<span class="sc">::</span><span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb109-14"><a href="#cb109-14" aria-hidden="true" tabindex="-1"></a>                 <span class="at">axis.text.x =</span> ggplot2<span class="sc">::</span><span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span>
<span id="cb109-15"><a href="#cb109-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-16"><a href="#cb109-16" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p_matriz_conf)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Taxa de Acerto Geral (Análise)</strong>: 78.3%</p>
<p><strong>Taxa de Acerto por Grupo (Análise)</strong>:</p>
<div class="cell">
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">Grupo</th>
<th style="text-align: right;">Taxa.de.Acerto….</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Menos de 1 ano</td>
<td style="text-align: right;">88.9</td>
</tr>
<tr class="even">
<td style="text-align: left;">De 1 a 5 anos</td>
<td style="text-align: right;">77.8</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Mais de 5 anos</td>
<td style="text-align: right;">70.8</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="validação-cruzada" class="level4">
<h4 class="anchored" data-anchor-id="validação-cruzada">6.7 Validação Cruzada</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Função para validação cruzada</span></span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a>validacao_cruzada <span class="ot">&lt;-</span> <span class="cf">function</span>(dados, formula) {</span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(dados)</span>
<span id="cb110-4"><a href="#cb110-4" aria-hidden="true" tabindex="-1"></a>  predicoes <span class="ot">&lt;-</span> <span class="fu">character</span>(n)</span>
<span id="cb110-5"><a href="#cb110-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb110-6"><a href="#cb110-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb110-7"><a href="#cb110-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Treina modelo sem a observação i</span></span>
<span id="cb110-8"><a href="#cb110-8" aria-hidden="true" tabindex="-1"></a>    dados_treino <span class="ot">&lt;-</span> dados[<span class="sc">-</span>i, ]</span>
<span id="cb110-9"><a href="#cb110-9" aria-hidden="true" tabindex="-1"></a>    modelo_temp <span class="ot">&lt;-</span> MASS<span class="sc">::</span><span class="fu">lda</span>(formula, <span class="at">data =</span> dados_treino)</span>
<span id="cb110-10"><a href="#cb110-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb110-11"><a href="#cb110-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Prediz a observação i</span></span>
<span id="cb110-12"><a href="#cb110-12" aria-hidden="true" tabindex="-1"></a>    predicao_temp <span class="ot">&lt;-</span> <span class="fu">predict</span>(modelo_temp, dados[i, ])</span>
<span id="cb110-13"><a href="#cb110-13" aria-hidden="true" tabindex="-1"></a>    predicoes[i] <span class="ot">&lt;-</span> <span class="fu">as.character</span>(predicao_temp<span class="sc">$</span>class)</span>
<span id="cb110-14"><a href="#cb110-14" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb110-15"><a href="#cb110-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb110-16"><a href="#cb110-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">factor</span>(predicoes, <span class="at">levels =</span> <span class="fu">levels</span>(dados<span class="sc">$</span>X1)))</span>
<span id="cb110-17"><a href="#cb110-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb110-18"><a href="#cb110-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-19"><a href="#cb110-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Aplicando validação cruzada</span></span>
<span id="cb110-20"><a href="#cb110-20" aria-hidden="true" tabindex="-1"></a>predicoes_cv <span class="ot">&lt;-</span> <span class="fu">validacao_cruzada</span>(amostra_analise, X1 <span class="sc">~</span> X6 <span class="sc">+</span> X18)</span>
<span id="cb110-21"><a href="#cb110-21" aria-hidden="true" tabindex="-1"></a>matriz_confusao_cv <span class="ot">&lt;-</span> <span class="fu">table</span>(<span class="at">Predito =</span> predicoes_cv, <span class="at">Real =</span> amostra_analise<span class="sc">$</span>X1)</span>
<span id="cb110-22"><a href="#cb110-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-23"><a href="#cb110-23" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Matriz de Classificação - Validação Cruzada:"</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Matriz de Classificação - Validação Cruzada:"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(matriz_confusao_cv)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                Real
Predito          Menos de 1 ano De 1 a 5 anos Mais de 5 anos
  Menos de 1 ano             16             2              0
  De 1 a 5 anos               3            14              1
  Mais de 5 anos              1             6             17</code></pre>
</div>
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Taxa de acerto validação cruzada</span></span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a>acerto_geral_cv <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">diag</span>(matriz_confusao_cv)) <span class="sc">/</span> <span class="fu">sum</span>(matriz_confusao_cv)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Taxa de Acerto Geral (Validação Cruzada)</strong>: 78.3%</p>
</section>
<section id="validação-externa" class="level4">
<h4 class="anchored" data-anchor-id="validação-externa">6.8 Validação Externa</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Classificação da amostra de validação</span></span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a>predicoes_validacao <span class="ot">&lt;-</span> <span class="fu">predict</span>(modelo_final, amostra_validacao)</span>
<span id="cb115-3"><a href="#cb115-3" aria-hidden="true" tabindex="-1"></a>matriz_confusao_validacao <span class="ot">&lt;-</span> <span class="fu">table</span>(<span class="at">Predito =</span> predicoes_validacao<span class="sc">$</span>class, </span>
<span id="cb115-4"><a href="#cb115-4" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">Real =</span> amostra_validacao<span class="sc">$</span>X1)</span>
<span id="cb115-5"><a href="#cb115-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-6"><a href="#cb115-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Matriz de Classificação - Amostra de Validação:"</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Matriz de Classificação - Amostra de Validação:"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(matriz_confusao_validacao)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                Real
Predito          Menos de 1 ano De 1 a 5 anos Mais de 5 anos
  Menos de 1 ano             10             1              0
  De 1 a 5 anos               1            10              4
  Mais de 5 anos              1             2             11</code></pre>
</div>
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Taxa de acerto amostra de validação</span></span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a>acerto_geral_validacao <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">diag</span>(matriz_confusao_validacao)) <span class="sc">/</span> <span class="fu">sum</span>(matriz_confusao_validacao)</span>
<span id="cb119-3"><a href="#cb119-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-4"><a href="#cb119-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Taxa de acerto por grupo</span></span>
<span id="cb119-5"><a href="#cb119-5" aria-hidden="true" tabindex="-1"></a>acerto_por_grupo_validacao <span class="ot">&lt;-</span> <span class="fu">diag</span>(matriz_confusao_validacao) <span class="sc">/</span> <span class="fu">rowSums</span>(matriz_confusao_validacao)</span>
<span id="cb119-6"><a href="#cb119-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Taxa de Acerto por Grupo (Validação):"</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Taxa de Acerto por Grupo (Validação):"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">round</span>(acerto_por_grupo_validacao <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>))</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Menos de 1 ano  De 1 a 5 anos Mais de 5 anos 
          90.9           66.7           78.6 </code></pre>
</div>
</div>
<p><strong>Taxa de Acerto Geral (Validação)</strong>: 77.5%</p>
</section>
<section id="critérios-de-chance" class="level4">
<h4 class="anchored" data-anchor-id="critérios-de-chance">6.9 Critérios de Chance</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculando critérios de chance</span></span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a>tamanhos_grupos <span class="ot">&lt;-</span> <span class="fu">table</span>(amostra_analise<span class="sc">$</span>X1)</span>
<span id="cb123-3"><a href="#cb123-3" aria-hidden="true" tabindex="-1"></a>proporcoes_grupos <span class="ot">&lt;-</span> tamanhos_grupos <span class="sc">/</span> <span class="fu">sum</span>(tamanhos_grupos)</span>
<span id="cb123-4"><a href="#cb123-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-5"><a href="#cb123-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Critério de chance proporcional</span></span>
<span id="cb123-6"><a href="#cb123-6" aria-hidden="true" tabindex="-1"></a>criterio_chance_proporcional <span class="ot">&lt;-</span> <span class="fu">sum</span>(proporcoes_grupos<span class="sc">^</span><span class="dv">2</span>) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb123-7"><a href="#cb123-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-8"><a href="#cb123-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Critério de chance máxima</span></span>
<span id="cb123-9"><a href="#cb123-9" aria-hidden="true" tabindex="-1"></a>criterio_chance_maxima <span class="ot">&lt;-</span> <span class="fu">max</span>(proporcoes_grupos) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb123-10"><a href="#cb123-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-11"><a href="#cb123-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Gráfico de comparação das taxas de acerto</span></span>
<span id="cb123-12"><a href="#cb123-12" aria-hidden="true" tabindex="-1"></a>taxas_acerto <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb123-13"><a href="#cb123-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">Metodo =</span> <span class="fu">c</span>(<span class="st">"Análise"</span>, <span class="st">"Validação Cruzada"</span>, <span class="st">"Validação Externa"</span>, </span>
<span id="cb123-14"><a href="#cb123-14" aria-hidden="true" tabindex="-1"></a>             <span class="st">"Critério Proporcional"</span>, <span class="st">"Critério Máximo"</span>),</span>
<span id="cb123-15"><a href="#cb123-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">Taxa =</span> <span class="fu">c</span>(acerto_geral_analise <span class="sc">*</span> <span class="dv">100</span>, </span>
<span id="cb123-16"><a href="#cb123-16" aria-hidden="true" tabindex="-1"></a>           acerto_geral_cv <span class="sc">*</span> <span class="dv">100</span>,</span>
<span id="cb123-17"><a href="#cb123-17" aria-hidden="true" tabindex="-1"></a>           acerto_geral_validacao <span class="sc">*</span> <span class="dv">100</span>,</span>
<span id="cb123-18"><a href="#cb123-18" aria-hidden="true" tabindex="-1"></a>           criterio_chance_proporcional,</span>
<span id="cb123-19"><a href="#cb123-19" aria-hidden="true" tabindex="-1"></a>           criterio_chance_maxima),</span>
<span id="cb123-20"><a href="#cb123-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">Tipo =</span> <span class="fu">c</span>(<span class="st">"Modelo"</span>, <span class="st">"Modelo"</span>, <span class="st">"Modelo"</span>, <span class="st">"Referência"</span>, <span class="st">"Referência"</span>)</span>
<span id="cb123-21"><a href="#cb123-21" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb123-22"><a href="#cb123-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-23"><a href="#cb123-23" aria-hidden="true" tabindex="-1"></a>p_performance <span class="ot">&lt;-</span> ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(taxas_acerto, ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(Metodo, Taxa), <span class="at">y =</span> Taxa, <span class="at">fill =</span> Tipo)) <span class="sc">+</span></span>
<span id="cb123-24"><a href="#cb123-24" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_col</span>(<span class="at">alpha =</span> <span class="fl">0.8</span>, <span class="at">width =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb123-25"><a href="#cb123-25" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_text</span>(ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">paste0</span>(<span class="fu">round</span>(Taxa, <span class="dv">1</span>), <span class="st">"%"</span>)), </span>
<span id="cb123-26"><a href="#cb123-26" aria-hidden="true" tabindex="-1"></a>                     <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.1</span>, <span class="at">size =</span> <span class="dv">4</span>, <span class="at">fontface =</span> <span class="st">"bold"</span>) <span class="sc">+</span></span>
<span id="cb123-27"><a href="#cb123-27" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb123-28"><a href="#cb123-28" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Modelo"</span> <span class="ot">=</span> <span class="st">"steelblue"</span>, <span class="st">"Referência"</span> <span class="ot">=</span> <span class="st">"coral"</span>)) <span class="sc">+</span></span>
<span id="cb123-29"><a href="#cb123-29" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Comparação das Taxas de Acerto"</span>,</span>
<span id="cb123-30"><a href="#cb123-30" aria-hidden="true" tabindex="-1"></a>                <span class="at">subtitle =</span> <span class="st">"Modelo vs. Critérios de Chance"</span>,</span>
<span id="cb123-31"><a href="#cb123-31" aria-hidden="true" tabindex="-1"></a>                <span class="at">x =</span> <span class="st">"Método de Validação"</span>, </span>
<span id="cb123-32"><a href="#cb123-32" aria-hidden="true" tabindex="-1"></a>                <span class="at">y =</span> <span class="st">"Taxa de Acerto (%)"</span>,</span>
<span id="cb123-33"><a href="#cb123-33" aria-hidden="true" tabindex="-1"></a>                <span class="at">fill =</span> <span class="st">"Tipo"</span>) <span class="sc">+</span></span>
<span id="cb123-34"><a href="#cb123-34" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb123-35"><a href="#cb123-35" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb123-36"><a href="#cb123-36" aria-hidden="true" tabindex="-1"></a>                 <span class="at">plot.title =</span> ggplot2<span class="sc">::</span><span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>))</span>
<span id="cb123-37"><a href="#cb123-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-38"><a href="#cb123-38" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p_performance)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-32-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Critérios de Chance:</strong></p>
<ul>
<li><strong>Critério de Chance Proporcional</strong>: 33.6%</li>
<li><strong>Critério de Chance Máxima</strong>: 36.7%</li>
</ul>
<p><strong>Comparação com Resultados Obtidos:</strong></p>
<ul>
<li>Taxa de Acerto Análise: 78.3% vs Critério Proporcional: 33.6%</li>
<li>Taxa de Acerto Validação Cruzada: 78.3% vs Critério Proporcional: 33.6%<br>
</li>
<li>Taxa de Acerto Validação: 77.5% vs Critério Proporcional: 33.6%</li>
</ul>
</section>
</section>
<section id="resumo-da-interpretação-gerencial" class="level3">
<h3 class="anchored" data-anchor-id="resumo-da-interpretação-gerencial">Resumo da Interpretação Gerencial</h3>
<p>Os resultados da análise discriminante revelam insights importantes sobre a diferenciação de clientes baseada no tempo de relacionamento. Com o dataset completo analisado, identificamos que de 13 variáveis independentes testadas, apenas 2 foram suficientes para uma discriminação efetiva.</p>
<section id="principais-descobertas" class="level4">
<h4 class="anchored" data-anchor-id="principais-descobertas">Principais Descobertas:</h4>
<ol type="1">
<li><p><strong>Variáveis Discriminantes</strong>: X6 (Product Quality) e X18 (Delivery Speed) são os principais diferenciadores, representando aproximadamente 100% da variância discriminante total.</p></li>
<li><p><strong>Precisão do Modelo</strong>: O modelo alcança alta taxa de acertos na amostra de análise, superando significativamente os critérios de chance.</p></li>
<li><p><strong>Diferenças entre Grupos</strong>:</p>
<ul>
<li><strong>Clientes novos</strong> (&lt; 1 ano): Menores percepções de qualidade e velocidade</li>
<li><strong>Clientes intermediários</strong> (1-5 anos): Percepções moderadas</li>
<li><strong>Clientes estabelecidos</strong> (&gt; 5 anos): Maiores percepções de qualidade e velocidade</li>
</ul></li>
</ol>
</section>
<section id="implicações-gerenciais" class="level4">
<h4 class="anchored" data-anchor-id="implicações-gerenciais">Implicações Gerenciais:</h4>
<ul>
<li><strong>Foco na Qualidade</strong>: Investir na melhoria da qualidade do produto é fundamental para reter clientes</li>
<li><strong>Otimização de Entregas</strong>: A velocidade de entrega é um diferencial competitivo crítico</li>
<li><strong>Segmentação</strong>: Os 3 grupos identificados requerem estratégias diferenciadas</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Médias dos grupos para interpretação</span></span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a>medias_grupos <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(amostra_analise[, variaveis_independentes], </span>
<span id="cb124-3"><a href="#cb124-3" aria-hidden="true" tabindex="-1"></a>                          <span class="at">by =</span> <span class="fu">list</span>(amostra_analise<span class="sc">$</span>X1), <span class="at">FUN =</span> mean)</span>
<span id="cb124-4"><a href="#cb124-4" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(medias_grupos)[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="st">"Grupo"</span></span>
<span id="cb124-5"><a href="#cb124-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-6"><a href="#cb124-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Corrigindo erro na impressão das médias dos grupos</span></span>
<span id="cb124-7"><a href="#cb124-7" aria-hidden="true" tabindex="-1"></a>medias_grupos_numericas <span class="ot">&lt;-</span> medias_grupos[, <span class="sc">-</span><span class="dv">1</span>]  <span class="co"># Remove coluna 'Grupo'</span></span>
<span id="cb124-8"><a href="#cb124-8" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(medias_grupos_numericas) <span class="ot">&lt;-</span> medias_grupos<span class="sc">$</span>Grupo</span>
<span id="cb124-9"><a href="#cb124-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-10"><a href="#cb124-10" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Médias dos Grupos nas Variáveis Independentes:"</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Médias dos Grupos nas Variáveis Independentes:"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">round</span>(medias_grupos_numericas, <span class="dv">2</span>))</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                 X6   X7   X8   X9  X10  X11  X12  X13  X14  X15  X16  X17  X18
Menos de 1 ano 6.99 3.56 5.28 4.30 3.83 4.72 4.75 7.42 5.98 5.38 3.53 4.29 3.14
De 1 a 5 anos  7.34 3.85 5.30 5.99 4.27 5.65 5.49 7.75 5.98 4.91 4.70 5.54 4.27
Mais de 5 anos 9.18 3.73 5.82 5.92 4.01 7.00 5.12 5.99 6.32 5.37 4.65 3.94 4.17</code></pre>
</div>
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">=== INTERPRETAÇÃO DAS FUNÇÕES DISCRIMINANTES ===</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
=== INTERPRETAÇÃO DAS FUNÇÕES DISCRIMINANTES ===</code></pre>
</div>
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Função 1: Diferencia principalmente entre Grupo 1 e Grupos 2-3</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Função 1: Diferencia principalmente entre Grupo 1 e Grupos 2-3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Função 2: Diferencia principalmente entre Grupo 3 e Grupos 1-2</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Função 2: Diferencia principalmente entre Grupo 3 e Grupos 1-2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">=== VARIÁVEIS MAIS IMPORTANTES ===</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
=== VARIÁVEIS MAIS IMPORTANTES ===</code></pre>
</div>
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">exists</span>(<span class="st">"indice_potencia_ordenado"</span>)) {</span>
<span id="cb136-2"><a href="#cb136-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Por Índice de Potência:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb136-3"><a href="#cb136-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">names</span>(indice_potencia_ordenado)[<span class="dv">1</span><span class="sc">:</span><span class="fu">min</span>(<span class="dv">5</span>, <span class="fu">length</span>(indice_potencia_ordenado))])</span>
<span id="cb136-4"><a href="#cb136-4" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Por Índice de Potência:
[1] "X6"  "X11" "X17" "X18" "X9" </code></pre>
</div>
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Por Razão F Univariada:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Por Razão F Univariada:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">names</span>(razoes_f_ordenadas)[<span class="dv">1</span><span class="sc">:</span><span class="fu">min</span>(<span class="dv">5</span>, <span class="fu">length</span>(razoes_f_ordenadas))])</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "X18" "X6"  "X9"  "X11" "X16"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb142"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">=== RESUMO FINAL ===</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
=== RESUMO FINAL ===</code></pre>
</div>
<div class="sourceCode cell-code" id="cb144"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Modelo discriminante final: X1 ~ X6 + X18</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Modelo discriminante final: X1 ~ X6 + X18</code></pre>
</div>
<div class="sourceCode cell-code" id="cb146"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Variáveis selecionadas:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Variáveis selecionadas:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb148"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"- X6: Qualidade do produto</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>- X6: Qualidade do produto</code></pre>
</div>
<div class="sourceCode cell-code" id="cb150"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"- X18: Velocidade de entrega</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>- X18: Velocidade de entrega</code></pre>
</div>
<div class="sourceCode cell-code" id="cb152"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">exists</span>(<span class="st">"modelo_stepwise"</span>)) {</span>
<span id="cb152-2"><a href="#cb152-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Variáveis selecionadas pelo procedimento stepwise:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb152-3"><a href="#cb152-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(modelo_stepwise<span class="sc">$</span>formula)</span>
<span id="cb152-4"><a href="#cb152-4" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Variáveis selecionadas pelo procedimento stepwise:
[1] "X1 ~ X6 + X18"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb154"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">=== CONCLUSÕES GERENCIAIS ===</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
=== CONCLUSÕES GERENCIAIS ===</code></pre>
</div>
<div class="sourceCode cell-code" id="cb156"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb156-1"><a href="#cb156-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"1. A qualidade do produto (X6) e velocidade de entrega (X18) são os principais diferenciadores entre os grupos de clientes.</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>1. A qualidade do produto (X6) e velocidade de entrega (X18) são os principais diferenciadores entre os grupos de clientes.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb158"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"2. O modelo consegue discriminar bem entre os três grupos de tempo de relacionamento.</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>2. O modelo consegue discriminar bem entre os três grupos de tempo de relacionamento.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb160"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb160-1"><a href="#cb160-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"3. Clientes de longo prazo valorizam mais qualidade e velocidade de entrega.</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>3. Clientes de longo prazo valorizam mais qualidade e velocidade de entrega.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb162"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"4. Ações de melhoria devem focar nestas duas dimensões para reter clientes.</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>4. Ações de melhoria devem focar nestas duas dimensões para reter clientes.</code></pre>
</div>
</div>
<p><strong>Análise das Médias por Grupo:</strong></p>
<p>Os resultados mostram um padrão claro de evolução das percepções com o tempo de relacionamento, com melhorias progressivas nas percepções de qualidade e velocidade de entrega conforme aumenta o tempo de relacionamento com a empresa.</p>
</section>
</section>
<section id="apêndice-informações-técnicas-do-dataset" class="level3">
<h3 class="anchored" data-anchor-id="apêndice-informações-técnicas-do-dataset">Apêndice: Informações Técnicas do Dataset</h3>
<section id="características-do-dataset-hbat" class="level4">
<h4 class="anchored" data-anchor-id="características-do-dataset-hbat">Características do Dataset HBAT</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb164"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Informações sobre o dataset após limpeza</span></span>
<span id="cb164-2"><a href="#cb164-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"=== CARACTERÍSTICAS DO DATASET FINAL ===</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>=== CARACTERÍSTICAS DO DATASET FINAL ===</code></pre>
</div>
<div class="sourceCode cell-code" id="cb166"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb166-1"><a href="#cb166-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Total de observações:"</span>, <span class="fu">nrow</span>(hbat_clean), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Total de observações: 100 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb168"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb168-1"><a href="#cb168-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Variáveis independentes analisadas:"</span>, <span class="fu">length</span>(variaveis_independentes), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Variáveis independentes analisadas: 13 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb170"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb170-1"><a href="#cb170-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Grupos da variável dependente:"</span>, <span class="fu">nlevels</span>(hbat_clean<span class="sc">$</span>X1), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Grupos da variável dependente: 3 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb172"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb172-1"><a href="#cb172-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Distribuição dos grupos</span></span>
<span id="cb172-2"><a href="#cb172-2" aria-hidden="true" tabindex="-1"></a>dist_grupos <span class="ot">&lt;-</span> <span class="fu">table</span>(hbat_clean<span class="sc">$</span>X1)</span>
<span id="cb172-3"><a href="#cb172-3" aria-hidden="true" tabindex="-1"></a>prop_grupos <span class="ot">&lt;-</span> <span class="fu">prop.table</span>(dist_grupos) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb172-4"><a href="#cb172-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb172-5"><a href="#cb172-5" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Distribuição dos grupos:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Distribuição dos grupos:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb174"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb174-1"><a href="#cb174-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(dist_grupos)) {</span>
<span id="cb174-2"><a href="#cb174-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"- "</span>, <span class="fu">names</span>(dist_grupos)[i], <span class="st">": "</span>, dist_grupos[i], <span class="st">" casos ("</span>, </span>
<span id="cb174-3"><a href="#cb174-3" aria-hidden="true" tabindex="-1"></a>      <span class="fu">round</span>(prop_grupos[i], <span class="dv">1</span>), <span class="st">"%)</span><span class="sc">\n</span><span class="st">"</span>, <span class="at">sep =</span> <span class="st">""</span>)</span>
<span id="cb174-4"><a href="#cb174-4" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>- Menos de 1 ano: 32 casos (32%)
- De 1 a 5 anos: 35 casos (35%)
- Mais de 5 anos: 33 casos (33%)</code></pre>
</div>
</div>
</section>
<section id="qualidade-dos-dados" class="level4">
<h4 class="anchored" data-anchor-id="qualidade-dos-dados">Qualidade dos Dados</h4>
<ul>
<li><strong>Missing values</strong>: Removidos através de listwise deletion</li>
<li><strong>Balanceamento</strong>: Dataset relativamente balanceado entre os grupos</li>
<li><strong>Escala das variáveis</strong>: Todas as variáveis independentes estão na escala de 0-10</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb176"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb176-1"><a href="#cb176-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Informações detalhadas sobre o dataset HBAT</span></span>
<span id="cb176-2"><a href="#cb176-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"=== INFORMAÇÕES DO DATASET HBAT ===</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>=== INFORMAÇÕES DO DATASET HBAT ===</code></pre>
</div>
<div class="sourceCode cell-code" id="cb178"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb178-1"><a href="#cb178-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Total de observações:"</span>, <span class="fu">nrow</span>(hbat_clean), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Total de observações: 100 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb180"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb180-1"><a href="#cb180-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Variáveis independentes:"</span>, <span class="fu">length</span>(variaveis_independentes), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Variáveis independentes: 13 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb182"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb182-1"><a href="#cb182-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Grupos da variável dependente:"</span>, <span class="fu">nlevels</span>(hbat_clean<span class="sc">$</span>X1), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Grupos da variável dependente: 3 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb184"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb184-1"><a href="#cb184-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Descrição das variáveis (baseado nos labels originais) - ATUALIZADO</span></span>
<span id="cb184-2"><a href="#cb184-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">=== DESCRIÇÃO COMPLETA DAS VARIÁVEIS ===</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
=== DESCRIÇÃO COMPLETA DAS VARIÁVEIS ===</code></pre>
</div>
<div class="sourceCode cell-code" id="cb186"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb186-1"><a href="#cb186-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(var <span class="cf">in</span> <span class="fu">names</span>(descricoes_variaveis)) {</span>
<span id="cb186-2"><a href="#cb186-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(var, <span class="st">"-"</span>, descricoes_variaveis[var], <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb186-3"><a href="#cb186-3" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>X1 - Customer Type 
X6 - Product Quality 
X7 - E-Commerce Activities 
X8 - Technical Support 
X9 - Complaint Resolution 
X10 - Advertising 
X11 - Product Line 
X12 - Salesforce Image 
X13 - Competitive Pricing 
X14 - Warranty &amp; Claims 
X15 - New Products 
X16 - Ordering &amp; Billing 
X17 - Price Flexibility 
X18 - Delivery Speed </code></pre>
</div>
<div class="sourceCode cell-code" id="cb188"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb188-1"><a href="#cb188-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Estatísticas descritivas finais</span></span>
<span id="cb188-2"><a href="#cb188-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">=== ESTATÍSTICAS DESCRITIVAS FINAIS ===</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
=== ESTATÍSTICAS DESCRITIVAS FINAIS ===</code></pre>
</div>
<div class="sourceCode cell-code" id="cb190"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb190-1"><a href="#cb190-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">summary</span>(hbat_clean))</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>              X1           X6               X7              X8       
 Menos de 1 ano:32   Min.   : 5.000   Min.   :2.200   Min.   :1.300  
 De 1 a 5 anos :35   1st Qu.: 6.575   1st Qu.:3.275   1st Qu.:4.250  
 Mais de 5 anos:33   Median : 8.000   Median :3.600   Median :5.400  
                     Mean   : 7.810   Mean   :3.672   Mean   :5.365  
                     3rd Qu.: 9.100   3rd Qu.:3.925   3rd Qu.:6.625  
                     Max.   :10.000   Max.   :5.700   Max.   :8.500  
       X9             X10             X11             X12       
 Min.   :2.600   Min.   :1.900   Min.   :2.300   Min.   :2.900  
 1st Qu.:4.600   1st Qu.:3.175   1st Qu.:4.700   1st Qu.:4.500  
 Median :5.450   Median :4.000   Median :5.750   Median :4.900  
 Mean   :5.442   Mean   :4.010   Mean   :5.805   Mean   :5.123  
 3rd Qu.:6.325   3rd Qu.:4.800   3rd Qu.:6.800   3rd Qu.:5.800  
 Max.   :7.800   Max.   :6.500   Max.   :8.400   Max.   :8.200  
      X13             X14             X15            X16             X17      
 Min.   :3.700   Min.   :4.100   Min.   :1.70   Min.   :2.000   Min.   :2.60  
 1st Qu.:5.875   1st Qu.:5.400   1st Qu.:4.10   1st Qu.:3.700   1st Qu.:3.70  
 Median :7.100   Median :6.100   Median :5.00   Median :4.400   Median :4.35  
 Mean   :6.974   Mean   :6.043   Mean   :5.15   Mean   :4.278   Mean   :4.61  
 3rd Qu.:8.400   3rd Qu.:6.600   3rd Qu.:6.30   3rd Qu.:4.800   3rd Qu.:5.60  
 Max.   :9.900   Max.   :8.100   Max.   :9.50   Max.   :6.700   Max.   :7.30  
      X18       
 Min.   :1.600  
 1st Qu.:3.400  
 Median :3.900  
 Mean   :3.886  
 3rd Qu.:4.425  
 Max.   :5.500  </code></pre>
</div>
</div>


</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copiada");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copiada");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>