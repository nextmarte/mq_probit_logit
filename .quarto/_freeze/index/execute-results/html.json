{
  "hash": "f3416189326ab0e16c181d4a8b4d8e52",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"AN√ÅLISE DISCRIMINANTE\"\nlang: pt-BR\nauthor:\n  - name: Marcus Antonio Cardoso Ramalho\n    email: marcus.ramalho@coppead.ufrj.br\n    affiliations:\n      - name: COPPEAD - UNIVERSIDADE FEDERAL DO RIO DE JANEIRO\n        address: Rua Pascoal Lemme, 355\n        city: Rio de Janeiro\n        state: RJ\n        postal-code: 21941-918\n  - name: Claudia Regina da Costa de Souza\n  - name: Ben Hur Correia\ndate: today\n\n---\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(MASS)\nlibrary(klaR)\nlibrary(car)\nlibrary(ggplot2)\nlibrary(dplyr)\nlibrary(corrplot)\nlibrary(caret)\nlibrary(skimr)\nlibrary(MVN)\nlibrary(biotools)\nlibrary(GGally)\nlibrary(nnet)\nlibrary(pROC)\nlibrary(tidyr)\nlibrary(readr)\nlibrary(haven)\nlibrary(gridExtra)\nlibrary(reshape2)\nlibrary(viridis)\nlibrary(plotly)\nlibrary(RColorBrewer)\n```\n:::\n\n\n\n\n## An√°lise Discriminante - Exemplo HBAT\n\n\n### Reprodu√ß√£o do Exemplo de Hair et al. - Dataset HBAT\n\nNesta se√ß√£o, reproduziremos a an√°lise discriminante apresentada no livro Hair et al., utilizando o dataset HBAT para classificar clientes em tr√™s grupos baseados no tempo de relacionamento com a empresa.\n\n\nO **HBAT** √© um dataset educacional fict√≠cio amplamente utilizado no livro cl√°ssico \"Multivariate Data Analysis\" de Joseph Hair et al., representando uma empresa de distribui√ß√£o industrial. O dataset cont√©m **100 observa√ß√µes** de clientes classificados em tr√™s grupos baseados no tempo de relacionamento: **Grupo 1** (menos de 1 ano), **Grupo 2** (1 a 5 anos) e **Grupo 3** (mais de 5 anos). As vari√°veis incluem a **vari√°vel dependente X1** (Customer Type) e **13 vari√°veis independentes** (X6-X18) que medem percep√ß√µes dos clientes sobre diferentes aspectos da empresa, como qualidade do produto (X6), atividades de e-commerce (X7), suporte t√©cnico (X8), resolu√ß√£o de reclama√ß√µes (X9), propaganda (X10), linha de produtos (X11), imagem da for√ßa de vendas (X12), pre√ßos competitivos (X13), garantia e reclama√ß√µes (X14), novos produtos (X15), pedidos e faturamento (X16), flexibilidade de pre√ßos (X17) e velocidade de entrega (X18). Todas as vari√°veis independentes utilizam uma **escala de 0-10**, facilitando compara√ß√µes e interpreta√ß√µes. Este dataset √© ideal para demonstrar t√©cnicas de an√°lise multivariada, especialmente an√°lise discriminante, pois oferece um contexto empresarial realista com dados limpos e estruturados, permitindo focar na aplica√ß√£o das t√©cnicas estat√≠sticas sem se preocupar com problemas complexos de qualidade de dados t√≠picos de datasets reais.\n\n### Est√°gio 1: Objetivos da An√°lise Discriminante\n\nO objetivo √© identificar as caracter√≠sticas perceptuais que distinguem clientes baseados no tempo de relacionamento:\n- **Grupo 1**: Menos de 1 ano\n- **Grupo 2**: De 1 a 5 anos  \n- **Grupo 3**: Mais de 5 anos\n\n#### Carregamento e Inspe√ß√£o dos Dados do arquivo spss\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Carregando os dados HBAT\nhbat <- haven::read_sav(\"data/hbat.sav\")\n\nglimpse(hbat)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nRows: 100\nColumns: 24\n$ id  <dbl> 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19,‚Ä¶\n$ x1  <dbl+lbl> 2, 3, 3, 1, 2, 1, 1, 2, 2, 1, 3, 1, 1, 3, 2, 3, 2, 2, 2, 3, 1,‚Ä¶\n$ x2  <dbl+lbl> 0, 1, 0, 1, 0, 1, 1, 0, 1, 0, 0, 0, 1, 1, 0, 0, 1, 0, 1, 0, 0,‚Ä¶\n$ x3  <dbl+lbl> 1, 0, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 0, 1, 1, 1, 0,‚Ä¶\n$ x4  <dbl+lbl> 1, 0, 1, 1, 0, 1, 1, 1, 1, 1, 0, 1, 0, 0, 1, 0, 1, 1, 1, 1, 1,‚Ä¶\n$ x5  <dbl+lbl> 1, 0, 1, 0, 1, 0, 0, 0, 0, 0, 1, 0, 1, 1, 1, 0, 1, 0, 0, 0, 0,‚Ä¶\n$ x6  <dbl+lbl> 8.5, 8.2, 9.2, 6.4, 9.0, 6.5, 6.9, 6.2, 5.8, 6.4, 8.7, 6.1, 9.‚Ä¶\n$ x7  <dbl+lbl> 3.9, 2.7, 3.4, 3.3, 3.4, 2.8, 3.7, 3.3, 3.6, 4.5, 3.2, 4.9, 5.‚Ä¶\n$ x8  <dbl+lbl> 2.5, 5.1, 5.6, 7.0, 5.2, 3.1, 5.0, 3.9, 5.1, 5.1, 4.6, 6.3, 4.‚Ä¶\n$ x9  <dbl+lbl> 5.9, 7.2, 5.6, 3.7, 4.6, 4.1, 2.6, 4.8, 6.7, 6.1, 4.8, 3.9, 6.‚Ä¶\n$ x10 <dbl+lbl> 4.8, 3.4, 5.4, 4.7, 2.2, 4.0, 2.1, 4.6, 3.7, 4.7, 2.7, 4.4, 5.‚Ä¶\n$ x11 <dbl+lbl> 4.9, 7.9, 7.4, 4.7, 6.0, 4.3, 2.3, 3.6, 5.9, 5.7, 6.8, 3.9, 6.‚Ä¶\n$ x12 <dbl+lbl> 6.0, 3.1, 5.8, 4.5, 4.5, 3.7, 5.4, 5.1, 5.8, 5.7, 4.6, 6.4, 6.‚Ä¶\n$ x13 <dbl+lbl> 6.8, 5.3, 4.5, 8.8, 6.8, 8.5, 8.9, 6.9, 9.3, 8.4, 6.8, 8.2, 7.‚Ä¶\n$ x14 <dbl+lbl> 4.7, 5.5, 6.2, 7.0, 6.1, 5.1, 4.8, 5.4, 5.9, 5.4, 5.8, 5.8, 6.‚Ä¶\n$ x15 <dbl+lbl> 4.3, 4.0, 4.6, 3.6, 4.5, 9.5, 2.5, 4.8, 4.4, 5.3, 7.5, 5.9, 5.‚Ä¶\n$ x16 <dbl+lbl> 5.0, 3.9, 5.4, 4.3, 4.5, 3.6, 2.1, 4.3, 4.4, 4.1, 3.8, 3.0, 5.‚Ä¶\n$ x17 <dbl+lbl> 5.1, 4.3, 4.0, 4.1, 3.5, 4.7, 4.2, 6.3, 6.1, 5.8, 3.7, 4.9, 4.‚Ä¶\n$ x18 <dbl+lbl> 3.7, 4.9, 4.5, 3.0, 3.5, 3.3, 2.0, 3.7, 4.6, 4.4, 4.0, 3.2, 4.‚Ä¶\n$ x19 <dbl+lbl> 8.2, 5.7, 8.9, 4.8, 7.1, 4.7, 5.7, 6.3, 7.0, 5.5, 7.4, 6.0, 8.‚Ä¶\n$ x20 <dbl+lbl> 8.0, 6.5, 8.4, 6.0, 6.6, 6.3, 7.8, 5.8, 7.5, 5.9, 7.0, 6.3, 8.‚Ä¶\n$ x21 <dbl+lbl> 8.4, 7.5, 9.0, 7.2, 9.0, 6.1, 7.2, 7.7, 8.2, 6.7, 8.4, 6.6, 7.‚Ä¶\n$ x22 <dbl+lbl> 65.1, 67.1, 72.1, 40.1, 57.1, 50.1, 41.1, 56.1, 56.1, 59.1, 68‚Ä¶\n$ x23 <dbl+lbl> 1, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 1, 1, 0, 1, 1, 0, 1, 0,‚Ä¶\n```\n\n\n:::\n:::\n\n\n\n\n\n\n\n\n\n\n#### Defini√ß√£o das Vari√°veis do Modelo\n\nCom base na inspe√ß√£o dos dados, identificamos que o dataset HBAT possui exatamente as vari√°veis necess√°rias:\n- **x1**: Vari√°vel dependente (Customer Type: 1=Menos de 1 ano, 2=De 1 a 5 anos, 3=Mais de 5 anos)\n- **x6-x18**: Vari√°veis independentes (percep√ß√µes sobre a HBAT)\n\n\n\n\n\n\n\n\n\n**Configura√ß√£o das Vari√°veis:**\n\n- **Vari√°vel dependente**: x1\n- **Vari√°veis independentes**: x6, x7, x8, x9, x10, x11, x12, x13, x14, x15, x16, x17, x18\n- **Total de vari√°veis independentes**: 13\n\n#### Prepara√ß√£o do Dataset Final\n\n\n\n\n\n\n\n\n\n**Resumo da Prepara√ß√£o dos Dados:**\n\n- **Total de observa√ß√µes**: 100\n- **Vari√°veis independentes**: 13\n- **Grupos identificados**: 3\n\n**Distribui√ß√£o da Vari√°vel Dependente (X1):**\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n\n\n|Grupo          | Frequ√™ncia|\n|:--------------|----------:|\n|Menos de 1 ano |         32|\n|De 1 a 5 anos  |         35|\n|Mais de 5 anos |         33|\n\n\n:::\n:::\n\n\n\n\n**Descri√ß√µes das Vari√°veis:**\n\n| C√≥digo | Descri√ß√£o |\n|--------|-----------|\n| X1 | Customer Type |\n| X6 | Product Quality |\n| X7 | E-Commerce Activities |\n| X8 | Technical Support |\n| X9 | Complaint Resolution |\n| X10 | Advertising |\n| X11 | Product Line |\n| X12 | Salesforce Image |\n| X13 | Competitive Pricing |\n| X14 | Warranty & Claims |\n| X15 | New Products |\n| X16 | Ordering & Billing |\n| X17 | Price Flexibility |\n| X18 | Delivery Speed |\n\n### Est√°gio 2: Delineamento da Pesquisa de An√°lise Discriminante\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Divis√£o em amostras de an√°lise e valida√ß√£o\nset.seed(123)\nn_total <- nrow(hbat_clean)\nindices_analise <- sample(1:n_total, size = floor(0.6 * n_total))\n\namostra_analise <- hbat_clean[indices_analise, ]\namostra_validacao <- hbat_clean[-indices_analise, ]\n\n# Verificar balanceamento dos grupos\nprop_analise <- table(amostra_analise$X1) / nrow(amostra_analise)\nprop_validacao <- table(amostra_validacao$X1) / nrow(amostra_validacao)\n```\n:::\n\n\n\n\nA an√°lise discriminante requer a divis√£o dos dados em amostras de estima√ß√£o e valida√ß√£o para avaliar adequadamente o desempenho do modelo. Utilizamos uma divis√£o de 60% para an√°lise e 40% para valida√ß√£o.\n\n**Caracter√≠sticas das Amostras:**\n\n- **Amostra de an√°lise**: 60 casos\n- **Amostra de valida√ß√£o**: 40 casos\n\n**Distribui√ß√£o dos Grupos por Amostra:**\n\n| Grupo | An√°lise (n) | An√°lise (%) | Valida√ß√£o (n) | Valida√ß√£o (%) |\n|-------|-------------|-------------|---------------|---------------|\n| Menos de 1 ano | 20 | 33.3% | 12 | 30% |\n| De 1 a 5 anos | 22 | 36.7% | 13 | 32.5% |\n| Mais de 5 anos | 18 | 30% | 15 | 37.5% |\n\n### Est√°gio 3: Pressupostos da An√°lise Discriminante\n\n#### 3.1 Normalidade Multivariada\n\nO teste de normalidade multivariada √© fundamental para verificar se os dados seguem uma distribui√ß√£o normal multivariada, pressuposto da an√°lise discriminante linear. Testamos cada um dos tr√™s grupos separadamente usando o teste de Henze-Zirkler.\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(MVN)\n\n# Armazenar resultados dos testes de normalidade\nresultados_normalidade <- list()\n\nfor(grupo in levels(amostra_analise$X1)) {\n  dados_grupo <- amostra_analise[amostra_analise$X1 == grupo, variaveis_independentes]\n  \n  # Usando par√¢metros corretos da fun√ß√£o mvn\n  resultado_mvn <- mvn(dados_grupo, mvn_test = \"hz\", univariate_test = \"SW\")\n  resultados_normalidade[[grupo]] <- resultado_mvn$multivariate_normality\n  \n  # Teste alternativo se o primeiro falhar\n  if(is.null(resultado_mvn$multivariate_normality)) {\n    resultado_mardia <- mvn(dados_grupo, mvn_test = \"mardia\")\n    resultados_normalidade[[grupo]] <- resultado_mardia$multivariate_normality\n  }\n}\n\n# Mostrar resultados\nprint(resultados_normalidade)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n$`Menos de 1 ano`\n           Test Statistic p.value     Method      MVN\n1 Henze-Zirkler      0.99   0.113 asymptotic ‚úì Normal\n\n$`De 1 a 5 anos`\n           Test Statistic p.value     Method      MVN\n1 Henze-Zirkler     0.993   0.063 asymptotic ‚úì Normal\n\n$`Mais de 5 anos`\n           Test Statistic p.value     Method          MVN\n1 Henze-Zirkler     0.994   0.035 asymptotic ‚úó Not normal\n```\n\n\n:::\n:::\n\n\n\n\n**Resumo dos Testes de Normalidade:**\n\nCom base nos resultados obtidos, 2 dos 3 grupos atendem ao pressuposto de normalidade multivariada ao n√≠vel de signific√¢ncia de 5%. O grupo que apresentou desvio (p = 0.035) est√° pr√≥ximo do limite aceit√°vel, e a an√°lise discriminante pode prosseguir com confian√ßa.\n\n#### 3.2 Homogeneidade das Matrizes de Covari√¢ncia\n\nO teste M de Box verifica se as matrizes de covari√¢ncia dos grupos s√£o homog√™neas, outro pressuposto importante da an√°lise discriminante. Este teste avalia se as 13 vari√°veis independentes apresentam estruturas de covari√¢ncia similares entre os grupos.\n\n**Interpreta√ß√£o dos Resultados do Teste M de Box:**\n\n**Conclus√£o**: Com p-valor = 0.01122 < 0.05, rejeitamos a hip√≥tese nula de homogeneidade das matrizes de covari√¢ncia. Isso indica que **h√° diferen√ßas significativas** entre as estruturas de covari√¢ncia dos grupos.\n\n**Implica√ß√µes Pr√°ticas:**\n- A viola√ß√£o da homogeneidade das covari√¢ncias sugere que a **An√°lise Discriminante Quadr√°tica (QDA)** poderia ser mais apropriada que a Linear (LDA)\n- No entanto, a LDA √© robusta a viola√ß√µes moderadas deste pressuposto, especialmente quando os tamanhos das amostras s√£o similares\n- Como os grupos est√£o relativamente balanceados (conforme mostrado acima), podemos prosseguir com cautela usando LDA\n- Os resultados devem ser interpretados considerando esta limita√ß√£o\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(biotools)\n\ndados_teste <- amostra_analise[, variaveis_independentes]\ngrupos_teste <- amostra_analise$X1\n\n# Teste M de Box com tratamento de erro\ntryCatch({\n  teste_box <- boxM(dados_teste, grupos_teste)\n  print(teste_box)\n}, error = function(e) {\n  message(\"Teste M de Box n√£o p√¥de ser executado: \", e$message)\n  \n  for(grupo in levels(amostra_analise$X1)) {\n    dados_grupo <- amostra_analise[amostra_analise$X1 == grupo, variaveis_independentes]\n    cov_grupo <- cov(dados_grupo)\n    message(\"\\nMatriz de Covari√¢ncia - Grupo: \", grupo)\n    print(round(cov_grupo, 3))\n  }\n})\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tBox's M-test for Homogeneity of Covariance Matrices\n\ndata:  dados_teste\nChi-Sq (approx.) = 228.34, df = 182, p-value = 0.01122\n```\n\n\n:::\n:::\n\n\n\n\n#### 3.3 Multicolinearidade\n\nA presen√ßa de multicolinearidade pode afetar a estabilidade dos resultados da an√°lise discriminante. O determinante da matriz de correla√ß√£o e os valores VIF nos ajudam a identificar poss√≠veis problemas de multicolinearidade entre as vari√°veis.\n\n**Interpreta√ß√£o dos Valores VIF:**\n\nOs Fatores de Infla√ß√£o da Vari√¢ncia (VIF) revelam problemas significativos de multicolinearidade:\n\n- **VIF < 5**: Multicolinearidade baixa (aceit√°vel)\n  - X6 (1.90), X7 (4.56), X8 (4.71), X10 (1.65), X13 (1.76), X14 (4.16), X15 (1.23), X16 (4.33)\n\n- **VIF entre 5-10**: Multicolinearidade moderada (preocupante)\n  - X9 (5.33), X12 (5.78)\n\n- **VIF > 10**: Multicolinearidade alta (problem√°tica)\n  - **X11 (Product Line)**: VIF = 52.77\n  - **X17 (Price Flexibility)**: VIF = 41.49  \n  - **X18 (Delivery Speed)**: VIF = 56.34\n\n**Implica√ß√µes:**\n- As vari√°veis X11, X17 e X18 apresentam alta correla√ß√£o com outras vari√°veis independentes\n- Isso pode causar instabilidade nos coeficientes discriminantes\n- O determinante da matriz de correla√ß√£o confirma a presen√ßa de multicolinearidade\n- Apesar disso, seguimos o exemplo de Hair et al. usando X6 e X18, reconhecendo esta limita√ß√£o\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Matriz de correla√ß√£o com visualiza√ß√£o aprimorada\nmatriz_cor <- cor(amostra_analise[, variaveis_independentes])\n\n# Gr√°fico de correla√ß√£o personalizado\ncorrplot::corrplot(matriz_cor, method = \"color\", type = \"upper\", \n                   order = \"hclust\", tl.cex = 0.8, tl.col = \"black\",\n                   col = RColorBrewer::brewer.pal(n = 8, name = \"RdYlBu\"),\n                   title = \"Matriz de Correla√ß√£o das Vari√°veis Independentes\",\n                   mar = c(0,0,2,0))\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-13-1.png){width=672}\n:::\n\n```{.r .cell-code}\n# Determinante da matriz de correla√ß√£o\ndet_cor <- det(matriz_cor)\n\n# VIF para identificar multicolinearidade\nmodelo_temp <- lm(as.numeric(X1) ~ ., data = amostra_analise[, c(\"X1\", variaveis_independentes)])\nvif_valores <- car::vif(modelo_temp)\n```\n:::\n\n\n\n\n**An√°lise de Multicolinearidade:**\n\n- **Determinante da matriz de correla√ß√£o**: 8\\times 10^{-6}\n\n**Classifica√ß√£o dos Valores VIF:**\n\n| Categoria | Crit√©rio | Vari√°veis |\n|-----------|----------|-----------|\n| **Baixa** (< 5) | Aceit√°vel | X6, X7, X8, X10, X13, X14, X15, X16 |\n| **Moderada** (5-10) | Preocupante | X9, X12 |\n| **Alta** (‚â• 10) | Problem√°tica | X11, X17, X18 |\n\n**Vari√°veis com Multicolinearidade Severa:**\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n\n\n|Vari√°vel |Descri√ß√£o         |   VIF|\n|:--------|:-----------------|-----:|\n|X11      |Product Line      | 52.77|\n|X17      |Price Flexibility | 41.49|\n|X18      |Delivery Speed    | 56.34|\n\n\n:::\n:::\n\n\n\n\n### Est√°gio 4: Estima√ß√£o do Modelo Discriminante e Avalia√ß√£o do Ajuste Geral\n\n#### 4.1 M√©todo Stepwise\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(klaR)\nlibrary(MASS)\n\n# Implementando stepwise manual baseado em crit√©rios estat√≠sticos\nf_univariados <- numeric(length(variaveis_independentes))\np_univariados <- numeric(length(variaveis_independentes))\nnames(f_univariados) <- variaveis_independentes\nnames(p_univariados) <- variaveis_independentes\n\nfor(i in seq_along(variaveis_independentes)) {\n  var <- variaveis_independentes[i]\n  formula_temp <- as.formula(paste(var, \"~ X1\"))\n  \n  tryCatch({\n    anova_temp <- aov(formula_temp, data = amostra_analise)\n    anova_summary <- summary(anova_temp)\n    f_univariados[i] <- anova_summary[[1]][\"X1\", \"F value\"]\n    p_univariados[i] <- anova_summary[[1]][\"X1\", \"Pr(>F)\"]\n  }, error = function(e) {\n    f_univariados[i] <- 0\n    p_univariados[i] <- 1\n  })\n}\n\n# Ordenando vari√°veis por poder discriminante\nordem_importancia <- order(f_univariados, decreasing = TRUE)\nvars_ordenadas <- variaveis_independentes[ordem_importancia]\nvars_significativas <- names(p_univariados[p_univariados < 0.05])\n\n# Testando modelo Hair et al.: X6 + X18\nformula_hair <- as.formula(\"cbind(X6, X18) ~ X1\")\nmanova_hair <- manova(formula_hair, data = amostra_analise)\nresultado_hair <- summary(manova_hair, test = \"Wilks\")\n\nmodelo_stepwise <- list(\n  formula = \"X1 ~ X6 + X18\",\n  selected_vars = c(\"X6\", \"X18\"),\n  wilks_lambda = resultado_hair$stats[\"X1\", \"Wilks\"],\n  f_statistic = resultado_hair$stats[\"X1\", \"approx F\"],\n  p_value = resultado_hair$stats[\"X1\", \"Pr(>F)\"]\n)\n```\n:::\n\n\n\n\n**An√°lise Univariada de Vari√°veis:**\n\n**Ranking por Poder Discriminante (Top 5):**\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n\n\n| Posi√ß√£o|Vari√°vel |Descri√ß√£o            | F.value| p.valor|Signific√¢ncia |\n|-------:|:--------|:--------------------|-------:|-------:|:-------------|\n|       1|X18      |Delivery Speed       |  24.425|       0|***           |\n|       2|X6       |Product Quality      |  22.885|       0|***           |\n|       3|X9       |Complaint Resolution |  22.739|       0|***           |\n|       4|X11      |Product Line         |  20.721|       0|***           |\n|       5|X16      |Ordering & Billing   |  17.664|       0|***           |\n\n\n:::\n:::\n\n\n\n\n**Modelo Stepwise Final:**\n\n- **F√≥rmula selecionada**: X1 ~ X6 + X18\n- **Vari√°veis inclu√≠das**: X6 + X18\n- **Lambda de Wilks**: 0.2901\n- **Estat√≠stica F**: 23.99\n- **p-valor**: 2.388e-14\n- **Total de vari√°veis significativas**: 7 de 13\n\n**Justificativa da Sele√ß√£o:**\nEmbora X18 seja a vari√°vel mais discriminante univariadamente, seguimos o exemplo de Hair et al. usando X6 (Product Quality) + X18 (Delivery Speed) por raz√µes te√≥ricas e interpretabilidade gerencial.\n\n#### 4.2 An√°lise Discriminante Linear\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Modelo final conforme Hair et al. (X6 e X18)\nmodelo_final <- lda(X1 ~ X6 + X18, data = amostra_analise)\n\n# Autovalores e vari√¢ncia explicada\neigenvalues <- modelo_final$svd^2\nvariancia_explicada <- eigenvalues / sum(eigenvalues) * 100\n```\n:::\n\n\n\n\nO modelo discriminante final utiliza as vari√°veis X6 (Product Quality) e X18 (Delivery Speed), seguindo o exemplo de Hair et al.\n\n**Caracter√≠sticas do Modelo:**\n\n- **N√∫mero de fun√ß√µes discriminantes**: 2\n- **Vari√¢ncia explicada pela Fun√ß√£o 1**: 83.5%\n- **Vari√¢ncia explicada pela Fun√ß√£o 2**: 16.5%\n- **Vari√¢ncia total explicada**: 100%\n\n**Autovalores:**\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n\n\n|Fun√ß√£o | Autovalor| Vari√¢ncia.Explicada....|\n|:------|---------:|-----------------------:|\n|LD 1   |   45.9897|                    83.5|\n|LD 2   |    9.0940|                    16.5|\n\n\n:::\n:::\n\n\n\n\n#### 4.3 Signific√¢ncia Estat√≠stica\n\nO teste de signific√¢ncia avalia se o modelo discriminante √© estatisticamente significativo.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmodelo_manova <- manova(cbind(X6, X18) ~ X1, data = amostra_analise)\nsummary(modelo_manova, test = \"Wilks\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n          Df   Wilks approx F num Df den Df    Pr(>F)    \nX1         2 0.29005    23.99      4    112 2.388e-14 ***\nResiduals 57                                             \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n\n```{.r .cell-code}\nsummary.aov(modelo_manova)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n Response X6 :\n            Df Sum Sq Mean Sq F value    Pr(>F)    \nX1           2 51.890 25.9451  22.885 5.062e-08 ***\nResiduals   57 64.622  1.1337                      \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n Response X18 :\n            Df Sum Sq Mean Sq F value    Pr(>F)    \nX1           2 15.643  7.8216  24.425 2.182e-08 ***\nResiduals   57 18.253  0.3202                      \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n:::\n\n\n\n\n**Interpreta√ß√£o dos Resultados de Signific√¢ncia:**\n\n**Teste MANOVA (Multivariado):**\n- **Lambda de Wilks = 0.29005**: Valor baixo indica boa discrimina√ß√£o entre grupos\n- **F aproximado = 23.99**: Estat√≠stica F alta sugere diferen√ßas significativas\n- **p-valor = 2.388e-14**: Altamente significativo (p < 0.001)\n- **Conclus√£o**: O modelo discriminante √© estatisticamente significativo\n\n**An√°lises Univariadas por Vari√°vel:**\n\n**X6 (Product Quality):**\n- **F = 22.885**: Alta capacidade discriminante individual\n- **p-valor = 5.062e-08**: Altamente significativo\n- **Interpreta√ß√£o**: A qualidade do produto varia significativamente entre os grupos de tempo de relacionamento\n\n**X18 (Delivery Speed):**\n- **F = 24.425**: Maior capacidade discriminante individual entre as duas vari√°veis\n- **p-valor = 2.182e-08**: Altamente significativo  \n- **Interpreta√ß√£o**: A percep√ß√£o da velocidade de entrega √© o melhor discriminador individual entre os grupos\n\n**Implica√ß√µes Gerenciais:**\n1. Ambas as vari√°veis contribuem significativamente para distinguir os grupos\n2. Velocidade de entrega (X18) √© ligeiramente mais discriminante que qualidade (X6)\n3. O modelo como um todo tem poder discriminante muito forte\n4. As percep√ß√µes evoluem significativamente com o tempo de relacionamento\n\n#### 4.4 Centr√≥ides dos Grupos\n\nOs centr√≥ides representam o \"centro\" de cada grupo no espa√ßo discriminante.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncentroides <- aggregate(amostra_analise[, c(\"X6\", \"X18\")], \n                       by = list(amostra_analise$X1), FUN = mean)\nnames(centroides)[1] <- \"Grupo\"\n\npredict_centroides <- predict(modelo_final, centroides[, c(\"X6\", \"X18\")])\ncentroides_discriminantes <- predict_centroides$x\nrownames(centroides_discriminantes) <- centroides$Grupo\nprint(\"\\nCentr√≥ides no Espa√ßo Discriminante:\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"\\nCentr√≥ides no Espa√ßo Discriminante:\"\n```\n\n\n:::\n\n```{.r .cell-code}\nprint(centroides_discriminantes)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                      LD1        LD2\nMenos de 1 ano -1.6066271  0.3095983\nDe 1 a 5 anos   0.2579251 -0.7144520\nMais de 5 anos  1.4698995  0.5292210\n```\n\n\n:::\n:::\n\n\n\n\n**An√°lise dos Centr√≥ides no Espa√ßo Discriminante:**\n\n**Posicionamento dos Grupos:**\n\n| Grupo | LD1 | LD2 | Interpreta√ß√£o |\n|-------|-----|-----|---------------|\n| Menos de 1 ano | -1.61 | 0.31 | Percep√ß√µes mais baixas, posicionamento √∫nico |\n| De 1 a 5 anos | 0.26 | -0.71 | Percep√ß√µes intermedi√°rias, diferencia√ß√£o moderada |\n| Mais de 5 anos | 1.47 | 0.53 | Percep√ß√µes mais elevadas, alta satisfa√ß√£o |\n\n**Padr√µes Identificados:**\n\n1. **Evolu√ß√£o Linear em LD1**: Os valores de LD1 crescem progressivamente (-1.61 ‚Üí 0.26 ‚Üí 1.47), indicando melhoria das percep√ß√µes com o tempo de relacionamento\n\n2. **Separa√ß√£o Clara**: A dist√¢ncia entre centr√≥ides confirma que os grupos s√£o bem diferenciados no espa√ßo discriminante\n\n3. **Trajet√≥ria de Relacionamento**: \n   - **Clientes novos** (< 1 ano): Expectativas em forma√ß√£o, percep√ß√µes iniciais mais cr√≠ticas\n   - **Clientes intermedi√°rios** (1-5 anos): Per√≠odo de consolida√ß√£o das percep√ß√µes\n   - **Clientes estabelecidos** (> 5 anos): Relacionamento maduro, percep√ß√µes mais positivas\n\n**Interpreta√ß√£o das Fun√ß√µes Discriminantes:**\n\n- **LD1**: Representa principalmente a **evolu√ß√£o temporal** das percep√ß√µes (experi√™ncia acumulada)\n- **LD2**: Representa **diferen√ßas qualitativas** espec√≠ficas entre os grupos intermedi√°rios e extremos\n\n**Implica√ß√µes Estrat√©gicas:**\n- Foco na **reten√ß√£o inicial**: Clientes novos precisam de aten√ß√£o especial\n- **Gest√£o da jornada**: Processo gradual de melhoria das percep√ß√µes\n- **Fideliza√ß√£o**: Clientes de longo prazo s√£o verdadeiros advogados da marca\n\n### Est√°gio 5: Interpreta√ß√£o dos Resultados\n\n#### 5.1 Cargas Discriminantes (Matriz Estrutural)\n\nAs cargas discriminantes mostram a correla√ß√£o entre cada vari√°vel independente e as fun√ß√µes discriminantes.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Calculando cargas discriminantes (correla√ß√µes entre vari√°veis e fun√ß√µes)\n# Escores discriminantes para todas as observa√ß√µes\nescores_discriminantes <- predict(modelo_final, amostra_analise)$x\n\n# Matriz de cargas (correla√ß√µes)\nvariaveis_completas <- amostra_analise[, variaveis_independentes]\ncargas_discriminantes <- cor(variaveis_completas, escores_discriminantes)\n\nprint(\"Matriz de Cargas Discriminantes (n√£o-rotacionadas):\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"Matriz de Cargas Discriminantes (n√£o-rotacionadas):\"\n```\n\n\n:::\n\n```{.r .cell-code}\nprint(round(cargas_discriminantes, 3))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n       LD1    LD2\nX6   0.736  0.677\nX7   0.235 -0.313\nX8   0.103  0.182\nX9   0.728 -0.467\nX10  0.177 -0.237\nX11  0.773 -0.049\nX12  0.192 -0.418\nX13 -0.251 -0.286\nX14  0.163  0.058\nX15  0.041 -0.084\nX16  0.699 -0.416\nX17  0.012 -0.699\nX18  0.765 -0.644\n```\n\n\n:::\n\n```{.r .cell-code}\n# Identificando vari√°veis descritivas (|carga| >= 0.40)\ncargas_importantes <- abs(cargas_discriminantes) >= 0.40\nprint(\"\\nVari√°veis Descritivas por Fun√ß√£o (|carga| >= 0.40):\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"\\nVari√°veis Descritivas por Fun√ß√£o (|carga| >= 0.40):\"\n```\n\n\n:::\n\n```{.r .cell-code}\nfor(i in 1:ncol(cargas_discriminantes)) {\n  cat(\"Fun√ß√£o\", i, \":\", names(which(cargas_importantes[, i])), \"\\n\")\n}\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nFun√ß√£o 1 : X6 X9 X11 X16 X18 \nFun√ß√£o 2 : X6 X9 X12 X16 X17 X18 \n```\n\n\n:::\n:::\n\n\n\n\n**Interpreta√ß√£o da Matriz de Cargas Discriminantes:**\n\n**An√°lise da Fun√ß√£o Discriminante 1 (LD1):**\n\n**Vari√°veis com Cargas Altas (|carga| ‚â• 0.40):**\n- **X11 (Product Line)**: 0.773 - Maior contribui√ß√£o para LD1\n- **X18 (Delivery Speed)**: 0.765 - Forte correla√ß√£o positiva\n- **X6 (Product Quality)**: 0.736 - Alta correla√ß√£o positiva  \n- **X9 (Complaint Resolution)**: 0.728 - Contribui√ß√£o significativa\n- **X16 (Ordering & Billing)**: 0.699 - Forte correla√ß√£o\n\n**Interpreta√ß√£o de LD1**: Representa a **dimens√£o geral de satisfa√ß√£o** com aspectos operacionais e de qualidade da HBAT. Valores altos indicam percep√ß√µes positivas em qualidade, entrega, linha de produtos e resolu√ß√£o de problemas.\n\n**An√°lise da Fun√ß√£o Discriminante 2 (LD2):**\n\n**Vari√°veis com Cargas Altas (|carga| ‚â• 0.40):**\n- **X17 (Price Flexibility)**: -0.699 - Maior magnitude (negativa)\n- **X6 (Product Quality)**: 0.677 - Correla√ß√£o positiva forte\n- **X18 (Delivery Speed)**: -0.644 - Correla√ß√£o negativa significativa\n- **X9 (Complaint Resolution)**: -0.467 - Contribui√ß√£o moderada negativa\n- **X16 (Ordering & Billing)**: -0.416 - Correla√ß√£o negativa\n- **X12 (Salesforce Image)**: -0.418 - Contribui√ß√£o moderada negativa\n\n**Interpreta√ß√£o de LD2**: Representa um **contraste entre qualidade percebida** versus **flexibilidade operacional**. Separa grupos com diferentes prioridades: qualidade versus agilidade/flexibilidade.\n\n#### 5.2 Rota√ß√£o VARIMAX\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Aplicando rota√ß√£o VARIMAX √†s cargas discriminantes\nlibrary(stats)\n\nif(ncol(cargas_discriminantes) > 1) {\n  rotacao_varimax <- varimax(cargas_discriminantes)\n  cargas_rotacionadas <- rotacao_varimax$loadings[]\n  \n  print(\"Matriz de Cargas Discriminantes (rotacionadas - VARIMAX):\")\n  print(round(cargas_rotacionadas, 3))\n  \n  # Vari√°veis descritivas ap√≥s rota√ß√£o\n  cargas_rot_importantes <- abs(cargas_rotacionadas) >= 0.40\n  print(\"\\nVari√°veis Descritivas por Fun√ß√£o Rotacionada (|carga| >= 0.40):\")\n  for(i in 1:ncol(cargas_rotacionadas)) {\n    cat(\"Fun√ß√£o\", i, \":\", names(which(cargas_rot_importantes[, i])), \"\\n\")\n  }\n} else {\n  cargas_rotacionadas <- cargas_discriminantes\n  print(\"Apenas uma fun√ß√£o discriminante - rota√ß√£o n√£o aplic√°vel\")\n}\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"Matriz de Cargas Discriminantes (rotacionadas - VARIMAX):\"\n       LD1    LD2\nX6   1.000  0.003\nX7  -0.038 -0.390\nX8   0.199  0.064\nX9   0.222 -0.836\nX10 -0.029 -0.294\nX11  0.538 -0.558\nX12 -0.140 -0.438\nX13 -0.378 -0.042\nX14  0.160 -0.067\nX15 -0.027 -0.090\nX16  0.235 -0.779\nX17 -0.462 -0.524\nX18  0.129 -0.992\n[1] \"\\nVari√°veis Descritivas por Fun√ß√£o Rotacionada (|carga| >= 0.40):\"\nFun√ß√£o 1 : X6 X11 X17 \nFun√ß√£o 2 : X9 X11 X12 X16 X17 X18 \n```\n\n\n:::\n:::\n\n\n\n\n**Interpreta√ß√£o das Cargas Rotacionadas (VARIMAX):**\n\nA rota√ß√£o VARIMAX simplifica a estrutura, criando fatores mais interpret√°veis:\n\n**Fun√ß√£o 1 Rotacionada:**\n- **X6 (Product Quality)**: 1.000 - Carga perfeitamente concentrada\n- **X11 (Product Line)**: 0.538 - Contribui√ß√£o moderada\n- **X17 (Price Flexibility)**: -0.462 - Contribui√ß√£o negativa moderada\n\n**Interpreta√ß√£o**: LD1 rotacionada representa essencialmente a **\"Dimens√£o de Qualidade\"**, contrastando qualidade percebida com flexibilidade de pre√ßos.\n\n**Fun√ß√£o 2 Rotacionada:**\n- **X18 (Delivery Speed)**: -0.992 - Concentra√ß√£o quase perfeita (negativa)\n- **X9 (Complaint Resolution)**: -0.836 - Alta correla√ß√£o negativa  \n- **X16 (Ordering & Billing)**: -0.779 - Correla√ß√£o negativa forte\n- **X11 (Product Line)**: -0.558 - Contribui√ß√£o moderada\n- **X17 (Price Flexibility)**: -0.524 - Contribui√ß√£o moderada\n\n**Interpreta√ß√£o**: LD2 rotacionada representa a **\"Dimens√£o Operacional\"**, focando em velocidade, efici√™ncia e aspectos transacionais.\n\n**Vantagem da Rota√ß√£o:**\n- **Simplifica interpreta√ß√£o**: Cada fun√ß√£o tem foco mais claro\n- **Reduz ambiguidade**: Menos vari√°veis com cargas altas em m√∫ltiplas fun√ß√µes\n- **Facilita comunica√ß√£o gerencial**: Dimens√µes mais intuitivas\n\n#### 5.3 √çndice de Pot√™ncia\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Calculando √≠ndice de pot√™ncia conforme Hair et al.\nif(ncol(cargas_discriminantes) > 1) {\n  # Autovalores relativos\n  autovalores_relativos <- eigenvalues / sum(eigenvalues)\n  \n  # √çndice de pot√™ncia para cada vari√°vel\n  indice_potencia <- numeric(nrow(cargas_rotacionadas))\n  names(indice_potencia) <- rownames(cargas_rotacionadas)\n  \n  for(i in 1:nrow(cargas_rotacionadas)) {\n    potencia_total <- 0\n    for(j in 1:ncol(cargas_rotacionadas)) {\n      potencia_total <- potencia_total + (cargas_rotacionadas[i, j]^2 * autovalores_relativos[j])\n    }\n    indice_potencia[i] <- potencia_total\n  }\n  \n  # Ordenando por √≠ndice de pot√™ncia\n  indice_potencia_ordenado <- sort(indice_potencia, decreasing = TRUE)\n  \n  print(\"√çndice de Pot√™ncia das Vari√°veis:\")\n  print(round(indice_potencia_ordenado, 3))\n}\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"√çndice de Pot√™ncia das Vari√°veis:\"\n   X6   X11   X17   X18    X9   X16   X13   X12    X8    X7   X14   X10   X15 \n0.835 0.293 0.224 0.176 0.157 0.146 0.120 0.048 0.034 0.026 0.022 0.015 0.002 \n```\n\n\n:::\n:::\n\n\n\n\n**Interpreta√ß√£o do √çndice de Pot√™ncia:**\n\nO √≠ndice de pot√™ncia combina a contribui√ß√£o de cada vari√°vel em todas as fun√ß√µes, ponderada pela import√¢ncia relativa de cada fun√ß√£o:\n\n**Ranking por Poder Discriminante Total:**\n\n| Posi√ß√£o | Vari√°vel | Descri√ß√£o | √çndice | Interpreta√ß√£o |\n|---------|----------|-----------|--------|---------------|\n| 1¬∫ | X6 | Product Quality | 0.835 | **Discriminador principal** - fundamental para diferencia√ß√£o |\n| 2¬∫ | X11 | Product Line | 0.293 | **Segundo mais importante** - variedade de produtos relevante |\n| 3¬∫ | X17 | Price Flexibility | 0.224 | **Terceiro lugar** - flexibilidade de pre√ßos diferencia grupos |\n| 4¬∫ | X18 | Delivery Speed | 0.176 | **Quarto lugar** - velocidade importante apesar de estar no modelo |\n| 5¬∫ | X9 | Complaint Resolution | 0.157 | **Moderadamente importante** - resolu√ß√£o de problemas diferencia |\n\n**Insights Principais:**\n\n1. **X6 (Product Quality)** √© o discriminador dominante, respons√°vel por mais de 83% do poder discriminante total\n2. **X18 (Delivery Speed)**, apesar de estar no modelo final, ocupa apenas a 4¬™ posi√ß√£o no √≠ndice de pot√™ncia\n3. **X11 (Product Line)** aparece como segundo mais importante, sugerindo que variedade de produtos √© crucial\n4. A **concentra√ß√£o de poder** nas primeiras vari√°veis indica que poucas dimens√µes explicam a maior parte da discrimina√ß√£o\n\n**Implica√ß√µes Gerenciais:**\n- **Prioridade m√°xima**: Investir em qualidade do produto\n- **Segunda prioridade**: Expandir e melhorar linha de produtos\n- **Terceira prioridade**: Desenvolver flexibilidade de pre√ßos\n- **Monitoramento**: Acompanhar velocidade de entrega e resolu√ß√£o de reclama√ß√µes\n\n#### 5.4 Raz√µes F Univariadas\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Calculando raz√µes F univariadas para cada vari√°vel\nrazoes_f <- numeric(length(variaveis_independentes))\nnames(razoes_f) <- variaveis_independentes\n\nfor(var in variaveis_independentes) {\n  formula_temp <- as.formula(paste(var, \"~ X1\"))\n  anova_temp <- aov(formula_temp, data = amostra_analise)\n  razoes_f[var] <- summary(anova_temp)[[1]][\"X1\", \"F value\"]\n}\n\n# Ordenando por valor F\nrazoes_f_ordenadas <- sort(razoes_f, decreasing = TRUE)\n\nprint(\"Raz√µes F Univariadas:\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"Raz√µes F Univariadas:\"\n```\n\n\n:::\n\n```{.r .cell-code}\nprint(round(razoes_f_ordenadas, 3))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   X18     X6     X9    X11    X16    X17    X13    X12    X14     X7    X10 \n24.425 22.885 22.739 20.721 17.664 13.892  9.075  2.873  0.919  0.799  0.753 \n    X8    X15 \n 0.715  0.599 \n```\n\n\n:::\n\n```{.r .cell-code}\n# Teste de signific√¢ncia (Œ± = 0.05)\np_valores <- numeric(length(variaveis_independentes))\nnames(p_valores) <- variaveis_independentes\n\nfor(var in variaveis_independentes) {\n  formula_temp <- as.formula(paste(var, \"~ X1\"))\n  anova_temp <- aov(formula_temp, data = amostra_analise)\n  p_valores[var] <- summary(anova_temp)[[1]][\"X1\", \"Pr(>F)\"]\n}\n\nprint(\"\\nVari√°veis Significativas (p < 0.05):\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"\\nVari√°veis Significativas (p < 0.05):\"\n```\n\n\n:::\n\n```{.r .cell-code}\nprint(names(p_valores[p_valores < 0.05]))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"X6\"  \"X9\"  \"X11\" \"X13\" \"X16\" \"X17\" \"X18\"\n```\n\n\n:::\n:::\n\n\n\n\n**Interpreta√ß√£o das Raz√µes F Univariadas:**\n\n**Ranking de Poder Discriminante Individual:**\n\n| Posi√ß√£o | Vari√°vel | F-value | p-valor | Status | Interpreta√ß√£o |\n|---------|----------|---------|---------|--------|---------------|\n| 1¬∫ | X18 (Delivery Speed) | 24.425 | < 0.001 | *** | **Melhor discriminador individual** |\n| 2¬∫ | X6 (Product Quality) | 22.885 | < 0.001 | *** | **Segundo melhor discriminador** |\n| 3¬∫ | X9 (Complaint Resolution) | 22.739 | < 0.001 | *** | **Terceiro em poder discriminante** |\n| 4¬∫ | X11 (Product Line) | 20.721 | < 0.001 | *** | **Quarto colocado significativo** |\n| 5¬∫ | X16 (Ordering & Billing) | 17.664 | < 0.001 | *** | **Quinto em import√¢ncia** |\n\n**Vari√°veis Significativas (p < 0.05):** X6, X9, X11, X13, X16, X17, X18 (7 de 13 vari√°veis)\n\n**Compara√ß√£o: Poder Individual vs. Poder Combinado:**\n\n1. **X18 (Delivery Speed)**: \n   - Individual: 1¬∫ lugar (F = 24.425)\n   - Combinado: 4¬∫ lugar (√çndice = 0.176)\n   - **Interpreta√ß√£o**: Excelente discriminador individual, mas com alguma redund√¢ncia no modelo conjunto\n\n2. **X6 (Product Quality)**:\n   - Individual: 2¬∫ lugar (F = 22.885)  \n   - Combinado: 1¬∫ lugar (√çndice = 0.835)\n   - **Interpreta√ß√£o**: Forte individual e dominante no modelo conjunto\n\n**Insights sobre Sele√ß√£o de Vari√°veis:**\n\n- **Crit√©rio Hair et al.**: Usar X6 + X18 √© justificado pelo alto poder discriminante individual de ambas\n- **Potencial de otimiza√ß√£o**: X9 (Complaint Resolution) tem poder individual muito alto e poderia ser considerada\n- **Redund√¢ncia**: V√°rias vari√°veis significativas sugerem multicolinearidade (confirmada pelos VIF altos)\n\n**Recomenda√ß√µes Gerenciais:**\n1. **Foco prim√°rio**: Delivery Speed e Product Quality (vari√°veis do modelo)\n2. **Foco secund√°rio**: Complaint Resolution (alto poder discriminante individual)  \n3. **Monitoramento**: Product Line e Ordering & Billing (significativas e importantes)\n4. **Revis√£o**: Considerar modelo expandido incluindo X9 para melhor discrimina√ß√£o\n\n#### 5.5 Gr√°fico de Vetores de Atribui√ß√£o no Espa√ßo Discriminante\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Gr√°fico dos valores F univariados com descri√ß√µes\nf_df <- data.frame(\n  Variavel = names(f_univariados),\n  F_Value = f_univariados,\n  P_Value = p_univariados,\n  Significativo = p_univariados < 0.05\n) %>%\n  dplyr::mutate(Variavel_Desc = sapply(Variavel, obter_descricao))\n\np_f_values <- ggplot2::ggplot(f_df, ggplot2::aes(x = reorder(Variavel_Desc, F_Value), \n                                                 y = F_Value, fill = Significativo)) +\n  ggplot2::geom_col(alpha = 0.8) +\n  ggplot2::geom_text(ggplot2::aes(label = round(F_Value, 1)), hjust = -0.1, size = 3) +\n  ggplot2::coord_flip() +\n  ggplot2::scale_fill_manual(values = c(\"TRUE\" = \"steelblue\", \"FALSE\" = \"gray70\"),\n                            labels = c(\"FALSE\" = \"N√£o Significativo\", \"TRUE\" = \"Significativo\")) +\n  ggplot2::labs(title = \"Valores F Univariados para Sele√ß√£o de Vari√°veis\",\n                subtitle = \"Poder discriminante individual de cada vari√°vel\",\n                x = \"Vari√°veis\", y = \"Estat√≠stica F\",\n                fill = \"Signific√¢ncia\\n(p < 0.05)\") +\n  ggplot2::theme_minimal() +\n  ggplot2::theme(plot.title = ggplot2::element_text(size = 14, face = \"bold\"),\n                 axis.text.y = ggplot2::element_text(size = 9))\n\nprint(p_f_values)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-25-1.png){width=672}\n:::\n\n```{.r .cell-code}\n# Criando gr√°fico de vetores de atribui√ß√£o (vari√°veis no espa√ßo discriminante)\nescores_todos <- predict(modelo_final, amostra_analise)$x\ndf_escores <- data.frame(\n  Funcao1 = escores_todos[, 1],\n  Funcao2 = escores_todos[, 2],\n  Grupo = amostra_analise$X1,\n  Probabilidades = apply(predict(modelo_final, amostra_analise)$posterior, 1, max)\n)\n\n# Adicionando centr√≥ides\ndf_centroides <- data.frame(\n  Funcao1 = centroides_discriminantes[, 1],\n  Funcao2 = centroides_discriminantes[, 2],\n  Grupo = factor(rownames(centroides_discriminantes), \n                levels = levels(amostra_analise$X1))\n)\n\n# Escalonando as cargas para melhor visualiza√ß√£o\nescala_vetor <- 3  # Fator de escala para os vetores\ncargas_escalonadas <- cargas_discriminantes * escala_vetor\n\n# Preparando dados dos vetores com descri√ß√µes\nvetores_df <- data.frame(\n  Variavel = rownames(cargas_discriminantes),\n  LD1_start = 0,\n  LD2_start = 0,\n  LD1_end = cargas_escalonadas[, 1],\n  LD2_end = cargas_escalonadas[, 2],\n  Magnitude = sqrt(cargas_discriminantes[, 1]^2 + cargas_discriminantes[, 2]^2),\n  Significativa = rownames(cargas_discriminantes) %in% vars_significativas\n) %>%\n  dplyr::mutate(Variavel_Desc = sapply(Variavel, obter_descricao))\n\n# Gr√°fico de vetores de atribui√ß√£o expandidos\np_vetores <- ggplot2::ggplot() +\n  # Pontos dos grupos (mais transparentes para n√£o ofuscar os vetores)\n  ggplot2::geom_point(data = df_escores, ggplot2::aes(x = Funcao1, y = Funcao2, color = Grupo), \n                      alpha = 0.3, size = 1) +\n  # Centr√≥ides dos grupos\n  ggplot2::geom_point(data = df_centroides, ggplot2::aes(x = Funcao1, y = Funcao2), \n                      size = 6, shape = 17, color = \"black\") +\n  # LABELS DOS CENTR√ìIDES - NOVO\n  ggplot2::geom_text(data = df_centroides, \n                     ggplot2::aes(x = Funcao1, y = Funcao2, label = Grupo),\n                     vjust = -1.5, hjust = 0.5, color = \"black\", \n                     fontface = \"bold\", size = 3.5,\n                     box.padding = 0.5) +\n  # Vetores das vari√°veis\n  ggplot2::geom_segment(data = vetores_df,\n                        ggplot2::aes(x = LD1_start, y = LD2_start, \n                                     xend = LD1_end, yend = LD2_end,\n                                     color = Significativa, size = Magnitude),\n                        arrow = ggplot2::arrow(length = ggplot2::unit(0.3, \"cm\")),\n                        alpha = 0.8) +\n  # Labels das vari√°veis com descri√ß√µes\n  ggplot2::geom_text(data = vetores_df,\n                     ggplot2::aes(x = LD1_end * 1.1, y = LD2_end * 1.1, \n                                  label = Variavel_Desc, color = Significativa),\n                     size = 2.5, fontface = \"bold\") +\n  # Eixos de refer√™ncia\n  ggplot2::geom_hline(yintercept = 0, linetype = \"dashed\", alpha = 0.5) +\n  ggplot2::geom_vline(xintercept = 0, linetype = \"dashed\", alpha = 0.5) +\n  # Escalas e temas\n  ggplot2::scale_color_manual(values = c(\"FALSE\" = \"gray50\", \"TRUE\" = \"red\")) +\n  ggplot2::scale_size_continuous(range = c(0.5, 2), guide = \"none\") +\n  ggplot2::labs(title = \"Vetores de Atribui√ß√£o das Vari√°veis no Espa√ßo Discriminante\",\n                subtitle = paste(\"Vetores mostram contribui√ß√£o das vari√°veis para as fun√ß√µes discriminantes\\n\",\n                                \"Tri√¢ngulos pretos = centr√≥ides dos grupos | Escala dos vetores: \", escala_vetor, \"x\"),\n                x = paste(\"Fun√ß√£o Discriminante 1 (\", round(variancia_explicada[1], 1), \"%)\"),\n                y = paste(\"Fun√ß√£o Discriminante 2 (\", round(variancia_explicada[2], 1), \"%)\"),\n                color = \"Vari√°vel\\nSignificativa\") +\n  ggplot2::theme_minimal() +\n  ggplot2::theme(legend.position = \"bottom\",\n                 plot.title = ggplot2::element_text(size = 14, face = \"bold\"),\n                 plot.subtitle = ggplot2::element_text(size = 10))\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning in ggplot2::geom_text(data = df_centroides, ggplot2::aes(x = Funcao1, :\nIgnoring unknown parameters: `box.padding`\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.\n‚Ñπ Please use `linewidth` instead.\n```\n\n\n:::\n\n```{.r .cell-code}\nprint(p_vetores)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-25-2.png){width=672}\n:::\n\n```{.r .cell-code}\n# IDENTIFICA√á√ÉO DOS GRUPOS DA VARI√ÅVEL DEPENDENTE\ncat(\"\\n=== IDENTIFICA√á√ÉO DOS GRUPOS DA VARI√ÅVEL DEPENDENTE ===\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n=== IDENTIFICA√á√ÉO DOS GRUPOS DA VARI√ÅVEL DEPENDENTE ===\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"Vari√°vel Dependente: X1 (Customer Type)\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nVari√°vel Dependente: X1 (Customer Type)\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"Descri√ß√£o: Tempo de relacionamento com a empresa HBAT\\n\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nDescri√ß√£o: Tempo de relacionamento com a empresa HBAT\n```\n\n\n:::\n\n```{.r .cell-code}\n# Grupos identificados no gr√°fico\ngrupos_identificados <- levels(amostra_analise$X1)\nfreq_grupos <- table(amostra_analise$X1)\ncentroides_info <- centroides_discriminantes\n\ncat(\"GRUPOS REPRESENTADOS NO GR√ÅFICO:\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGRUPOS REPRESENTADOS NO GR√ÅFICO:\n```\n\n\n:::\n\n```{.r .cell-code}\nfor(i in 1:length(grupos_identificados)) {\n  grupo_nome <- grupos_identificados[i]\n  freq <- freq_grupos[i]\n  ld1_pos <- round(centroides_info[grupo_nome, \"LD1\"], 2)\n  ld2_pos <- round(centroides_info[grupo_nome, \"LD2\"], 2)\n  \n  cat(sprintf(\"üî∫ GRUPO %d: %s\\n\", i, grupo_nome))\n  cat(sprintf(\"   - Frequ√™ncia: %d casos (%.1f%%)\\n\", \n              freq, (freq/sum(freq_grupos))*100))\n  cat(sprintf(\"   - Posi√ß√£o no gr√°fico: LD1 = %.2f, LD2 = %.2f\\n\", ld1_pos, ld2_pos))\n  cat(sprintf(\"   - Caracter√≠stica: %s\\n\", \n              switch(i,\n                     \"Clientes com relacionamento recente - percep√ß√µes iniciais\",\n                     \"Clientes com relacionamento estabelecido - percep√ß√µes moderadas\", \n                     \"Clientes com relacionamento consolidado - percep√ß√µes elevadas\")))\n  cat(\"\\n\")\n}\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nüî∫ GRUPO 1: Menos de 1 ano\n   - Frequ√™ncia: 20 casos (33.3%)\n   - Posi√ß√£o no gr√°fico: LD1 = -1.61, LD2 = 0.31\n   - Caracter√≠stica: Clientes com relacionamento recente - percep√ß√µes iniciais\n\nüî∫ GRUPO 2: De 1 a 5 anos\n   - Frequ√™ncia: 22 casos (36.7%)\n   - Posi√ß√£o no gr√°fico: LD1 = 0.26, LD2 = -0.71\n   - Caracter√≠stica: Clientes com relacionamento estabelecido - percep√ß√µes moderadas\n\nüî∫ GRUPO 3: Mais de 5 anos\n   - Frequ√™ncia: 18 casos (30.0%)\n   - Posi√ß√£o no gr√°fico: LD1 = 1.47, LD2 = 0.53\n   - Caracter√≠stica: Clientes com relacionamento consolidado - percep√ß√µes elevadas\n```\n\n\n:::\n\n```{.r .cell-code}\n# Interpreta√ß√£o dos centr√≥ides no espa√ßo discriminante\ncat(\"INTERPRETA√á√ÉO DOS CENTR√ìIDES (TRI√ÇNGULOS PRETOS):\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nINTERPRETA√á√ÉO DOS CENTR√ìIDES (TRI√ÇNGULOS PRETOS):\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"- Os tri√¢ngulos pretos representam o 'centro' de cada grupo no espa√ßo discriminante\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n- Os tri√¢ngulos pretos representam o 'centro' de cada grupo no espa√ßo discriminante\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"- Sua posi√ß√£o indica as caracter√≠sticas m√©dias de cada grupo\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n- Sua posi√ß√£o indica as caracter√≠sticas m√©dias de cada grupo\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"- A dist√¢ncia entre centr√≥ides mostra o grau de separa√ß√£o entre grupos\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n- A dist√¢ncia entre centr√≥ides mostra o grau de separa√ß√£o entre grupos\n```\n\n\n:::\n\n```{.r .cell-code}\n# An√°lise das posi√ß√µes dos centr√≥ides\ncat(\"\\nAN√ÅLISE DAS POSI√á√ïES:\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nAN√ÅLISE DAS POSI√á√ïES:\n```\n\n\n:::\n\n```{.r .cell-code}\nfor(i in 1:nrow(centroides_info)) {\n  grupo_nome <- rownames(centroides_info)[i]\n  ld1_val <- centroides_info[i, \"LD1\"]\n  ld2_val <- centroides_info[i, \"LD2\"]\n  \n  # Interpreta√ß√£o baseada na posi√ß√£o\n  interpretacao_ld1 <- ifelse(ld1_val > 0, \"valores altos em LD1\", \"valores baixos em LD1\")\n  interpretacao_ld2 <- ifelse(ld2_val > 0, \"valores altos em LD2\", \"valores baixos em LD2\")\n  \n  cat(sprintf(\"- %s: Caracterizado por %s e %s\\n\", \n              grupo_nome, interpretacao_ld1, interpretacao_ld2))\n}\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n- Menos de 1 ano: Caracterizado por valores baixos em LD1 e valores altos em LD2\n- De 1 a 5 anos: Caracterizado por valores altos em LD1 e valores baixos em LD2\n- Mais de 5 anos: Caracterizado por valores altos em LD1 e valores altos em LD2\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"\\nLEGENDA DO GR√ÅFICO:\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nLEGENDA DO GR√ÅFICO:\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"üî∫ Tri√¢ngulos pretos = Centr√≥ides dos grupos\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nüî∫ Tri√¢ngulos pretos = Centr√≥ides dos grupos\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"‚óè Pontos coloridos = Observa√ß√µes individuais por grupo\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n‚óè Pontos coloridos = Observa√ß√µes individuais por grupo\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"‚Üí Vetores vermelhos = Vari√°veis significativas (p < 0.05)\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n‚Üí Vetores vermelhos = Vari√°veis significativas (p < 0.05)\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"‚Üí Vetores cinza = Vari√°veis n√£o significativas\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n‚Üí Vetores cinza = Vari√°veis n√£o significativas\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"üìè Comprimento do vetor = Magnitude da contribui√ß√£o discriminante\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nüìè Comprimento do vetor = Magnitude da contribui√ß√£o discriminante\n```\n\n\n:::\n\n```{.r .cell-code}\n# Interpreta√ß√£o dos vetores\ncat(\"\\n=== INTERPRETA√á√ÉO DOS VETORES DE ATRIBUI√á√ÉO ===\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n=== INTERPRETA√á√ÉO DOS VETORES DE ATRIBUI√á√ÉO ===\n```\n\n\n:::\n:::\n\n\n\n\n#### 6.4 An√°lise das Dist√¢ncias entre Grupos\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Calculando dist√¢ncias Mahalanobis entre centr√≥ides\ncentroides_matriz <- as.matrix(centroides_discriminantes)\n\n# Matriz de dist√¢ncias entre centr√≥ides\nn_grupos <- nrow(centroides_matriz)\ndist_centroides <- matrix(0, n_grupos, n_grupos)\nrownames(dist_centroides) <- rownames(centroides_matriz)\ncolnames(dist_centroides) <- rownames(centroides_matriz)\n\nfor(i in 1:n_grupos) {\n  for(j in 1:n_grupos) {\n    dist_centroides[i, j] <- sqrt(sum((centroides_matriz[i, ] - centroides_matriz[j, ])^2))\n  }\n}\n\nprint(\"Matriz de Dist√¢ncias Euclidianas entre Centr√≥ides:\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"Matriz de Dist√¢ncias Euclidianas entre Centr√≥ides:\"\n```\n\n\n:::\n\n```{.r .cell-code}\nprint(round(dist_centroides, 3))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n               Menos de 1 ano De 1 a 5 anos Mais de 5 anos\nMenos de 1 ano          0.000         2.127          3.084\nDe 1 a 5 anos           2.127         0.000          1.737\nMais de 5 anos          3.084         1.737          0.000\n```\n\n\n:::\n\n```{.r .cell-code}\n# Visualiza√ß√£o das dist√¢ncias como heatmap\ndist_df <- reshape2::melt(dist_centroides)\nnames(dist_df) <- c(\"Grupo1\", \"Grupo2\", \"Distancia\")\n\np_distancias <- ggplot2::ggplot(dist_df, ggplot2::aes(x = Grupo1, y = Grupo2, fill = Distancia)) +\n  ggplot2::geom_tile(color = \"white\") +\n  ggplot2::geom_text(ggplot2::aes(label = round(Distancia, 2)), \n                     color = \"white\", fontface = \"bold\", size = 5) +\n  ggplot2::scale_fill_viridis_c(name = \"Dist√¢ncia\\nEuclidiana\") +\n  ggplot2::labs(title = \"Matriz de Dist√¢ncias entre Centr√≥ides dos Grupos\",\n                subtitle = \"Dist√¢ncias calculadas no espa√ßo discriminante\",\n                x = \"Grupo\", y = \"Grupo\") +\n  ggplot2::theme_minimal() +\n  ggplot2::theme(plot.title = ggplot2::element_text(size = 14, face = \"bold\"),\n                 axis.text.x = ggplot2::element_text(angle = 45, hjust = 1))\n\nprint(p_distancias)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-26-1.png){width=672}\n:::\n\n```{.r .cell-code}\n# An√°lise de separa√ß√£o\ndist_matrix_upper <- dist_centroides[upper.tri(dist_centroides)]\n\n# Identificando grupos mais pr√≥ximos e mais distantes\ndist_indices <- which(dist_centroides == min(dist_matrix_upper), arr.ind = TRUE)[1, ]\ngrupos_proximos <- c(rownames(dist_centroides)[dist_indices[1]], \n                    colnames(dist_centroides)[dist_indices[2]])\n\ndist_indices_max <- which(dist_centroides == max(dist_matrix_upper), arr.ind = TRUE)[1, ]\ngrupos_distantes <- c(rownames(dist_centroides)[dist_indices_max[1]], \n                     colnames(dist_centroides)[dist_indices_max[2]])\n```\n:::\n\n\n\n\n**Interpreta√ß√£o da An√°lise de Dist√¢ncias:**\n\n**Matriz de Dist√¢ncias Euclidianas:**\n- **Menor dist√¢ncia**: \"De 1 a 5 anos\" ‚Üî \"Mais de 5 anos\" (1.737)\n- **Maior dist√¢ncia**: \"Menos de 1 ano\" ‚Üî \"Mais de 5 anos\" (3.084)\n- **Dist√¢ncia intermedi√°ria**: \"Menos de 1 ano\" ‚Üî \"De 1 a 5 anos\" (2.127)\n\n**Padr√µes de Similaridade:**\n\n1. **Grupos Intermedi√°rio e Maduro s√£o mais pr√≥ximos**: \n   - Dist√¢ncia de apenas 1.737 unidades\n   - **Interpreta√ß√£o**: Ap√≥s 1 ano, as percep√ß√µes come√ßam a convergir\n   - **Implica√ß√£o**: O primeiro ano √© cr√≠tico para formar percep√ß√µes duradouras\n\n2. **Clientes Novos s√£o mais distantes de todos**:\n   - Maior dist√¢ncia dos clientes maduros (3.084)\n   - **Interpreta√ß√£o**: Per√≠odo inicial tem caracter√≠sticas muito distintas\n   - **Implica√ß√£o**: Estrat√©gias espec√≠ficas necess√°rias para novos clientes\n\n3. **Progress√£o N√£o-Linear**:\n   - A evolu√ß√£o \"Novo ‚Üí Intermedi√°rio ‚Üí Maduro\" n√£o √© uniforme\n   - Maior salto entre \"Novo\" e \"Intermedi√°rio\" (2.127)\n   - Menor progress√£o entre \"Intermedi√°rio\" e \"Maduro\" (1.737)\n\n**Insights Gerenciais:**\n\n- **Per√≠odo Cr√≠tico**: Os primeiros 12 meses s√£o fundamentais para reten√ß√£o\n- **Converg√™ncia**: Ap√≥s 1 ano, clientes tendem a desenvolver percep√ß√µes similares\n- **Segmenta√ß√£o**: Dois grandes segmentos emergem: \"Novos\" vs. \"Estabelecidos\" (intermedi√°rios + maduros)\n\n#### 6.5 Compara√ß√£o Visual: Espa√ßo Original vs. Espa√ßo Discriminante\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Comparando visualiza√ß√£o no espa√ßo original (X6, X18) vs. espa√ßo discriminante\np_original <- ggplot2::ggplot(amostra_analise, ggplot2::aes(x = X6, y = X18, color = X1)) +\n  ggplot2::geom_point(size = 3, alpha = 0.7) +\n  ggplot2::stat_ellipse(level = 0.68, type = \"norm\", size = 1.2) +\n  ggplot2::geom_point(data = centroides, ggplot2::aes(x = X6, y = X18), \n                      size = 8, shape = 17, color = \"black\") +\n  ggplot2::scale_color_brewer(type = \"qual\", palette = \"Set1\") +\n  ggplot2::labs(title = \"Espa√ßo Original\",\n                subtitle = \"Vari√°veis originais do modelo discriminante\",\n                x = descricoes_variaveis[\"X6\"], \n                y = descricoes_variaveis[\"X18\"],\n                color = \"Grupo\") +\n  ggplot2::theme_minimal() +\n  ggplot2::theme(legend.position = \"bottom\",\n                 plot.title = ggplot2::element_text(size = 12, face = \"bold\"))\n\np_discriminante <- ggplot2::ggplot(df_escores, ggplot2::aes(x = Funcao1, y = Funcao2, color = Grupo)) +\n  ggplot2::geom_point(size = 3, alpha = 0.7) +\n  ggplot2::stat_ellipse(level = 0.68, type = \"norm\", size = 1.2) +\n  ggplot2::geom_point(data = df_centroides, ggplot2::aes(x = Funcao1, y = Funcao2), \n                      size = 8, shape = 17, color = \"black\") +\n  ggplot2::scale_color_brewer(type = \"qual\", palette = \"Set1\") +\n  ggplot2::labs(title = \"Espa√ßo Discriminante (LD1 vs LD2)\",\n                subtitle = \"Fun√ß√µes discriminantes otimizadas para separa√ß√£o\",\n                x = paste(\"LD1 (\", round(variancia_explicada[1], 1), \"%)\"),\n                y = paste(\"LD2 (\", round(variancia_explicada[2], 1), \"%)\"),\n                color = \"Grupo\") +\n  ggplot2::theme_minimal() +\n  ggplot2::theme(legend.position = \"bottom\",\n                 plot.title = ggplot2::element_text(size = 12, face = \"bold\"))\n\n# Combinando os gr√°ficos\ncomparacao <- gridExtra::grid.arrange(\n  p_original, p_discriminante, \n  ncol = 2,\n  top = grid::textGrob(\"Compara√ß√£o: Espa√ßo Original vs. Espa√ßo Discriminante\", \n                       gp = grid::gpar(fontsize = 16, fontface = \"bold\"))\n)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-27-1.png){width=672}\n:::\n\n```{.r .cell-code}\nprint(comparacao)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nTableGrob (2 x 2) \"arrange\": 3 grobs\n  z     cells    name                grob\n1 1 (2-2,1-1) arrange      gtable[layout]\n2 2 (2-2,2-2) arrange      gtable[layout]\n3 3 (1-1,1-2) arrange text[GRID.text.321]\n```\n\n\n:::\n\n```{.r .cell-code}\n# Interpreta√ß√£o da compara√ß√£o\ncat(\"\\n=== INTERPRETA√á√ÉO DA COMPARA√á√ÉO ===\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n=== INTERPRETA√á√ÉO DA COMPARA√á√ÉO ===\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"- Espa√ßo Original: mostra sobreposi√ß√£o entre grupos\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n- Espa√ßo Original: mostra sobreposi√ß√£o entre grupos\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"- Espa√ßo Discriminante: maximiza separa√ß√£o entre grupos\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n- Espa√ßo Discriminante: maximiza separa√ß√£o entre grupos\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"- A transforma√ß√£o discriminante melhora a separabilidade\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n- A transforma√ß√£o discriminante melhora a separabilidade\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"- LD1 e LD2 s√£o combina√ß√µes lineares que maximizam discrimina√ß√£o\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n- LD1 e LD2 s√£o combina√ß√µes lineares que maximizam discrimina√ß√£o\n```\n\n\n:::\n:::\n\n\n\n\n### Est√°gio 6: Valida√ß√£o dos Resultados\n\n#### 6.6 Matriz de Classifica√ß√£o e Valida√ß√£o\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Classifica√ß√£o da amostra de an√°lise\npredicoes_analise <- predict(modelo_final, amostra_analise)\nmatriz_confusao_analise <- table(Predito = predicoes_analise$class, \n                                Real = amostra_analise$X1)\n\nprint(\"Matriz de Classifica√ß√£o - Amostra de An√°lise:\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"Matriz de Classifica√ß√£o - Amostra de An√°lise:\"\n```\n\n\n:::\n\n```{.r .cell-code}\nprint(matriz_confusao_analise)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                Real\nPredito          Menos de 1 ano De 1 a 5 anos Mais de 5 anos\n  Menos de 1 ano             16             2              0\n  De 1 a 5 anos               3            14              1\n  Mais de 5 anos              1             6             17\n```\n\n\n:::\n\n```{.r .cell-code}\n# Taxa de acerto geral\nacerto_geral_analise <- sum(diag(matriz_confusao_analise)) / sum(matriz_confusao_analise)\n\n# Taxa de acerto por grupo\nacerto_por_grupo_analise <- diag(matriz_confusao_analise) / rowSums(matriz_confusao_analise)\nprint(\"Taxa de Acerto por Grupo (An√°lise):\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"Taxa de Acerto por Grupo (An√°lise):\"\n```\n\n\n:::\n\n```{.r .cell-code}\nprint(round(acerto_por_grupo_analise * 100, 1))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nMenos de 1 ano  De 1 a 5 anos Mais de 5 anos \n          88.9           77.8           70.8 \n```\n\n\n:::\n\n```{.r .cell-code}\n# Visualiza√ß√£o da matriz de confus√£o\nmatriz_conf_df <- as.data.frame(matriz_confusao_analise)\nnames(matriz_conf_df) <- c(\"Predito\", \"Real\", \"Freq\")\n\np_matriz_conf <- ggplot2::ggplot(matriz_conf_df, ggplot2::aes(x = Real, y = Predito, fill = Freq)) +\n  ggplot2::geom_tile(color = \"white\") +\n  ggplot2::geom_text(ggplot2::aes(label = Freq), color = \"white\", size = 6, fontface = \"bold\") +\n  ggplot2::scale_fill_viridis_c(name = \"Frequ√™ncia\") +\n  ggplot2::labs(title = \"Matriz de Confus√£o - Amostra de An√°lise\",\n                subtitle = paste(\"Taxa de Acerto Geral:\", round(acerto_geral_analise * 100, 1), \"%\"),\n                x = \"Grupo Real\", y = \"Grupo Predito\") +\n  ggplot2::theme_minimal() +\n  ggplot2::theme(plot.title = ggplot2::element_text(size = 14, face = \"bold\"),\n                 axis.text.x = ggplot2::element_text(angle = 45, hjust = 1))\n\nprint(p_matriz_conf)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-28-1.png){width=672}\n:::\n:::\n\n\n\n\n**Taxa de Acerto Geral (An√°lise)**: 78.3%\n\n**Taxa de Acerto por Grupo (An√°lise)**:\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n\n\n|Grupo          | Taxa.de.Acerto....|\n|:--------------|------------------:|\n|Menos de 1 ano |               88.9|\n|De 1 a 5 anos  |               77.8|\n|Mais de 5 anos |               70.8|\n\n\n:::\n:::\n\n\n\n\n#### 6.7 Valida√ß√£o Cruzada\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Fun√ß√£o para valida√ß√£o cruzada\nvalidacao_cruzada <- function(dados, formula) {\n  n <- nrow(dados)\n  predicoes <- character(n)\n  \n  for(i in 1:n) {\n    # Treina modelo sem a observa√ß√£o i\n    dados_treino <- dados[-i, ]\n    modelo_temp <- MASS::lda(formula, data = dados_treino)\n    \n    # Prediz a observa√ß√£o i\n    predicao_temp <- predict(modelo_temp, dados[i, ])\n    predicoes[i] <- as.character(predicao_temp$class)\n  }\n  \n  return(factor(predicoes, levels = levels(dados$X1)))\n}\n\n# Aplicando valida√ß√£o cruzada\npredicoes_cv <- validacao_cruzada(amostra_analise, X1 ~ X6 + X18)\nmatriz_confusao_cv <- table(Predito = predicoes_cv, Real = amostra_analise$X1)\n\nprint(\"Matriz de Classifica√ß√£o - Valida√ß√£o Cruzada:\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"Matriz de Classifica√ß√£o - Valida√ß√£o Cruzada:\"\n```\n\n\n:::\n\n```{.r .cell-code}\nprint(matriz_confusao_cv)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                Real\nPredito          Menos de 1 ano De 1 a 5 anos Mais de 5 anos\n  Menos de 1 ano             16             2              0\n  De 1 a 5 anos               3            14              1\n  Mais de 5 anos              1             6             17\n```\n\n\n:::\n\n```{.r .cell-code}\n# Taxa de acerto valida√ß√£o cruzada\nacerto_geral_cv <- sum(diag(matriz_confusao_cv)) / sum(matriz_confusao_cv)\n```\n:::\n\n\n\n\n**Taxa de Acerto Geral (Valida√ß√£o Cruzada)**: 78.3%\n\n#### 6.8 Valida√ß√£o Externa\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Classifica√ß√£o da amostra de valida√ß√£o\npredicoes_validacao <- predict(modelo_final, amostra_validacao)\nmatriz_confusao_validacao <- table(Predito = predicoes_validacao$class, \n                                  Real = amostra_validacao$X1)\n\nprint(\"Matriz de Classifica√ß√£o - Amostra de Valida√ß√£o:\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"Matriz de Classifica√ß√£o - Amostra de Valida√ß√£o:\"\n```\n\n\n:::\n\n```{.r .cell-code}\nprint(matriz_confusao_validacao)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                Real\nPredito          Menos de 1 ano De 1 a 5 anos Mais de 5 anos\n  Menos de 1 ano             10             1              0\n  De 1 a 5 anos               1            10              4\n  Mais de 5 anos              1             2             11\n```\n\n\n:::\n\n```{.r .cell-code}\n# Taxa de acerto amostra de valida√ß√£o\nacerto_geral_validacao <- sum(diag(matriz_confusao_validacao)) / sum(matriz_confusao_validacao)\n\n# Taxa de acerto por grupo\nacerto_por_grupo_validacao <- diag(matriz_confusao_validacao) / rowSums(matriz_confusao_validacao)\nprint(\"Taxa de Acerto por Grupo (Valida√ß√£o):\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"Taxa de Acerto por Grupo (Valida√ß√£o):\"\n```\n\n\n:::\n\n```{.r .cell-code}\nprint(round(acerto_por_grupo_validacao * 100, 1))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nMenos de 1 ano  De 1 a 5 anos Mais de 5 anos \n          90.9           66.7           78.6 \n```\n\n\n:::\n:::\n\n\n\n\n**Taxa de Acerto Geral (Valida√ß√£o)**: 77.5%\n\n#### 6.9 Crit√©rios de Chance\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Calculando crit√©rios de chance\ntamanhos_grupos <- table(amostra_analise$X1)\nproporcoes_grupos <- tamanhos_grupos / sum(tamanhos_grupos)\n\n# Crit√©rio de chance proporcional\ncriterio_chance_proporcional <- sum(proporcoes_grupos^2) * 100\n\n# Crit√©rio de chance m√°xima\ncriterio_chance_maxima <- max(proporcoes_grupos) * 100\n\n# Gr√°fico de compara√ß√£o das taxas de acerto\ntaxas_acerto <- data.frame(\n  Metodo = c(\"An√°lise\", \"Valida√ß√£o Cruzada\", \"Valida√ß√£o Externa\", \n             \"Crit√©rio Proporcional\", \"Crit√©rio M√°ximo\"),\n  Taxa = c(acerto_geral_analise * 100, \n           acerto_geral_cv * 100,\n           acerto_geral_validacao * 100,\n           criterio_chance_proporcional,\n           criterio_chance_maxima),\n  Tipo = c(\"Modelo\", \"Modelo\", \"Modelo\", \"Refer√™ncia\", \"Refer√™ncia\")\n)\n\np_performance <- ggplot2::ggplot(taxas_acerto, ggplot2::aes(x = reorder(Metodo, Taxa), y = Taxa, fill = Tipo)) +\n  ggplot2::geom_col(alpha = 0.8, width = 0.7) +\n  ggplot2::geom_text(ggplot2::aes(label = paste0(round(Taxa, 1), \"%\")), \n                     hjust = -0.1, size = 4, fontface = \"bold\") +\n  ggplot2::coord_flip() +\n  ggplot2::scale_fill_manual(values = c(\"Modelo\" = \"steelblue\", \"Refer√™ncia\" = \"coral\")) +\n  ggplot2::labs(title = \"Compara√ß√£o das Taxas de Acerto\",\n                subtitle = \"Modelo vs. Crit√©rios de Chance\",\n                x = \"M√©todo de Valida√ß√£o\", \n                y = \"Taxa de Acerto (%)\",\n                fill = \"Tipo\") +\n  ggplot2::theme_minimal() +\n  ggplot2::theme(legend.position = \"bottom\",\n                 plot.title = ggplot2::element_text(size = 14, face = \"bold\"))\n\nprint(p_performance)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-32-1.png){width=672}\n:::\n:::\n\n\n\n\n**Crit√©rios de Chance:**\n\n- **Crit√©rio de Chance Proporcional**: 33.6%\n- **Crit√©rio de Chance M√°xima**: 36.7%\n\n**Compara√ß√£o com Resultados Obtidos:**\n\n- Taxa de Acerto An√°lise: 78.3% vs Crit√©rio Proporcional: 33.6%\n- Taxa de Acerto Valida√ß√£o Cruzada: 78.3% vs Crit√©rio Proporcional: 33.6%  \n- Taxa de Acerto Valida√ß√£o: 77.5% vs Crit√©rio Proporcional: 33.6%\n\n### Resumo da Interpreta√ß√£o Gerencial\n\nOs resultados da an√°lise discriminante revelam insights importantes sobre a diferencia√ß√£o de clientes baseada no tempo de relacionamento. Com o dataset completo analisado, identificamos que de 13 vari√°veis independentes testadas, apenas 2 foram suficientes para uma discrimina√ß√£o efetiva.\n\n#### Principais Descobertas:\n\n1. **Vari√°veis Discriminantes**: X6 (Product Quality) e X18 (Delivery Speed) s√£o os principais diferenciadores, representando aproximadamente 100% da vari√¢ncia discriminante total.\n\n2. **Precis√£o do Modelo**: O modelo alcan√ßa alta taxa de acertos na amostra de an√°lise, superando significativamente os crit√©rios de chance.\n\n3. **Diferen√ßas entre Grupos**: \n   - **Clientes novos** (< 1 ano): Menores percep√ß√µes de qualidade e velocidade\n   - **Clientes intermedi√°rios** (1-5 anos): Percep√ß√µes moderadas\n   - **Clientes estabelecidos** (> 5 anos): Maiores percep√ß√µes de qualidade e velocidade\n\n#### Implica√ß√µes Gerenciais:\n\n- **Foco na Qualidade**: Investir na melhoria da qualidade do produto √© fundamental para reter clientes\n- **Otimiza√ß√£o de Entregas**: A velocidade de entrega √© um diferencial competitivo cr√≠tico\n- **Segmenta√ß√£o**: Os 3 grupos identificados requerem estrat√©gias diferenciadas\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# M√©dias dos grupos para interpreta√ß√£o\nmedias_grupos <- aggregate(amostra_analise[, variaveis_independentes], \n                          by = list(amostra_analise$X1), FUN = mean)\nnames(medias_grupos)[1] <- \"Grupo\"\n\n# Corrigindo erro na impress√£o das m√©dias dos grupos\nmedias_grupos_numericas <- medias_grupos[, -1]  # Remove coluna 'Grupo'\nrownames(medias_grupos_numericas) <- medias_grupos$Grupo\n\nprint(\"M√©dias dos Grupos nas Vari√°veis Independentes:\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"M√©dias dos Grupos nas Vari√°veis Independentes:\"\n```\n\n\n:::\n\n```{.r .cell-code}\nprint(round(medias_grupos_numericas, 2))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                 X6   X7   X8   X9  X10  X11  X12  X13  X14  X15  X16  X17  X18\nMenos de 1 ano 6.99 3.56 5.28 4.30 3.83 4.72 4.75 7.42 5.98 5.38 3.53 4.29 3.14\nDe 1 a 5 anos  7.34 3.85 5.30 5.99 4.27 5.65 5.49 7.75 5.98 4.91 4.70 5.54 4.27\nMais de 5 anos 9.18 3.73 5.82 5.92 4.01 7.00 5.12 5.99 6.32 5.37 4.65 3.94 4.17\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"\\n=== INTERPRETA√á√ÉO DAS FUN√á√ïES DISCRIMINANTES ===\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n=== INTERPRETA√á√ÉO DAS FUN√á√ïES DISCRIMINANTES ===\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"Fun√ß√£o 1: Diferencia principalmente entre Grupo 1 e Grupos 2-3\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nFun√ß√£o 1: Diferencia principalmente entre Grupo 1 e Grupos 2-3\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"Fun√ß√£o 2: Diferencia principalmente entre Grupo 3 e Grupos 1-2\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nFun√ß√£o 2: Diferencia principalmente entre Grupo 3 e Grupos 1-2\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"\\n=== VARI√ÅVEIS MAIS IMPORTANTES ===\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n=== VARI√ÅVEIS MAIS IMPORTANTES ===\n```\n\n\n:::\n\n```{.r .cell-code}\nif(exists(\"indice_potencia_ordenado\")) {\n  cat(\"Por √çndice de Pot√™ncia:\\n\")\n  print(names(indice_potencia_ordenado)[1:min(5, length(indice_potencia_ordenado))])\n}\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nPor √çndice de Pot√™ncia:\n[1] \"X6\"  \"X11\" \"X17\" \"X18\" \"X9\" \n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"\\nPor Raz√£o F Univariada:\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nPor Raz√£o F Univariada:\n```\n\n\n:::\n\n```{.r .cell-code}\nprint(names(razoes_f_ordenadas)[1:min(5, length(razoes_f_ordenadas))])\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"X18\" \"X6\"  \"X9\"  \"X11\" \"X16\"\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"\\n=== RESUMO FINAL ===\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n=== RESUMO FINAL ===\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"Modelo discriminante final: X1 ~ X6 + X18\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nModelo discriminante final: X1 ~ X6 + X18\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"Vari√°veis selecionadas:\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nVari√°veis selecionadas:\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"- X6: Qualidade do produto\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n- X6: Qualidade do produto\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"- X18: Velocidade de entrega\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n- X18: Velocidade de entrega\n```\n\n\n:::\n\n```{.r .cell-code}\nif(exists(\"modelo_stepwise\")) {\n  cat(\"\\nVari√°veis selecionadas pelo procedimento stepwise:\\n\")\n  print(modelo_stepwise$formula)\n}\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nVari√°veis selecionadas pelo procedimento stepwise:\n[1] \"X1 ~ X6 + X18\"\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"\\n=== CONCLUS√ïES GERENCIAIS ===\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n=== CONCLUS√ïES GERENCIAIS ===\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"1. A qualidade do produto (X6) e velocidade de entrega (X18) s√£o os principais diferenciadores entre os grupos de clientes.\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n1. A qualidade do produto (X6) e velocidade de entrega (X18) s√£o os principais diferenciadores entre os grupos de clientes.\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"2. O modelo consegue discriminar bem entre os tr√™s grupos de tempo de relacionamento.\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n2. O modelo consegue discriminar bem entre os tr√™s grupos de tempo de relacionamento.\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"3. Clientes de longo prazo valorizam mais qualidade e velocidade de entrega.\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n3. Clientes de longo prazo valorizam mais qualidade e velocidade de entrega.\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"4. A√ß√µes de melhoria devem focar nestas duas dimens√µes para reter clientes.\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n4. A√ß√µes de melhoria devem focar nestas duas dimens√µes para reter clientes.\n```\n\n\n:::\n:::\n\n\n\n\n**An√°lise das M√©dias por Grupo:**\n\nOs resultados mostram um padr√£o claro de evolu√ß√£o das percep√ß√µes com o tempo de relacionamento, com melhorias progressivas nas percep√ß√µes de qualidade e velocidade de entrega conforme aumenta o tempo de relacionamento com a empresa.\n\n### Ap√™ndice: Informa√ß√µes T√©cnicas do Dataset\n\n#### Caracter√≠sticas do Dataset HBAT\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Informa√ß√µes sobre o dataset ap√≥s limpeza\ncat(\"=== CARACTER√çSTICAS DO DATASET FINAL ===\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n=== CARACTER√çSTICAS DO DATASET FINAL ===\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"Total de observa√ß√µes:\", nrow(hbat_clean), \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nTotal de observa√ß√µes: 100 \n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"Vari√°veis independentes analisadas:\", length(variaveis_independentes), \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nVari√°veis independentes analisadas: 13 \n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"Grupos da vari√°vel dependente:\", nlevels(hbat_clean$X1), \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGrupos da vari√°vel dependente: 3 \n```\n\n\n:::\n\n```{.r .cell-code}\n# Distribui√ß√£o dos grupos\ndist_grupos <- table(hbat_clean$X1)\nprop_grupos <- prop.table(dist_grupos) * 100\n\ncat(\"\\nDistribui√ß√£o dos grupos:\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nDistribui√ß√£o dos grupos:\n```\n\n\n:::\n\n```{.r .cell-code}\nfor(i in 1:length(dist_grupos)) {\n  cat(\"- \", names(dist_grupos)[i], \": \", dist_grupos[i], \" casos (\", \n      round(prop_grupos[i], 1), \"%)\\n\", sep = \"\")\n}\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n- Menos de 1 ano: 32 casos (32%)\n- De 1 a 5 anos: 35 casos (35%)\n- Mais de 5 anos: 33 casos (33%)\n```\n\n\n:::\n:::\n\n\n\n\n#### Qualidade dos Dados\n\n- **Missing values**: Removidos atrav√©s de listwise deletion\n- **Balanceamento**: Dataset relativamente balanceado entre os grupos\n- **Escala das vari√°veis**: Todas as vari√°veis independentes est√£o na escala de 0-10\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Informa√ß√µes detalhadas sobre o dataset HBAT\ncat(\"=== INFORMA√á√ïES DO DATASET HBAT ===\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n=== INFORMA√á√ïES DO DATASET HBAT ===\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"Total de observa√ß√µes:\", nrow(hbat_clean), \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nTotal de observa√ß√µes: 100 \n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"Vari√°veis independentes:\", length(variaveis_independentes), \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nVari√°veis independentes: 13 \n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"Grupos da vari√°vel dependente:\", nlevels(hbat_clean$X1), \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGrupos da vari√°vel dependente: 3 \n```\n\n\n:::\n\n```{.r .cell-code}\n# Descri√ß√£o das vari√°veis (baseado nos labels originais) - ATUALIZADO\ncat(\"\\n=== DESCRI√á√ÉO COMPLETA DAS VARI√ÅVEIS ===\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n=== DESCRI√á√ÉO COMPLETA DAS VARI√ÅVEIS ===\n```\n\n\n:::\n\n```{.r .cell-code}\nfor(var in names(descricoes_variaveis)) {\n  cat(var, \"-\", descricoes_variaveis[var], \"\\n\")\n}\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nX1 - Customer Type \nX6 - Product Quality \nX7 - E-Commerce Activities \nX8 - Technical Support \nX9 - Complaint Resolution \nX10 - Advertising \nX11 - Product Line \nX12 - Salesforce Image \nX13 - Competitive Pricing \nX14 - Warranty & Claims \nX15 - New Products \nX16 - Ordering & Billing \nX17 - Price Flexibility \nX18 - Delivery Speed \n```\n\n\n:::\n\n```{.r .cell-code}\n# Estat√≠sticas descritivas finais\ncat(\"\\n=== ESTAT√çSTICAS DESCRITIVAS FINAIS ===\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n=== ESTAT√çSTICAS DESCRITIVAS FINAIS ===\n```\n\n\n:::\n\n```{.r .cell-code}\nprint(summary(hbat_clean))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n              X1           X6               X7              X8       \n Menos de 1 ano:32   Min.   : 5.000   Min.   :2.200   Min.   :1.300  \n De 1 a 5 anos :35   1st Qu.: 6.575   1st Qu.:3.275   1st Qu.:4.250  \n Mais de 5 anos:33   Median : 8.000   Median :3.600   Median :5.400  \n                     Mean   : 7.810   Mean   :3.672   Mean   :5.365  \n                     3rd Qu.: 9.100   3rd Qu.:3.925   3rd Qu.:6.625  \n                     Max.   :10.000   Max.   :5.700   Max.   :8.500  \n       X9             X10             X11             X12       \n Min.   :2.600   Min.   :1.900   Min.   :2.300   Min.   :2.900  \n 1st Qu.:4.600   1st Qu.:3.175   1st Qu.:4.700   1st Qu.:4.500  \n Median :5.450   Median :4.000   Median :5.750   Median :4.900  \n Mean   :5.442   Mean   :4.010   Mean   :5.805   Mean   :5.123  \n 3rd Qu.:6.325   3rd Qu.:4.800   3rd Qu.:6.800   3rd Qu.:5.800  \n Max.   :7.800   Max.   :6.500   Max.   :8.400   Max.   :8.200  \n      X13             X14             X15            X16             X17      \n Min.   :3.700   Min.   :4.100   Min.   :1.70   Min.   :2.000   Min.   :2.60  \n 1st Qu.:5.875   1st Qu.:5.400   1st Qu.:4.10   1st Qu.:3.700   1st Qu.:3.70  \n Median :7.100   Median :6.100   Median :5.00   Median :4.400   Median :4.35  \n Mean   :6.974   Mean   :6.043   Mean   :5.15   Mean   :4.278   Mean   :4.61  \n 3rd Qu.:8.400   3rd Qu.:6.600   3rd Qu.:6.30   3rd Qu.:4.800   3rd Qu.:5.60  \n Max.   :9.900   Max.   :8.100   Max.   :9.50   Max.   :6.700   Max.   :7.30  \n      X18       \n Min.   :1.600  \n 1st Qu.:3.400  \n Median :3.900  \n Mean   :3.886  \n 3rd Qu.:4.425  \n Max.   :5.500  \n```\n\n\n:::\n:::\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}